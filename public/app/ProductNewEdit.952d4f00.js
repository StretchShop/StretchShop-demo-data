import{E as B,S as q}from"./Sidebar.f89256d1.js";import{_ as F,r as y,o as d,c,a as t,m as D,f as _,b as f,h as G,F as w,i as C,t as P,j as m,e as p,v,w as S,g as b,S as H,P as z,p as W,k as J}from"./index.9af5a96e.js";const Y={props:["modal"],name:"ProductNewEditProperty",data(){return{propertyKey:null,propertyName:null,propertyValue:null,propertyLang:null}},mounted:function(){},methods:{setProperty(){console.log(this.$parent.setProperty(this.propertyKey,this.propertyValue,this.propertyLang,this.propertyName))}}},Q={key:0,class:"modal is-active"},X=t("div",{class:"modal-background"},null,-1),Z={class:"animation-content"},$={action:""},tt={class:"modal-card",style:{width:"auto"}},et=t("header",{class:"modal-card-head"},[t("p",{class:"modal-card-title",translate:"yes"},"New Product Property")],-1),st={class:"modal-card-body"},ot={class:"control select"},it=t("option",{disabled:"disabled",value:"",translate:"yes"},"Select language",-1),rt=t("option",{value:""},[b("-- "),t("span",{translate:"yes"},"None"),b(" --")],-1),lt=["value"],at={class:"modal-card-foot"};function nt(o,e,i,a,s,l){const h=y("o-field");return i.modal?(d(),c("div",Q,[X,t("div",Z,[t("form",$,[t("div",tt,[et,t("section",st,[o.$store.state.coredata&&o.$store.state.coredata.langs?(d(),D(h,{key:0,label:"Language"},{default:_(()=>[t("div",ot,[f(t("select",{"onUpdate:modelValue":e[0]||(e[0]=g=>s.propertyLang=g)},[it,rt,(d(!0),c(w,null,C(o.$store.state.coredata.langs,g=>(d(),c("option",{value:g.code,key:g.code},P(g.name),9,lt))),128))],512),[[G,s.propertyLang]])])]),_:1})):m("",!0),p(h,{label:"Property key"},{default:_(()=>[f(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=g=>s.propertyKey=g),placeholder:"Property key",required:""},null,512),[[v,s.propertyKey]])]),_:1}),s.propertyLang?(d(),D(h,{key:1,label:"Property Name"},{default:_(()=>[f(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=g=>s.propertyName=g),placeholder:"Property Name"},null,512),[[v,s.propertyName]])]),_:1})):m("",!0),p(h,{label:"Property value"},{default:_(()=>[f(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=g=>s.propertyValue=g),placeholder:"Property value",required:""},null,512),[[v,s.propertyValue]])]),_:1})]),t("footer",at,[t("button",{class:"button",type:"button",onClick:e[4]||(e[4]=g=>o.$parent.modal=!1),translate:"yes"},"Close"),t("button",{class:"button is-primary",onClick:e[5]||(e[5]=S(g=>l.setProperty(),["prevent"])),translate:"yes"},"Add Property")])])])])])):m("",!0)}const dt=F(Y,[["render",nt]]);const ct={name:"ProductNewEdit",data(){return{sidebar:!1,product:null,productMainImageFile:null,productPropertyLangSwitches:{},parentCategoryDetail:null,language:{code:"en",longCode:"en-US",name:"English"},newLanguage:null,variationModel:null,editor:null,editing:!1,userEditAllowed:!1,filteredCategoriesSlugs:[],filteredProductCodes:[],renderComponent:!0,modal:null,fireCounter:0,showPriceLevels:!1,dataToGenerateFromName:{slug:!0,externalId:!0},productTypes:["product","subscription"]}},components:{editorwrapper:B,"slider-carousel":H,"product-box":z,"product-property":dt,sidebar:q},created:function(){this.language=this.$store.state.language},computed:{user(){return this.$store.getters.getUserProfile},editorToolsConfig(){let o=this;return{image:{config:{uploader:{uploadByFile(e){return o.$helpers.uploadFileGlobal("image","products","products/upload/"+o.product.orderCode+"/editor",e,o.$httpc,o.$store)},uploadByUrl(e){}}}}}}},beforeRouteLeave(o,e,i){this.eventBus.emit("removeEditor"),i()},watch:{user(o,e){console.log("new & old",o,e),o&&o!==null&&(this.getUserEditAllowed(),this.userEditAllowed&&this.getProductDetail())}},mounted:function(){this.getUserEditAllowed(),console.log("mounted this.userEditAllowed",this.userEditAllowed),this.userEditAllowed&&this.getProductDetail()},methods:{toggleSidebar(){console.log("this.sidebar:",this.sidebar),this.sidebar=!this.sidebar,console.log("this.sidebar:",this.sidebar)},checkLang(){var o,e;if(this.$route.query.lang&&((o=this.$store.state.coredata)==null?void 0:o.langs)){let i=this.$helpers.checkValidLanguageSync(this.$route.query.lang,(e=this.$store.state.coredata)==null?void 0:e.langs);i!=null&&i.valid&&(this.language=i.match)}},getUserEditAllowed(){if(this.language=this.$store.state.language,this.user&&this.user!==null&&this.user.type&&this.user.type==="admin"){this.userEditAllowed=!0,this.user.settings.language&&(this.language=this.$store.state.language);return}this.userEditAllowed=!1},getProductDetail:function(){const o=this;this.$route.params&&this.$route.params.category&&this.$route.params.category.toString().trim()!==""&&this.$route.params.product&&this.$route.params.product.toString().trim()!==""&&(this.$route.params.product.toString().trim()==="---new"&&this.$route.params.slug.toString().trim()==="---new"?setTimeout(function(){o.product=o.getEmptyProduct(),o.eventBus.emit("runEditor")},1e3):this.$httpc.get("products/"+this.$route.params.category+"/detail/"+this.$route.params.product+"?edit=true").then(function(e){if(e.data&&(o.product=e.data,o.product.name&&o.$store.state&&typeof o.product.name[o.language.code]<"u"&&(document.title=o.product.name[o.language.code]+" - StretchShop"),o.product&&o.product.categories&&(o.filteredCategoriesSlugs=o.product.categories),o.product&&o.product.properties)){const i=Object.keys(o.product.properties);if(i&&i.length>0)for(let a=0;a<i.length;a++){const s=i[a];o.productPropertyLangSwitches[s]={name:o.checkIfPropertyHasLang(o.product.properties[s],"name"),value:o.checkIfPropertyHasLang(o.product.properties[s],"value")}}}e.data.products&&(o.products=e.data.products),e.data.parentCategoryDetail&&(o.parentCategoryDetail=e.data.parentCategoryDetail)}).catch(function(e){console.log(e)}).then(function(){o.eventBus.emit("runEditor")}))},getProductImagePath(o){if(o&&this.$store.state.coredata&&this.$store.state.coredata.settings&&this.$store.state.coredata.settings.assets&&this.$store.state.coredata.settings.assets.url){const e=new Date;return this.$helpers.getProductImagePath(this.$store.state.coredata,o)+"?"+e.getTime()}return null},getProductGalleryImagePath(o,e){return o&&this.$store.state.coredata&&this.$store.state.coredata.settings&&this.$store.state.coredata.settings.assets&&this.$store.state.coredata.settings.assets.url?this.$helpers.getProductImagePath(this.$store.state.coredata,o,e):null},newPropertyCardModal(){this.modal=!0},checkIfPropertyHasLang(o,e){if(o&&o[e]&&this.$store&&this.$store.state&&this.$store.state.coredata&&this.$store.state.coredata.langCodes){const a=Object.keys(o[e]).filter(s=>this.$store.state.coredata.langCodes.includes(s));if(a&&a.length>0)return!0}return!1},changePropertyLangOption(o,e,i){console.log("value query:",".product-properties .table data-key["+e+"] .field.property-"+i+" input[text]");const a=this.$el.querySelector('.product-properties .table [data-key="'+e+'"] .field.property-'+i+" input[type=text]").value,s=this.productPropertyLangSwitches[e];let l="remove";s[i]===!1&&(l="add");const h=this.product.properties[e];if(console.log("changePropertyLangOption params and value:",o,e,i,a,l),i&&i==="name"){if(l==="remove")s.name===!0&&s.value===!0?(delete h.name,delete this.product.properties[e],this.product.properties[a]=h):s.name===!0&&s.value===!1&&(delete this.product.properties[e],this.product.properties[a]=h.value);else if(l==="add"){this.product.properties[e].constructor!==Object&&(this.product.properties[e]={value:this.product.properties[e]}),this.product.properties[e][i]={};for(let g=0;g<this.$store.state.coredata.langCodes.length;g++)this.product.properties[e][i][this.$store.state.coredata.langCodes[g]]=null;this.product.properties[e][i][this.language.code]=a}}else if(i&&i==="value"){if(l==="remove")s.name===!0?this.product.properties[e].value=a:s.name===!1&&(this.product.properties[e]=a);else if(l==="add"){this.product.properties[e].constructor===Object?(delete h.value,this.product.properties[e]=h):(this.product.properties[e]={},this.product.properties[e][i]={});for(let g=0;g<this.$store.state.coredata.langCodes.length;g++)this.product.properties[e][i][this.$store.state.coredata.langCodes[g]]=null;h.value&&h.value.constructor===Array?this.product.properties[e][i][this.language.code]=h.value:h&&h.constructor===Array?this.product.properties[e][i][this.language.code]=h:this.product.properties[e][i][this.language.code]=a}}this.productPropertyLangSwitches[e]&&(console.log("this.productPropertyLangSwitches[key][type]:",this.productPropertyLangSwitches[e][i]),this.productPropertyLangSwitches[e][i]=!this.productPropertyLangSwitches[e][i])},changePropertyValue(o,e){const i=this.$el.querySelector('.product-properties .table [data-key="'+o+'"] .field.property-'+e+" input[type=text]").value,a=this.productPropertyLangSwitches[o];if(console.log("incoming type & nameLangOptions",e,a),e==="key")typeof this.product.properties[i]<"u"?this.$helpers.formUndecorateAndDecorateFields(["property-key"],[{name:"property-key",action:"exists"}]):this.renamePropertyKey(o,i);else if(a&&typeof a[e]<"u")if(e==="name")if(a[e]===!0)console.log("change for lang version of "+e+"."+this.language.code+":",i),this.product.properties[o][e][this.language.code]=i;else if(console.log("change for key:value version of "+e+":",i),typeof this.product.properties[i]<"u")this.$helpers.formUndecorateAndDecorateFields(["property-name"],[{name:"property-name",action:"exists"}]);else{const s=document.querySelector(".field.property-name");this.$helpers.undecorateFormField(s,"exists"),this.renamePropertyKey(o,i)}else e==="value"&&(a[e]===!0?(console.log("change for lang version of "+e+" - this.product.properties["+o+"]["+e+"]["+this.language.code+"]:",i),this.product.properties[o][e][this.language.code]=i):(console.log("change for key:value version of "+e+":",i),typeof this.product.properties[o].value<"u"?this.product.properties[o].value=i:this.product.properties[o]=i))},renamePropertyKey(o,e){const i=this.product.properties[o],a=this.productPropertyLangSwitches[o];delete this.product.properties[o],delete this.productPropertyLangSwitches[o],this.product.properties[e]=i,this.productPropertyLangSwitches[e]=a;const s=this.$el.querySelector('.product-properties .table [data-key="'+o+'"]');s&&s.setAttribute("data-key",e),this.$forceUpdate()},getPropertyStrings(o,e){if(o.constructor===Array)return{name:e,value:o.join(", ")};if(o.constructor===Object){if(typeof o.name<"u"&&typeof o.value<"u"&&this.$store&&this.$store.state&&this.$store.state.language){const i=this.getPropertyNameResult(o,e),a=this.getPropertyValueResult(o,e);if(i!==""&&a!=="")return{name:i,value:a}}else if(typeof o.value<"u"&&this.$store&&this.$store.state&&this.$store.state.language){const i=e,a=this.getPropertyValueResult(o);if(i!==""&&a!=="")return{name:i,value:a}}return{name:e,value:o}}else return{name:e,value:o}},getPropertyNameResult(o,e){return typeof o.name[this.$store.state.language.code]<"u"?o.name[this.$store.state.language.code]:e.name},getPropertyValueResult(o){return typeof o.value[this.$store.state.language.code]<"u"?o.value[this.$store.state.language.code].constructor===Array?o.value[this.$store.state.language.code].join(", "):o.value[this.$store.state.language.code]:o.value},getFilteredCategories:function(o){const e=this;return o&&o.toString().trim()!==""?this.$httpc.post("categories/find",{query:{pathSlug:{$regex:o},type:"products"}}).then(function(i){if(i.data)return i.data}).catch(function(i){console.log(i)}).then(function(i){const a=[];if(i&&i.categories)for(let s=0;s<i.categories.length;s++)e.product.categories.indexOf(i.categories[s].pathSlug)<0&&a.push(i.categories[s].pathSlug);return e.filteredCategoriesSlugs=a,a}):(e.filteredCategoriesSlugs=[],[])},getFilteredRelatedProducts:function(o){const e=this;return o&&o.toString().trim()!==""?this.$httpc.post("products/find",{query:{orderCode:{$regex:o}}}).then(function(i){if(i.data)return i.data}).catch(function(i){console.log(i)}).then(function(i){const a=[];for(let s=0;s<i.length;s++)e.product.data.related.products.indexOf(i[s].orderCode)<0&&a.push(i[s].orderCode);return e.filteredProductCodes=a,a}):(e.filteredProductCodes=[],[])},setProperty(o,e,i,a){if(console.log("add("+o+","+e+") in lang:"+i+" with Name:"+a),typeof o<"u"&&typeof e<"u"&&o&&e)if(this.product&&this.product.properties&&typeof this.product.properties[o]<"u"){const s=this.product.properties[o];typeof a<"u"&&a!==o&&(s.name={},typeof i<"u"?s.name[i]=a:s.name=a)}else{let s={};typeof a<"u"&&a&&(s.name={},typeof i<"u"&&i?s.name[i]=a:s.name=a),typeof i<"u"&&i?(s.value={},s.value[i]=e):typeof s.name<"u"?s.value=e:s=e,s&&(this.product.properties[o]=s)}this.modal=!1},removeProperty(o){console.log("remove("+o+")"),this.product&&this.product.properties&&typeof this.product.properties[o]<"u"&&(delete this.product.properties[o],this.$forceUpdate())},productMainImageDelete(){const o=this;if(confirm("Are you sure?")){const e={timeout:15e3,needsAuth:!0},i=this.getProductImagePath(this.product.orderCode);let a="";if(i.trim()!==""){const s=i.split("/");s.length>0&&(a=s[s.length-1])}console.log(this.product.orderCode,i),this.$httpc.delete("user/image/products/"+this.product.orderCode+"/"+a,e).then(function(s){s&&s.data&&s.data.success&&(console.log("image delete response",s.data),o.$el.querySelector(".product-image-wrapper img.image-main").setAttribute("src",o.getProductImagePath(o.product.orderCode)))})}},productMainImageUpload(o){const e=this;if(e.productMainImageFile=o.target.files,console.log("productMainImageFile:",e.productMainImageFile),e.productMainImageFile){console.log("incoming:",e.productMainImageFile,e.productMainImageFile.length);const s=new FormData;if(e.productMainImageFile.length&&typeof e.productMainImageFile.length<"u"&&e.productMainImageFile.length>0){for(var i=0;i<e.productMainImageFile.length;i++){const l=e.productMainImageFile[i];s.append("files["+i+"]",l)}console.log("incoming 2.1")}else s.append("files[0]",e.productMainImageFile),console.log("incoming 2.2");for(var a of s.entries())console.log(a[0]+", "+a[1]);e.$httpc.post("/products/upload/"+e.product.orderCode+"/main",s,{needsAuth:!0}).then(function(l){if(l&&l.data&&l.data.substr(0,1)==="'"&&l.data[l.data.length-1]==="'"){const h=l.data.length-2;if(l.data=l.data.substr(1,h),l.data=JSON.parse(l.data),l.data.files&&l.data.files.length>0&&l.data.files[0].path&&l.data.files[0].path.trim()!==""){const g=e.$el.querySelector(".product-image-wrapper img.image-main");if(g){const I=new Date;g.setAttribute("src",e.$store.state.coredata.settings.assets.url+"/products/"+l.data.files[0].path+"?"+I.getTime())}}}}).catch(l=>{console.error("product main image upload error:",l)})}},changeEditedLang(){this.fireCounter++,this.editing&&this.newLanguage&&this.newLanguage.code&&this.fireCounter===1&&(window.location=window.location.origin+this.$route.path+"?lang="+this.newLanguage.code)},save(o){const e=this;if(this.product.descriptionLong[e.language.code]=o,this.product&&this.product._id&&!this.product.id&&(this.product.id=this.product._id),this.product.price&&this.product.stockAmount&&(this.product.price=parseFloat(this.product.price),this.product.stockAmount=parseFloat(this.product.stockAmount)),this.product.priceLevels){const a=Object.keys(this.product.priceLevels);a.length>0&&a.forEach(function(s){const l=Object.keys(e.product.priceLevels[s]);l.length>0&&l.forEach(function(h){e.product.priceLevels[s][h].price=parseFloat(e.product.priceLevels[s][h].price)})})}const i={products:[]};i.products.push(this.product),this.$httpc.put("products",i,{needsAuth:!0}).then(function(a){if(a.data&&a.data.length>0){const s=a.data[0],l=e.$router.resolve({name:"productNewEdit",params:{category:s.categories[0],slug:s.slug,product:s._id}});window.location=l.href}}).catch(function(a){console.log("saveProduct error:",a)})},deleteProduct(){const e={products:[{id:this.product._id}]};this.product&&this.product._id&&confirm("Are you sure you want to delete this product?")&&this.$httpc.delete("products",{data:e}).then(i=>{i&&i.data&&alert("Product has been successfully removed. You will be redirected now")})},getEmptyProduct(){const o=this;return{externalId:null,orderCode:null,variationGroupId:null,publisher:o.user.email,type:"product",subtype:null,name:o.$helpers.getLangsObject(o.$store.state.coredata.langCodes),descriptionShort:o.$helpers.getLangsObject(o.$store.state.coredata.langCodes),descriptionLong:o.$helpers.getLangsObject(o.$store.state.coredata.langCodes),price:0,tax:null,stockAmount:0,slug:null,properties:{},categories:[],dates:{dateCreated:null,dateUpdated:null,dateSynced:null},data:{related:{products:[],productResults:[]},gallery:{name:o.$helpers.getLangsObject(o.$store.state.coredata.langCodes),images:[]},contentDependency:!1},note:null,parentCategoryDetail:{},activity:{start:null,end:null}}},checkNameDependents(){if(this.product&&!this.product._id){let o=this.language&&this.language.code?this.language.code:null;this.newLanguage&&this.newLanguage.code&&(o=this.newLanguage.code),this.product.name&&this.product.name[o]&&this.product.name[o].trim()!==""&&((this.product.slug&&this.product.slug.trim()===""||this.dataToGenerateFromName.slug)&&(this.product.slug=this.$helpers.stringToSlug(this.product.name[o]),this.dataToGenerateFromName.slug=!0),(this.product.externalId&&this.product.externalId.trim()===""||this.dataToGenerateFromName.externalId)&&(this.product.externalId=this.$helpers.stringToSlug(this.product.name[o]),this.dataToGenerateFromName.externalId=!0))}},getActivity(){const o={start:null,end:null};return this.product&&this.product!==null&&this.product.activity&&this.product.activity!==null&&(this.product.activity.start&&this.product.activity.start.toString().trim()!==""&&(o.start=new Date(this.product.activity.start)),this.product.activity.end&&this.product.activity.end.toString().trim()!==""&&(o.end=new Date(this.product.activity.end))),o},setActivity(o,e){e&&this.product&&this.product!==null&&(this.product.activity||(this.product.activity={start:null,end:null}),this.product.activity[o]=e)},recalculatePriceLevels(o){const e=this;this.$httpc.get("products/rebuildpl/"+o).then(function(i){i&&i.data&&i.data!==null&&i.data.levels&&(e.product.priceLevels=i.data.levels)})},checkForSubscriptionData(){this.product&&this.product.type&&this.product.type==="subscription"&&(this.product.data||(this.product.data={}),this.product.data.subscription||(this.product.data.subscription={period:"month",duration:1,cycles:0}))}}},n=o=>(W("data-v-a0ad2302"),o=o(),J(),o),ut={key:0,class:"container product-detail",id:"product-new-edit"},pt={class:"product-categories"},ht={class:"title is-3","aria-controls":"contentCategoriesRelated"},gt=n(()=>t("span",{translate:"yes"},"Categories & Related Pages",-1)),_t=b(),mt={class:"categoriesRelated-hidden collapse-content",id:"contentCategoriesRelated","aria-expanded":"true"},ft={class:"container is-fluid p-3"},vt={class:"columns"},yt={class:"column"},bt={class:"product-hidden-properties"},Pt={class:"title is-3","aria-controls":"contentHiddenProperties"},wt=n(()=>t("span",{translate:"yes"},"Product's hidden properties",-1)),Ct=b(),St={class:"editableByAuthor-hidden collapse-content",id:"contentHiddenProperties","aria-expanded":"true"},xt={class:"container is-fluid p-3"},Lt={class:"columns"},It={class:"column"},kt={class:"field"},At=n(()=>t("label",{class:"label",translate:"yes"},"Type",-1)),Dt={class:"control"},Et={class:"columns"},Vt={class:"column"},Ft={class:"field"},Ut=n(()=>t("label",{class:"label",translate:"yes"},"Subtype",-1)),Nt={class:"control"},Tt={class:"columns"},Mt={class:"column"},Rt={class:"field"},Ot=n(()=>t("label",{class:"label",translate:"yes"},"External Id",-1)),Kt={class:"control"},jt={class:"columns"},Bt={class:"column"},qt={class:"field"},Gt=n(()=>t("label",{class:"label",translate:"yes"},"Variation Group Id",-1)),Ht={class:"control"},zt={class:"columns"},Wt={class:"column"},Jt={class:"field"},Yt=n(()=>t("label",{class:"label",translate:"yes"},"Slug",-1)),Qt={class:"control"},Xt={class:"columns"},Zt={class:"column"},$t={class:"field"},te=n(()=>t("label",{class:"label",translate:"yes"},"Note",-1)),ee={class:"control"},se={key:0},oe={class:"columns"},ie={class:"column"},re={class:"field"},le=n(()=>t("label",{class:"label",translate:"yes"},"Activity Start",-1)),ae={class:"control"},ne={class:"columns"},de={class:"column"},ce={class:"field"},ue=n(()=>t("label",{class:"label",translate:"yes"},"Activity End",-1)),pe={class:"control"},he={key:1},ge={class:"columns"},_e={class:"column"},me={class:"field"},fe=n(()=>t("label",{class:"label",translate:"yes"},"Subscription Period",-1)),ve={class:"control"},ye={class:"columns"},be={class:"column"},Pe={class:"field"},we=n(()=>t("label",{class:"label",translate:"yes"},"Subscription Duration",-1)),Ce={class:"control"},Se={class:"columns"},xe={class:"column"},Le={class:"field"},Ie=n(()=>t("label",{class:"label",translate:"yes"},"Subscription Cycles",-1)),ke={class:"control"},Ae={key:0},De={class:"title is-3","aria-controls":"contentHiddenProperties",translate:"yes"},Ee=n(()=>t("span",{translate:"yes"},"Editable by admin user",-1)),Ve=b(),Fe={class:"editableByAdmin-hidden"},Ue={class:"container is-fluid p-3"},Ne={class:"columns"},Te={class:"column"},Me={class:"field"},Re=n(()=>t("label",{class:"label",translate:"yes"},"Publisher",-1)),Oe={class:"control"},Ke={class:"columns"},je={class:"column"},Be={class:"field"},qe=n(()=>t("label",{class:"label",translate:"yes"},"Content Dependency",-1)),Ge={class:"control"},He=b("Content Dependency"),ze={class:"columns reversed"},We={class:"column is-7 pt-6"},Je={class:"product-image-wrapper"},Ye=["src","alt"],Qe={class:"page-image-actions"},Xe={class:"file is-primary action edit"},Ze={class:"file-label"},$e=n(()=>t("span",{class:"file-cta"},[t("span",{class:"file-icon"},[t("i",{class:"fa fa-file-upload"})]),t("span",{class:"file-label show-on-hover",translate:"yes"}," Click to upload ")],-1)),ts=n(()=>t("i",{class:"fa fa-trash"},null,-1)),es=b("\xA0 "),ss=n(()=>t("span",{class:"show-on-hover",translate:"yes"},"Click to remove",-1)),os=[ts,es,ss],is={class:"column is-5 pl-6 data-main"},rs={key:0,class:"breadcrumb","aria-label":"breadcrumbs"},ls={key:0},as={class:"is-active"},ns={key:1,class:"has-text-left"},ds={class:"content"},cs={class:"columns"},us={class:"column is-2"},ps={class:"has-text-grey-light is-size-7",translate:"yes"},hs={class:"column is-4"},gs={class:"field"},_s=n(()=>t("label",{class:"label",translate:"yes"},"Order code",-1)),ms={class:"control"},fs=n(()=>t("div",{class:"column is-6"},[t("p",{class:"help is-danger",translate:"yes"},"Changing OrderCode may disable images and other external dependecies")],-1)),vs={class:"field"},ys=n(()=>t("label",{class:"label",translate:"yes"},"Name",-1)),bs={class:"control"},Ps={class:"content"},ws={class:"columns"},Cs={class:"column is-6"},Ss={class:"field"},xs={class:"label"},Ls=n(()=>t("span",{translate:"yes"},"Price",-1)),Is={class:"control"},ks={key:0,class:"is-size-7"},As={key:1,class:"detail-price is-size-7 has-text-grey-light"},Ds=n(()=>t("span",{translate:"yes"},"Without Tax",-1)),Es={key:0,class:"columns product-hidden-pricelevels"},Vs={class:"column is-12"},Fs=n(()=>t("span",{id:"productPriceLevels"},"Edit Price Levels",-1)),Us=[Fs],Ns={class:"column is-6 has-text-right"},Ts={class:"column is-6"},Ms=["onUpdate:modelValue","onKeyup"],Rs={class:"columns"},Os={class:"column"},Ks={class:"field"},js=n(()=>t("label",{class:"label",translate:"yes"},"Description Short",-1)),Bs={class:"control"},qs={class:"columns"},Gs={class:"column"},Hs={key:0,class:"column product-variations"},zs={class:"variation-image"},Ws=["src","alt"],Js={class:"columns"},Ys=n(()=>t("div",{class:"column is-6"},null,-1)),Qs={class:"column is-6"},Xs=["data-id"],Zs=b(" \xA0 "),$s=n(()=>t("span",{translate:"yes"},"Add to Cart",-1)),to={class:"field"},eo=n(()=>t("label",{class:"label",translate:"yes"},"In stock",-1)),so={class:"control"},oo={key:0,class:"columns product-descriptions reversed-desktop"},io={class:"column is-5"},ro={class:"productContent","data-name":"description"},lo=n(()=>t("div",{class:"column is-7"},null,-1)),ao={key:1,class:"product-properties bg-grey"},no={class:"columns"},co=n(()=>t("div",{class:"column is-6"},[t("h3",{class:"title is-3 has-text-left",translate:"yes"},"Properties")],-1)),uo={class:"column is-6 has-text-right"},po=n(()=>t("i",{class:"fa fa-plus"},null,-1)),ho=b("\xA0 "),go=n(()=>t("span",{translate:"yes"},"Add New Property",-1)),_o=[po,ho,go],mo={class:"columns"},fo={class:"column is-12"},vo={class:"table"},yo=["data-key"],bo={class:"field property-key"},Po=n(()=>t("label",{class:"label",translate:"yes"},"Property Key",-1)),wo={class:"control"},Co=["disabled","data-orig","value","onKeyup"],So=n(()=>t("div",{class:"form-messages is-hidden"},[t("div",{class:"form-message","data-message":"exists",translate:"yes"},"This key already exists")],-1)),xo={class:"field property-name"},Lo=n(()=>t("label",{class:"label",translate:"yes"},"Property Name",-1)),Io={class:"control"},ko=["data-orig","value","onKeyup"],Ao=b("Lang"),Do=n(()=>t("div",{class:"form-messages is-hidden"},[t("div",{class:"form-message","data-message":"exists",translate:"yes"},"This key already exists")],-1)),Eo={class:"field property-value"},Vo=n(()=>t("label",{class:"label",translate:"yes"},"Property Value",-1)),Fo={class:"control"},Uo=["data-orig","value","onKeyup"],No=b("Lang"),To={width:"50",class:"has-text-centered"},Mo=["onClick"],Ro={key:2},Oo={key:3,class:"columns product-related"},Ko={class:"column is-12"},jo=n(()=>t("h3",{class:"title is-3 has-text-left",translate:"yes"},"Related",-1)),Bo={class:"tile is-ancestor"},qo={key:4,class:"columns product-delete"},Go={class:"column is-12"},Ho=n(()=>t("p",{translate:"yes"},"Warning: This action cannot be undone!",-1));function zo(o,e,i,a,s,l){const h=y("font-awesome-icon"),g=y("o-inputitems"),I=y("o-field"),k=y("o-collapse"),U=y("o-autocomplete"),N=y("o-datetimepicker"),T=y("o-datepicker"),E=y("o-switch"),M=y("sidebar"),A=y("router-link"),R=y("editorwrapper"),O=y("slider-carousel"),K=y("product-box"),j=y("product-property");return s.product&&s.userEditAllowed?(d(),c("div",ut,[p(M,{fullheight:!0,overlay:!1,right:!0,open:s.sidebar,canCancel:!1},{default:_(()=>[t("div",pt,[p(k,{open:!0,"aria-id":"contentCategoriesRelated"},{trigger:_(r=>[t("h3",ht,[gt,_t,p(h,{icon:r.open?"angle-down":"angle-up"},null,8,["icon"])])]),default:_(()=>[t("div",mt,[t("div",ft,[t("div",vt,[t("div",yt,[t("section",null,[p(I,{label:"Enter categories' url slugs"},{default:_(()=>[p(g,{modelValue:s.product.categories,"onUpdate:modelValue":e[0]||(e[0]=r=>s.product.categories=r),data:s.filteredCategoriesSlugs,autocomplete:"","allow-new":!1,field:"user.first_name",iconPack:"fas",icon:"tags",placeholder:"Categories",type:"is-info",onTyping:l.getFilteredCategories},null,8,["modelValue","data","onTyping"])]),_:1})])])])])])]),_:1})]),t("div",bt,[p(k,{open:!0,"aria-id":"contentHiddenProperties"},{trigger:_(r=>[t("h3",Pt,[wt,Ct,p(h,{icon:(r.open,"angle-up")},null,8,["icon"])])]),default:_(()=>[t("div",St,[t("div",xt,[t("div",Lt,[t("div",It,[t("div",kt,[At,t("div",Dt,[p(U,{modelValue:s.product.type,"onUpdate:modelValue":e[1]||(e[1]=r=>s.product.type=r),placeholder:"e.g. product","keep-first":!0,"open-on-focus":!0,data:s.productTypes,onBlur:l.checkForSubscriptionData,field:"product.type",clearable:!1},null,8,["modelValue","data","onBlur"])])])])]),t("div",Et,[t("div",Vt,[t("div",Ft,[Ut,t("div",Nt,[f(t("input",{class:"input",type:"text","onUpdate:modelValue":e[2]||(e[2]=r=>s.product.subtype=r),translate:"yes",placeholder:"Subtype"},null,512),[[v,s.product.subtype]])])])])]),t("div",Tt,[t("div",Mt,[t("div",Rt,[Ot,t("div",Kt,[f(t("input",{class:"input",type:"text","onUpdate:modelValue":e[3]||(e[3]=r=>s.product.externalId=r),translate:"yes",placeholder:"External Id"},null,512),[[v,s.product.externalId]])])])])]),t("div",jt,[t("div",Bt,[t("div",qt,[Gt,t("div",Ht,[f(t("input",{class:"input",type:"text","onUpdate:modelValue":e[4]||(e[4]=r=>s.product.variationGroupId=r),translate:"yes",placeholder:"Variation Group Id"},null,512),[[v,s.product.variationGroupId]])])])])]),t("div",zt,[t("div",Wt,[t("div",Jt,[Yt,t("div",Qt,[f(t("input",{class:"input",type:"text","onUpdate:modelValue":e[5]||(e[5]=r=>s.product.slug=r),translate:"yes",placeholder:"Slug"},null,512),[[v,s.product.slug]])])])])]),t("div",Xt,[t("div",Zt,[t("div",$t,[te,t("div",ee,[f(t("textarea",{class:"textarea","onUpdate:modelValue":e[6]||(e[6]=r=>s.product.note=r),translate:"yes",placeholder:"Note"},null,512),[[v,s.product.note]])])])])]),s.product?(d(),c("div",se,[t("div",oe,[t("div",ie,[t("div",re,[le,t("div",ae,[p(N,{value:l.getActivity().start,onInput:e[7]||(e[7]=r=>l.setActivity("start",r)),placeholder:"Activity Start DateTime",iconPack:"fa",icon:"calendar-alt",iconPrev:"angle-left",iconNext:"angle-right",position:"bottom-left","trap-focus":""},null,8,["value"])])])])]),t("div",ne,[t("div",de,[t("div",ce,[ue,t("div",pe,[p(T,{value:l.getActivity().end,onInput:e[8]||(e[8]=r=>l.setActivity("end",r)),placeholder:"Activity End DateTime",iconPack:"fa",icon:"calendar-alt",iconPrev:"angle-left",iconNext:"angle-right",position:"bottom-left","trap-focus":""},null,8,["value"])])])])])])):m("",!0),s.product.type==="subscription"&&s.product.data&&s.product.data.subscription?(d(),c("div",he,[t("div",ge,[t("div",_e,[t("div",me,[fe,t("div",ve,[f(t("input",{class:"input",type:"text","onUpdate:modelValue":e[9]||(e[9]=r=>s.product.data.subscription.period=r),translate:"yes",placeholder:"Slug"},null,512),[[v,s.product.data.subscription.period]])])])])]),t("div",ye,[t("div",be,[t("div",Pe,[we,t("div",Ce,[f(t("input",{class:"input",type:"number","onUpdate:modelValue":e[10]||(e[10]=r=>s.product.data.subscription.duration=r),translate:"yes",placeholder:"Slug"},null,512),[[v,s.product.data.subscription.duration]])])])])]),t("div",Se,[t("div",xe,[t("div",Le,[Ie,t("div",ke,[f(t("input",{class:"input",type:"number","onUpdate:modelValue":e[11]||(e[11]=r=>s.product.data.subscription.cycles=r),translate:"yes",placeholder:"Slug"},null,512),[[v,s.product.data.subscription.cycles]])])])])])])):m("",!0)])])]),_:1}),l.user&&l.user!=null&&l.user.type&&l.user.type=="admin"?(d(),c("div",Ae,[p(k,{open:!0,"aria-id":"contentHiddenPropertiesAdmin"},{trigger:_(r=>[t("h3",De,[Ee,Ve,p(h,{icon:r.open?"angle-down":"angle-up"},null,8,["icon"])])]),default:_(()=>[t("div",Fe,[t("div",Ue,[t("div",Ne,[t("div",Te,[t("div",Me,[Re,t("div",Oe,[f(t("input",{class:"input",type:"text","onUpdate:modelValue":e[12]||(e[12]=r=>s.product.publisher=r),translate:"yes",placeholder:"Publisher"},null,512),[[v,s.product.publisher]])])])])]),t("div",Ke,[t("div",je,[t("div",Be,[qe,t("div",Ge,[p(E,{type:"is-info",modelValue:s.product.data.contentDependency,"onUpdate:modelValue":e[13]||(e[13]=r=>s.product.data.contentDependency=r),translate:"yes"},{default:_(()=>[He]),_:1},8,["modelValue"])])])])])])])]),_:1})])):m("",!0)])]),_:1},8,["open"]),t("div",ze,[t("div",We,[t("div",Je,[t("img",{src:l.getProductImagePath(s.product.orderCode),alt:s.product.name[s.language.code],class:"image-main",onerror:"this.src='/assets/_site/logo-product.svg'"},null,8,Ye),t("div",Qe,[t("div",Xe,[t("label",Ze,[t("input",{class:"file-input",type:"file",name:"resume",onInput:e[14]||(e[14]=r=>l.productMainImageUpload(r))},null,32),$e])]),t("a",{class:"action remove button is-danger has-text-white",onClick:e[15]||(e[15]=S(r=>l.productMainImageDelete(),["prevent"]))},os)])])]),t("div",is,[s.parentCategoryDetail?(d(),c("nav",rs,[s.parentCategoryDetail.parentCategories?(d(),c("ul",ls,[(d(!0),c(w,null,C(s.parentCategoryDetail.parentCategories,(r,u)=>(d(),c("li",{key:u},[p(A,{title:r.name[s.language.code],to:{name:"categoryList",params:{category:r.pathSlug}}},{default:_(()=>[b(P(r.name[s.language.code]),1)]),_:2},1032,["title","to"])]))),128)),t("li",as,[p(A,{title:s.parentCategoryDetail.name[s.language.code],to:{name:"categoryList",params:{category:s.parentCategoryDetail.pathSlug}},"aria-current":"page"},{default:_(()=>[b(P(s.parentCategoryDetail.name[s.language.code]),1)]),_:1},8,["title","to"])])])):m("",!0)])):m("",!0),s.product&&s.product!=null?(d(),c("div",ns,[t("div",ds,[t("div",cs,[t("div",us,[t("span",ps,P(s.product.type)+":",1)]),t("div",hs,[t("div",gs,[_s,t("div",ms,[f(t("input",{class:"input has-text-weight-normal has-text-left",type:"text","onUpdate:modelValue":e[16]||(e[16]=r=>s.product.orderCode=r),translate:"yes",placeholder:"Order code"},null,512),[[v,s.product.orderCode]])])])]),fs])]),t("div",vs,[ys,t("div",bs,[f(t("input",{class:"input is-size-1 has-text-weight-normal",type:"text","onUpdate:modelValue":e[17]||(e[17]=r=>s.product.name[s.language.code]=r),onKeyup:e[18]||(e[18]=r=>l.checkNameDependents()),translate:"yes",placeholder:"Name"},null,544),[[v,s.product.name[s.language.code]]])])]),t("div",Ps,[t("div",ws,[t("div",Cs,[t("div",Ss,[t("label",xs,[Ls,b(" "+P(o.$store.state.currency.symbol),1)]),t("div",Is,[f(t("input",{class:"input is-size-4 has-text-weight-normal",type:"number","onUpdate:modelValue":e[19]||(e[19]=r=>s.product.price=r),translate:"yes",placeholder:"Price"},null,512),[[v,s.product.price]])])]),s.product.type=="subscription"?(d(),c("div",ks," /"+P(s.product.data.subscription.duration)+" "+P(s.product.data.subscription.period)+" (x"+P(s.product.data.subscription.cycles)+") ",1)):m("",!0),s.product.tax&&s.product.tax>0?(d(),c("div",As,[Ds,b(" ("+P(s.product.tax*100)+"%): "+P(o.$helpers.numeral(s.product.price-s.product.price*s.product.tax).format("0 0.00"))+" "+P(o.$store.state.currency.symbol),1)])):m("",!0)])]),s.product.priceLevels?(d(),c("div",Es,[t("div",Vs,[t("div",null,[p(k,{open:!1,"aria-id":"contentIdForA11y2",animation:"slide",modelValue:s.showPriceLevels,"onUpdate:modelValue":e[22]||(e[22]=r=>s.showPriceLevels=r)},{trigger:_(()=>[t("a",{href:"#",onClick:e[20]||(e[20]=S(r=>s.showPriceLevels=!s.showPriceLevels,["prevent"])),"aria-controls":"contentIdForA11y2"},Us)]),default:_(()=>[(d(!0),c(w,null,C(s.product.priceLevels,(r,u)=>(d(),c("div",{key:u},[(d(!0),c(w,null,C(r,(x,L)=>(d(),c("div",{class:"columns",key:L},[t("div",Ns,P(u+"."+L),1),t("div",Ts,[f(t("input",{class:"input has-text-weight-normal has-text-right",type:"number","onUpdate:modelValue":V=>s.product.priceLevels[u][L].price=V,placeholder:"Price",onKeyup:V=>s.product.priceLevels[u][L].type="defined"},null,40,Ms),[[v,s.product.priceLevels[u][L].price]])])]))),128))]))),128)),t("div",null,[t("button",{class:"button add-to-cart",onClick:e[21]||(e[21]=S(r=>l.recalculatePriceLevels(s.product._id),["prevent"])),translate:"yes"}," Recalculate Price Levels ")])]),_:1},8,["modelValue"])])])])):m("",!0),t("div",Rs,[t("div",Os,[t("div",Ks,[js,t("div",Bs,[f(t("input",{class:"input is-size-5 has-text-weight-normal",type:"text","onUpdate:modelValue":e[23]||(e[23]=r=>s.product.descriptionShort[s.language.code]=r),translate:"yes",placeholder:"Description Short"},null,512),[[v,s.product.descriptionShort[s.language.code]]])])])])]),t("div",qs,[t("div",Gs,[s.product.data&&s.product.data.variations?(d(),c("div",Hs,[(d(!0),c(w,null,C(s.product.data.variations,(r,u)=>(d(),D(A,{key:r._id+u,class:"variation",title:r.name[o.$store.state.language.code],to:{name:"productDetail",params:{category:r.categories[0],product:r._id,slug:r.slug}}},{default:_(()=>[t("div",zs,[t("img",{src:l.getProductImagePath(r.orderCode),alt:r.name[o.$store.state.language.code]},null,8,Ws)]),t("p",null,P(r.name[o.$store.state.language.code]),1)]),_:2},1032,["title","to"]))),128))])):m("",!0)])]),t("div",Js,[Ys,t("div",Qs,[t("button",{class:"button add-to-cart is-primary","data-id":s.product._id,onClick:e[24]||(e[24]=S(r=>o.addToCart(r),["prevent"])),disabled:""},[p(h,{icon:"cart-plus"}),Zs,$s],8,Xs),t("div",to,[eo,t("div",so,[f(t("input",{class:"input has-text-weight-normal has-text-left",type:"text","onUpdate:modelValue":e[25]||(e[25]=r=>s.product.stockAmount=r),translate:"yes",placeholder:"In stock"},null,512),[[v,s.product.stockAmount]])])])])])])])):m("",!0)])]),s.product&&s.product!=null?(d(),c("div",oo,[t("div",io,[t("div",ro,[p(R,{type:"editorjs",editordata:{editorjs:{setup:l.editorToolsConfig,data:s.product.descriptionLong[s.language.code]}}},null,8,["editordata"])])]),lo])):m("",!0),s.product&&s.product!=null&&s.product.properties?(d(),c("div",ao,[t("div",no,[co,t("div",uo,[t("a",{class:"button is-primary is-info",onClick:e[26]||(e[26]=S(r=>l.newPropertyCardModal(),["prevent"]))},_o)])]),t("div",mo,[t("div",fo,[t("div",null,[t("table",vo,[(d(!0),c(w,null,C(s.product.properties,(r,u)=>(d(),c("tr",{key:u,"data-key":u},[t("th",null,[t("div",bo,[Po,t("div",wo,[t("input",{class:"input has-text-weight-normal has-text-left",disabled:l.getPropertyStrings(r,u).name===u,type:"text",translate:"yes",placeholder:"Property Key","data-orig":u,value:u,onKeyup:x=>l.changePropertyValue(u,"key")},null,40,Co)]),So])]),t("td",null,[t("div",xo,[Lo,t("div",Io,[t("input",{class:"input has-text-weight-normal has-text-left",type:"text",translate:"yes",placeholder:"Property Name","data-orig":l.getPropertyStrings(r,u).name,value:l.getPropertyStrings(r,u).name,onKeyup:x=>l.changePropertyValue(u,"name")},null,40,ko),p(E,{type:"is-info",value:l.checkIfPropertyHasLang(r,"name"),onInput:x=>l.changePropertyLangOption(r,u,"name"),translate:"yes"},{default:_(()=>[Ao]),_:2},1032,["value","onInput"])]),Do])]),t("td",null,[t("div",Eo,[Vo,t("div",Fo,[t("input",{class:"input has-text-weight-normal has-text-left",type:"text",translate:"yes",placeholder:"Property Value","data-orig":l.getPropertyStrings(r,u).value,value:l.getPropertyStrings(r,u).value,onKeyup:x=>l.changePropertyValue(u,"value")},null,40,Uo),p(E,{type:"is-info",value:l.checkIfPropertyHasLang(r,"value"),onInput:x=>l.changePropertyLangOption(r,u,"value")},{default:_(()=>[No]),_:2},1032,["value","onInput"])])])]),t("td",To,[t("a",{href:"#revemoProperty",class:"is-size-4 has-text-danger",onClick:S(x=>l.removeProperty(u),["prevent"])},[p(h,{icon:"minus"})],8,Mo)])],8,yo))),128))])])])])])):m("",!0),p(O,{product:s.product,editable:!0},null,8,["product"]),s.product&&s.product.data&&s.product.data.related&&s.product.data.related.products?(d(),c("section",Ro,[p(I,{label:"Enter order codes of related products"},{default:_(()=>[p(g,{modelValue:s.product.data.related.products,"onUpdate:modelValue":e[27]||(e[27]=r=>s.product.data.related.products=r),data:s.filteredProductCodes,autocomplete:"","allow-new":!1,field:"user.first_name",iconPack:"fas",icon:"tags",placeholder:"Related",type:"is-info",onTyping:l.getFilteredRelatedProducts},null,8,["modelValue","data","onTyping"])]),_:1})])):m("",!0),s.product&&s.product!=null&&s.product.data&&s.product.data.related&&s.product.data.related.productResults&&s.product.data.related.productResults.length>0&&o.$store&&o.$store.state&&o.$store.state.coredata?(d(),c("div",Oo,[t("div",Ko,[jo,t("div",Bo,[(d(!0),c(w,null,C(s.product.data.related.productResults,(r,u)=>(d(),D(A,{key:r._id+u,class:"tile is-parent is-3",title:r.descriptionShort[s.language.code],to:{name:"productDetail",params:{category:s.parentCategoryDetail.pathSlug,product:r._id,slug:r.slug}}},{default:_(()=>[p(K,{product:r},null,8,["product"])]),_:2},1032,["title","to"]))),128))])])])):m("",!0),s.product&&s.product!=null?(d(),c("div",qo,[t("div",Go,[t("section",null,[t("button",{class:"button is-danger",onClick:e[28]||(e[28]=r=>l.deleteProduct()),translate:"yes"},"DELETE This Product"),Ho])])])):m("",!0),p(j,{modal:s.modal},null,8,["modal"])])):m("",!0)}const Yo=F(ct,[["render",zo],["__scopeId","data-v-a0ad2302"]]);export{Yo as default};
