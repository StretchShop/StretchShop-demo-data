var E=Object.defineProperty;var O=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var V=(s,t,r)=>t in s?E(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,k=(s,t)=>{for(var r in t||(t={}))F.call(t,r)&&V(s,r,t[r]);if(O)for(var r of O(t))x.call(t,r)&&V(s,r,t[r]);return s};import{x as M,_ as I,r as f,o as i,c as d,a as e,e as v,f as S,b as u,v as p,t as c,g as _,j as h,h as N,F as g,i as P,w as U,d as q,s as D,y as z,z as L,m as j,q as B}from"./index.f358bf2e.js";import{O as W}from"./PaymentStripe.2892f1af.js";const R={name:"OrderUser",data(){return{newUserEmail:"",newUserEmail2:"",newUserPassword:"",newUserPassword2:""}},computed:k({},M({user:"getUserProfile"})),mounted:function(){this.eventBus.emit("translateContent",this.$store.getters.getTranslates)},methods:{updateUserData:function(){if(this.user){const t=this.$helpers.propertiesRequiredConfirm({email:this.newUserEmail,email2:this.newUserEmail,password:this.newUserPassword,password2:this.newUserPassword2},["email","password"],["email","password"]);if(t.result&&this.newUserEmail&&this.newUserEmail!=="")this.user.addressInvoice.email=this.newUserEmail,this.$store.state.user.email=this.newUserEmail,this.$store.state.password=this.newUserPassword,this.$parent.orderParams.order.user.email=this.newUserEmail,this.$parent.orderParams.order.user.password=this.newUserPassword;else{console.log(" xxxx - :",t,".field."+t.fields[0],this.$el.querySelector(".field."+t.fields[0]));const r=this.$el.querySelector(".field."+t.fields[0]);r&&r.rollIntoView({behaviour:"smooth",block:"start",inline:"nearest"}),this.$helpers.formUndecorateAndDecorateFields(t.fields,t.errors)}}const s=Object.assign({},this.user.addressInvoice);if(delete s.email,this.$helpers.verifyAddress(s)&&(this.user&&this.user.company&&(this.user.company.name||this.user.company.orgId||this.user.company.taxId||this.user.company.taxVatId)&&(this.user.addressInvoice.companyName=this.user.company.name,this.user.addressInvoice.companyOrgId=this.user.company.orgId,this.user.addressInvoice.companyTaxId=this.user.company.taxId,this.user.addressInvoice.companyTaxVatId=this.user.company.taxVatId),this.$parent.updateOrder(),this.user&&this.user!==null&&this.user.addressInvoice&&this.user.addressInvoice.nameFirst&&this.user.addressInvoice.nameLast&&this.$store.state.user&&this.$store.state.user.profile&&this.$store.state.user.profile.addressInvoice.nameFirst&&this.$store.state.user.profile.addressInvoice.nameLast&&(this.$store.state.user.profile.addressInvoice.nameFirst!==this.user.addressInvoice.nameFirst&&(this.$store.state.user.profile.addressInvoice.nameFirst=this.user.addressInvoice.nameFirst),this.$store.state.user.profile.addressInvoice.nameLast!==this.user.addressInvoice.nameLast&&(this.$store.state.user.profile.addressInvoice.nameLast=this.user.addressInvoice.nameLast)),(typeof this.$parent.orderParams=="undefined"||this.$parent.orderParams===null)&&(this.$parent.orderParams={}),(typeof this.$parent.orderParams.order=="undefined"||this.$parent.orderParams.order===null)&&(this.$parent.orderParams.order={}),this.$parent.orderParams.order.addresses={invoiceAddress:this.user.addressInvoice},{addresses:[]}.addresses.push(this.user.addressInvoice),this.$parent.orderParams.errors&&this.$parent.orderParams.errors.userErrors&&this.$parent.orderParams.errors.userErrors.length>0)){const r={fields:[],errors:[]};console.log("responseResult",r),this.$parent.orderParams.errors.userErrors.forEach(o=>{r.fields.push(o.value),r.errors.push({name:o.value,action:o.desc})}),this.$helpers.formUndecorateAndDecorateFields(r.fields,r.errors);const m=this.$el.querySelector(".field."+r.fields[0]);m&&m.scrollIntoView({behaviour:"smooth",block:"start",inline:"nearest"})}}}},G={id:"orderUser"},Y=e("h2",{class:"title is-2",translate:"yes"},"Your Address",-1),H={key:0},Z={class:"columns"},J={class:"column is-12"},Q=e("span",{translate:"yes"},"Already registered?",-1),K=_("Log in"),X={class:"columns is-variable is-2 is-centered"},ee={class:"column is-6",id:"cart-user-email"},se={class:"field email"},te=e("label",{class:"label",translate:"yes"},"Email",-1),re={class:"control"},ae=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This field cannot be empty"),e("div",{class:"form-message","data-message":"exists",translate:"yes"},"This email already exists")],-1),oe={class:"column is-6",id:"cart-user-email2"},ie={class:"field email2"},de=e("label",{class:"label",translate:"yes"},"Email Confirm",-1),ne={class:"control"},le=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This field cannot be empty"),e("div",{class:"form-message","data-message":"not confirmed",translate:"yes"},"Values do not match")],-1),ce={class:"columns is-variable is-2 is-centered"},me={class:"column is-6",id:"cart-user-password"},ue={class:"field password"},he=e("label",{class:"label",translate:"yes"},"Password",-1),pe={class:"control"},ye=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This field cannot be empty")],-1),_e={class:"column is-6",id:"cart-user-password2"},ve={class:"field password2"},$e=e("label",{class:"label",translate:"yes"},"Password Confirm",-1),fe={class:"control"},ge=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This field cannot be empty"),e("div",{class:"form-message","data-message":"not confirmed",translate:"yes"},"Values do not match")],-1),Pe=e("div",{class:"columns"},[e("div",{class:"column is-12"},[e("hr")])],-1),be={key:1},De=e("span",{translate:"yes"},"Logged in as",-1),Ie=_(" \xA0 "),ke={key:0},Ce={key:1},Te=e("br",null,null,-1),we=e("span",{translate:"yes"},"Please check your email to verify your email",-1),Ae={class:"columns is-variable is-2"},Se={class:"column is-6",id:"cart-user-name-first"},Ue={class:"field nameFirst"},Oe=e("label",{class:"label",translate:"yes"},"First Name",-1),Ve={class:"control"},Ne=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),Le={class:"column is-6",id:"cart-user-name-last"},Ee={class:"field nameLast"},Fe=e("label",{class:"label",translate:"yes"},"Last Name",-1),xe={class:"control"},Me=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),qe={class:"columns is-variable is-2"},ze={class:"column is-12",id:"cart-user-street"},je={class:"field street"},Be=e("label",{class:"label",translate:"yes"},"Street",-1),We={class:"control"},Re=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),Ge={class:"columns is-variable is-2"},Ye={class:"column is-12",id:"cart-user-street2"},He={class:"field street2"},Ze=e("label",{class:"label",translate:"yes"},"Street 2",-1),Je={class:"control"},Qe={class:"columns is-variable is-2"},Ke={class:"column is-4",id:"cart-user-zip"},Xe={class:"field zip"},es=e("label",{class:"label",translate:"yes"},"ZIP",-1),ss={class:"control"},ts=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),rs={class:"column is-8",id:"cart-user-city"},as={class:"field city"},os=e("label",{class:"label",translate:"yes"},"City",-1),is={class:"control"},ds=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),ns={class:"columns is-variable is-2"},ls={class:"column is-6",id:"cart-user-state"},cs={class:"field"},ms=e("label",{class:"label",translate:"yes"},"State",-1),us={class:"control"},hs={class:"column is-6",id:"cart-user-country"},ps={class:"field country"},ys=e("label",{class:"label",translate:"yes"},"Country",-1),_s={class:"control select"},vs=["value"],$s=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),fs={class:"columns is-variable is-2 is-centered"},gs={class:"column is-6"},Ps={class:"field phone"},bs=e("label",{class:"label",translate:"yes"},"Phone",-1),Ds={class:"control"},Is=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),ks=e("hr",null,null,-1),Cs={key:2,class:"simple-wrapper"},Ts={class:"columns is-variable is-2 is-centered"},ws={class:"column is-12"},As={class:"field companyName"},Ss=e("label",{class:"label",translate:"yes"},"Company Name",-1),Us={class:"control"},Os={class:"columns is-variable is-2 is-centered"},Vs={class:"column is-6"},Ns={class:"field companyOrgId"},Ls=e("label",{class:"label",translate:"yes"},"Organisation ID",-1),Es={class:"control"},Fs={class:"columns is-variable is-2 is-centered"},xs={class:"column is-6"},Ms={class:"field companyTaxId"},qs=e("label",{class:"label"},"Company Tax ID",-1),zs={class:"control"},js={class:"column is-6"},Bs={class:"field companyTaxVatId"},Ws=e("label",{class:"label"},"Company VAT ID",-1),Rs={class:"control"},Gs={class:"button is-success",type:"submit"},Ys=_(" \xA0 "),Hs=e("span",{translate:"yes"},"Set user order data",-1);function Zs(s,t,r,m,o,l){const y=f("router-link"),n=f("font-awesome-icon");return i(),d("div",G,[Y,e("form",{onSubmit:t[17]||(t[17]=U((...a)=>l.updateUserData&&l.updateUserData(...a),["prevent"]))},[!s.$store.state.user.logged||s.$store.state.user.logged!==!0?(i(),d("div",H,[e("div",Z,[e("div",J,[Q,v(y,{to:{name:"login"},tag:"a",class:"","active-class":"is-active",translate:"yes"},{default:S(()=>[K]),_:1})])]),e("div",X,[e("div",ee,[e("div",se,[te,e("div",re,[u(e("input",{class:"input",type:"email","onUpdate:modelValue":t[0]||(t[0]=a=>o.newUserEmail=a),translate:"yes",placeholder:"Email"},null,512),[[p,o.newUserEmail]])]),ae])]),e("div",oe,[e("div",ie,[de,e("div",ne,[u(e("input",{class:"input",type:"email","onUpdate:modelValue":t[1]||(t[1]=a=>o.newUserEmail2=a),translate:"yes",placeholder:"Email Confirm"},null,512),[[p,o.newUserEmail2]])]),le])])]),e("div",ce,[e("div",me,[e("div",ue,[he,e("div",pe,[u(e("input",{class:"input",type:"password","onUpdate:modelValue":t[2]||(t[2]=a=>o.newUserPassword=a),translate:"yes",placeholder:"Password"},null,512),[[p,o.newUserPassword]])]),ye])]),e("div",_e,[e("div",ve,[$e,e("div",fe,[u(e("input",{class:"input",type:"password","onUpdate:modelValue":t[3]||(t[3]=a=>o.newUserPassword2=a),translate:"yes",placeholder:"Password Confirm"},null,512),[[p,o.newUserPassword2]])]),ge])])]),Pe])):(i(),d("div",be,[De,Ie,s.user.username?(i(),d("span",ke,c(s.user.username),1)):s.user.email?(i(),d("span",Ce,[_(c(s.user.email)+" ",1),Te,we])):h("",!0)])),e("div",Ae,[e("div",Se,[e("div",Ue,[Oe,e("div",Ve,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[4]||(t[4]=a=>s.user.addressInvoice.nameFirst=a),translate:"yes",placeholder:"First Name"},null,512),[[p,s.user.addressInvoice.nameFirst]])]),Ne])]),e("div",Le,[e("div",Ee,[Fe,e("div",xe,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[5]||(t[5]=a=>s.user.addressInvoice.nameLast=a),translate:"yes",placeholder:"Last Name"},null,512),[[p,s.user.addressInvoice.nameLast]])]),Me])])]),e("div",qe,[e("div",ze,[e("div",je,[Be,e("div",We,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[6]||(t[6]=a=>s.user.addressInvoice.street=a),translate:"yes",placeholder:"Street"},null,512),[[p,s.user.addressInvoice.street]])]),Re])])]),e("div",Ge,[e("div",Ye,[e("div",He,[Ze,e("div",Je,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[7]||(t[7]=a=>s.user.addressInvoice.street2=a),translate:"yes",placeholder:"Street 2"},null,512),[[p,s.user.addressInvoice.street2]])])])])]),e("div",Qe,[e("div",Ke,[e("div",Xe,[es,e("div",ss,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[8]||(t[8]=a=>s.user.addressInvoice.zip=a),translate:"yes",placeholder:"ZIP"},null,512),[[p,s.user.addressInvoice.zip]])]),ts])]),e("div",rs,[e("div",as,[os,e("div",is,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[9]||(t[9]=a=>s.user.addressInvoice.city=a),translate:"yes",placeholder:"City"},null,512),[[p,s.user.addressInvoice.city]])]),ds])])]),e("div",ns,[e("div",ls,[e("div",cs,[ms,e("div",us,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[10]||(t[10]=a=>s.user.addressInvoice.state=a),translate:"yes",placeholder:"State"},null,512),[[p,s.user.addressInvoice.state]])])])]),e("div",hs,[e("div",ps,[ys,e("div",_s,[s.$store.state.coredata&&s.$store.state.coredata.countries?u((i(),d("select",{key:0,"onUpdate:modelValue":t[11]||(t[11]=a=>s.user.addressInvoice.country=a)},[(i(!0),d(g,null,P(s.$store.state.coredata.countries,a=>(i(),d("option",{value:a.code,key:a.code},c(a.name),9,vs))),128))],512)),[[N,s.user.addressInvoice.country]]):h("",!0)]),$s])])]),e("div",fs,[e("div",gs,[e("div",Ps,[bs,e("div",Ds,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[12]||(t[12]=a=>s.user.addressInvoice.phone=a),translate:"yes",placeholder:"Phone"},null,512),[[p,s.user.addressInvoice.phone]])]),Is])])]),ks,s.user.company?(i(),d("div",Cs,[e("div",Ts,[e("div",ws,[e("div",As,[Ss,e("div",Us,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[13]||(t[13]=a=>s.user.company.name=a),placeholder:"Company Name"},null,512),[[p,s.user.company.name]])])])])]),e("div",Os,[e("div",Vs,[e("div",Ns,[Ls,e("div",Es,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[14]||(t[14]=a=>s.user.company.orgId=a),placeholder:"Organisation ID"},null,512),[[p,s.user.company.orgId]])])])])]),e("div",Fs,[e("div",xs,[e("div",Ms,[qs,e("div",zs,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[15]||(t[15]=a=>s.user.company.taxId=a),placeholder:"Company Tax ID"},null,512),[[p,s.user.company.taxId]])])])]),e("div",js,[e("div",Bs,[Ws,e("div",Rs,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[16]||(t[16]=a=>s.user.company.taxVatId=a),placeholder:"Company VAT ID"},null,512),[[p,s.user.company.taxVatId]])])])])])])):h("",!0),e("button",Gs,[v(n,{icon:"check"}),Ys,Hs])],32)])}var C=I(R,[["render",Zs],["__file","/Users/marthol/Documents/GitHub/stretchshop-front-vue/src/components/orders/User.vue"]]);const Js={name:"OrderDeliveryPayment",data(){return{deliveryData:{physical:null,digital:null},paymentData:null,showDeliveryAddress:!1,deliveryAddress:{type:"delivery",nameFirst:"",nameLast:"",street:"",street2:"",zip:"",city:"",state:"",country:"",phone:""}}},computed:{},created:function(){this.$parent&&this.$parent.orderParams&&(this.$parent.orderParams.order.data&&(this.$parent.orderParams.order.data.deliveryData&&this.$parent.orderParams.order.data.deliveryData.codename&&(this.deliveryData=this.$parent.orderParams.order.data.deliveryData.codename),this.$parent.orderParams.order.data.paymentData&&this.$parent.orderParams.order.data.paymentData.codename&&(this.paymentData=this.$parent.orderParams.order.data.paymentData.codename)),this.$parent.orderParams.order.addresses&&this.$parent.orderParams.order.addresses.deliveryAddress&&(this.deliveryAddress=this.$parent.orderParams.order.addresses.deliveryAddress,this.showDeliveryAddress=!0))},mounted:function(){this.eventBus.emit("translateContent",this.$store.getters.getTranslates)},methods:{updateDeliveryPaymentData:function(){console.log("#1",!0);let s=!1;const t=this.$el.querySelector(".deliveryType .form-messages .form-message[data-message='is empty']"),r=this.$el.querySelector(".paymentType .form-messages .form-message[data-message='is empty']");if(console.log("#2",t,r),t&&t.classList.add("is-hidden"),r&&r.classList.add("is-hidden"),console.log("#3",!0),this.showDeliveryAddress){console.log("#4",this.showDeliveryAddress),this.$parent.orderParams.order.addresses||(this.$parent.orderParams.order.addresses={}),console.log("#5",this.$parent.orderParams.order.addresses),this.$parent.orderParams.order.addresses.deliveryAddress||(this.$parent.orderParams.order.addresses.deliveryAddress=[]),console.log("#6",this.$parent.orderParams.order.addresses);const m=this.$helpers.propertiesRequiredConfirm(this.deliveryAddress,["nameFirst","nameLast","street","zip","city","country","phone"],[]);console.log("#7",m),m.result?this.$parent.orderParams.order.addresses.deliveryAddress=this.deliveryAddress:(this.$helpers.formUndecorateAndDecorateFields(m.fields,m.errors),s=!0),console.log("#8",s)}else console.log("#9",s),this.$parent.orderParams.order.addresses&&this.$parent.orderParams.order.addresses.deliveryAddress&&(console.log("#10",s),this.$parent.orderParams.order.addresses.deliveryAddress=null);console.log("#11",!0),this.$parent.orderParams.order.data||(this.$parent.orderParams.order.data={},console.log("#12",this.$parent.orderParams.order.data)),console.log("#13",!0),this.deliveryData&&typeof this.deliveryData.physical!="undefined"&&typeof this.deliveryData.digital!="undefined"&&(this.deliveryData.physical!==null||this.deliveryData.digital!==null)?(console.log("#14",this.deliveryData,typeof this.deliveryData.physical!="undefined",typeof this.deliveryData.digital!="undefined",this.deliveryData.physical!==null||this.deliveryData.digital!==null),this.$parent.orderParams.order.data.deliveryData||(this.$parent.orderParams.order.data.deliveryData={codename:null},console.log("#15",this.$parent.orderParams.order.data.deliveryData)),this.$parent.orderParams.order.data.deliveryData.codename=this.deliveryData,console.log("#16",this.$parent.orderParams.order.data.deliveryData.codename)):(console.log("#17",this.deliveryData,this.deliveryData.physical,this.deliveryData.digital,this.deliveryData.physical!==null||this.deliveryData.digital!==null),s=!0,console.log("#18 - missing deliveryData"),t&&t.classList.remove("is-hidden")),console.log("#19",!0),this.paymentData&&this.paymentData!==null?(console.log("#20",this.paymentData),this.$parent.orderParams.order.data.paymentData||(this.$parent.orderParams.order.data.paymentData={codename:null},console.log("#21",this.$parent.orderParams.order.data.paymentData)),this.$parent.orderParams.order.data.paymentData.codename=this.paymentData,console.log("#22",this.$parent.orderParams.order.data.paymentData.codename)):(s=!0,console.log("#23 - missing paymentData"),r&&r.classList.remove("is-hidden")),console.log("#24",s),s||this.$parent.updateOrder()},deliveryTypeIsChecked(s,t){this.$parent.orderParams.order.data.deliveryData&&this.$parent.orderParams.order.data.deliveryData.codename[s]&&(this.$parent.orderParams.order.data.deliveryData.codename[s].value,t.codename)},checkIfDeliveryAddressExists:()=>{if(!globalThis.$parent.orderParams.order.addresses.deliveryAddress&&globalThis.$parent.orderParams.order.addresses.deliveryAddress.length>0){const s=JSON.stringify(globalThis.deliveryAddress);globalThis.$parent.orderParams.order.addresses.deliveryAddress.forEach(t=>{if(JSON.stringify(t)===s)return!0})}return!1},fillWithSelectedDeliveryAddress(s){s.target.value&&s.target.value!==""&&s.target.value>-1&&(this.deliveryAddress=this.$store.state.user.profile.addressesDelivery[s.target.value])},getPaymentPrice(s){if(s&&s.prices&&this.$store.state&&this.$store.state.cart&&this.$store.state.cart.priceTotal){for(let t=0;t<s.prices.length;t++)if(this.$store.state.cart.priceTotal>=s.prices[t].range.from&&this.$store.state.cart.priceTotal<=s.prices[t].range.to)return s.prices[t].price}return 0},setDelivery(s,t){this.deliveryData[s]=t},checkUsePaymentType(s){return!!(this.$store.state.cart&&this.$store.state.cart.cartItemTypology&&(typeof s.type=="undefined"||this.$store.state.cart.cartItemTypology.subtypes.length>1&&this.$store.state.cart.cartItemTypology.subtypes.indexOf(s.type)===-1))}}},Qs={id:"orderDeliveryPayment",class:"orderDeliveryPayment"},Ks=e("h2",{class:"title is-2",translate:"yes"},"Delivery Payment",-1),Xs=e("h3",{class:"title is-3 has-text-left",translate:"yes"},"Delivery",-1),et={key:0,class:"deliveryType optionControlList"},st={key:0},tt={class:"title is-4 has-text-left"},rt=_("\xA0"),at=e("span",{translate:"yes"},"goods",-1),ot={class:"s-input radio radio-button"},it=["name","onClick","value","checked"],dt={class:"control-label"},nt=L('<div class="form-messages"><p class="form-message has-text-danger has-text-left is-hidden" data-message="is empty"><span class="icon has-text-danger is-pulled-left"><i class="fa fa-exclamation-circle"></i></span><span translate="yes">Please select value</span></p></div>',1),lt={key:0,class:"deliveryAddressBlock"},ct={class:"columns is-variable is-2"},mt={class:"column is-12"},ut={class:"field has-text-centered"},ht={class:"s-input switch is-rounded"},pt=e("span",{class:"check"},null,-1),yt=e("span",{class:"control-label",translate:"yes"},"Use custom delivery address",-1),_t={key:0,class:"deliveryAddressWrapper is-clearfix"},vt={key:0,class:"columns is-variable is-2"},$t={class:"column is-12"},ft={class:"field for-select"},gt=e("label",{class:"label",translate:"yes"},"Previously used addresses:",-1),Pt={class:"control has-text-centered"},bt={class:"select is-empty"},Dt=e("option",{value:"",translate:"yes"},"Please select",-1),It=["value"],kt={class:"columns is-variable is-2"},Ct={class:"column is-6"},Tt={class:"field nameFirst"},wt=e("label",{class:"label",translate:"yes"},"First Name",-1),At={class:"control"},St=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),Ut={class:"column is-6"},Ot={class:"field nameLast"},Vt=e("label",{class:"label",translate:"yes"},"Last Name",-1),Nt={class:"control"},Lt=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),Et={class:"columns is-variable is-2"},Ft={class:"column is-12"},xt={class:"field street"},Mt=e("label",{class:"label",translate:"yes"},"Street",-1),qt={class:"control"},zt=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),jt={class:"columns is-variable is-2"},Bt={class:"column is-12"},Wt={class:"field"},Rt=e("label",{class:"label",translate:"yes"},"Street 2",-1),Gt={class:"control"},Yt={class:"columns is-variable is-2"},Ht={class:"column is-4"},Zt={class:"field zip"},Jt=e("label",{class:"label",translate:"yes"},"ZIP",-1),Qt={class:"control"},Kt=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),Xt={class:"column is-8"},er={class:"field city"},sr=e("label",{class:"label",translate:"yes"},"City",-1),tr={class:"control"},rr=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),ar={class:"columns is-variable is-2"},or={class:"column is-6"},ir={class:"field"},dr=e("label",{class:"label",translate:"yes"},"State",-1),nr={class:"control"},lr={class:"column is-6"},cr={class:"field country"},mr=e("label",{class:"label",translate:"yes"},"Country",-1),ur={class:"control select"},hr=["value"],pr=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),yr={class:"columns is-variable is-1 is-centered"},_r={class:"column is-6"},vr={class:"field phone"},$r=e("label",{class:"label",translate:"yes"},"Phone",-1),fr={class:"control is-clearfix"},gr=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This value cannot be empty")],-1),Pr=e("h3",{class:"title is-3 has-text-left",translate:"yes"},"Payment",-1),br={key:0,class:"paymentType optionControlList"},Dr={class:"control"},Ir={class:"s-input radio"},kr=["value"],Cr={class:"control-label"},Tr=L('<div class="form-messages"><p class="form-message has-text-danger has-text-left is-hidden" data-message="is empty"><span class="icon has-text-danger is-pulled-left"><i class="fa fa-exclamation-circle"></i></span><span translate="yes">Please select value</span></p></div>',1),wr={class:"button is-success",type:"submit"},Ar=_(" \xA0 "),Sr=e("span",{translate:"yes"},"Set delivery and payment",-1);function Ur(s,t,r,m,o,l){const y=f("font-awesome-icon");return i(),d("div",Qs,[Ks,e("form",{onSubmit:t[12]||(t[12]=U((...n)=>l.updateDeliveryPaymentData&&l.updateDeliveryPaymentData(...n),["prevent"]))},[e("div",null,[Xs,s.$store.state.order.order.settings.deliveryMethodsTypes&&Object.keys(s.$store.state.order.order.settings.deliveryMethodsTypes).length>0?(i(),d("div",et,[(i(!0),d(g,null,P(Object.keys(s.$store.state.order.order.settings.deliveryMethodsTypes),(n,a)=>(i(),d("div",{class:"control",key:a},[s.$store.state.cart&&s.$store.state.cart.cartItemTypology&&s.$store.state.cart.cartItemTypology.subtypes.indexOf(n)>-1?(i(),d("div",st,[e("h4",tt,[e("span",null,c(n),1),rt,at]),(i(!0),d(g,null,P(s.$store.state.order.order.settings.deliveryMethodsTypes[n],($,b)=>(i(),d("div",{class:"field",key:b},[e("label",ot,[e("input",{type:"radio",class:"check",name:"type-"+n,onClick:si=>l.setDelivery(n,$.codename),value:$.codename,checked:l.deliveryTypeIsChecked(n,$)},null,8,it),e("span",dt,c($.name[s.$store.state.language.code])+" ("+c($.prices[0].price)+"\xA0"+c(s.$store.state.currency.symbol)+") ",1)])]))),128))])):h("",!0)]))),128)),nt])):h("",!0)]),s.$store.state.cart&&s.$store.state.cart.cartItemTypology&&s.$store.state.cart.cartItemTypology.subtypes.indexOf("physical")>-1?(i(),d("div",lt,[e("section",null,[e("div",ct,[e("div",mt,[e("div",ut,[e("label",ht,[u(e("input",{type:"checkbox",class:"checkbox","true-value":"true",value:"false","onUpdate:modelValue":t[0]||(t[0]=n=>o.showDeliveryAddress=n)},null,512),[[q,o.showDeliveryAddress]]),pt,yt])])])])]),e("section",null,[o.showDeliveryAddress?(i(),d("div",_t,[s.$store.state.user.profile.addressesDelivery&&s.$store.state.user.profile.addressesDelivery.length>0?(i(),d("div",vt,[e("div",$t,[e("div",ft,[gt,e("div",Pt,[e("span",bt,[e("select",{class:"select",onChange:t[1]||(t[1]=(...n)=>l.fillWithSelectedDeliveryAddress&&l.fillWithSelectedDeliveryAddress(...n))},[Dt,(i(!0),d(g,null,P(s.$store.state.user.profile.addressesDelivery,(n,a)=>(i(),d("option",{key:a,value:a},c(n.street)+", "+c(n.zip),9,It))),128))],32)])])])])])):h("",!0),e("div",kt,[e("div",Ct,[e("div",Tt,[wt,e("div",At,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[2]||(t[2]=n=>o.deliveryAddress.nameFirst=n),translate:"yes",placeholder:"First Name"},null,512),[[p,o.deliveryAddress.nameFirst]])]),St])]),e("div",Ut,[e("div",Ot,[Vt,e("div",Nt,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[3]||(t[3]=n=>o.deliveryAddress.nameLast=n),translate:"yes",placeholder:"Last Name"},null,512),[[p,o.deliveryAddress.nameLast]])]),Lt])])]),e("div",Et,[e("div",Ft,[e("div",xt,[Mt,e("div",qt,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[4]||(t[4]=n=>o.deliveryAddress.street=n),translate:"yes",placeholder:"Street"},null,512),[[p,o.deliveryAddress.street]])]),zt])])]),e("div",jt,[e("div",Bt,[e("div",Wt,[Rt,e("div",Gt,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[5]||(t[5]=n=>o.deliveryAddress.street2=n),translate:"yes",placeholder:"Street 2"},null,512),[[p,o.deliveryAddress.street2]])])])])]),e("div",Yt,[e("div",Ht,[e("div",Zt,[Jt,e("div",Qt,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[6]||(t[6]=n=>o.deliveryAddress.zip=n),translate:"yes",placeholder:"ZIP"},null,512),[[p,o.deliveryAddress.zip]])]),Kt])]),e("div",Xt,[e("div",er,[sr,e("div",tr,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[7]||(t[7]=n=>o.deliveryAddress.city=n),translate:"yes",placeholder:"City"},null,512),[[p,o.deliveryAddress.city]])]),rr])])]),e("div",ar,[e("div",or,[e("div",ir,[dr,e("div",nr,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[8]||(t[8]=n=>o.deliveryAddress.state=n),translate:"yes",placeholder:"State"},null,512),[[p,o.deliveryAddress.state]])])])]),e("div",lr,[e("div",cr,[mr,e("div",ur,[s.$store.state.coredata&&s.$store.state.coredata.countries?u((i(),d("select",{key:0,"onUpdate:modelValue":t[9]||(t[9]=n=>o.deliveryAddress.country=n)},[(i(!0),d(g,null,P(s.$store.state.coredata.countries,n=>(i(),d("option",{value:n.code,key:n.code},c(n.name),9,hr))),128))],512)),[[N,o.deliveryAddress.country]]):h("",!0)]),pr])])]),e("div",yr,[e("div",_r,[e("div",vr,[$r,e("div",fr,[u(e("input",{class:"input",type:"text","onUpdate:modelValue":t[10]||(t[10]=n=>o.deliveryAddress.phone=n),translate:"yes",placeholder:"Phone"},null,512),[[p,o.deliveryAddress.phone]])]),gr])])])])):h("",!0)])])):h("",!0),e("div",null,[Pr,s.$store.state.order.order.settings.paymentMethods&&Object.keys(s.$store.state.order.order.settings.paymentMethods).length>0?(i(),d("div",br,[(i(!0),d(g,null,P(s.$store.state.order.order.settings.paymentMethods,(n,a)=>(i(),d("div",{class:"field",key:a},[e("div",Dr,[l.checkUsePaymentType(n)?(i(),d("div",{key:0,class:D("payment-"+n.codename)},[e("label",Ir,[u(e("input",{type:"radio",name:"paymentType",class:"check","onUpdate:modelValue":t[11]||(t[11]=$=>o.paymentData=$),value:n.codename},null,8,kr),[[z,o.paymentData]]),e("span",Cr,c(n.name[s.$store.state.language.code])+" ("+c(l.getPaymentPrice(n))+"\xA0"+c(s.$store.state.currency.symbol)+") ",1)])],2)):h("",!0)])]))),128)),Tr])):h("",!0)]),e("button",wr,[v(y,{icon:"check"}),Ar,Sr])],32)])}var T=I(Js,[["render",Ur],["__file","/Users/marthol/Documents/GitHub/stretchshop-front-vue/src/components/orders/DeliveryPayment.vue"]]);const Or={name:"OrderSummary",data(){return{userConfirmation:null}},computed:{deliveryData:function(){const s=this,t=[];if(this.$parent.orderParams.order&&this.$parent.orderParams.order.data.deliveryData&&this.$parent.orderParams.order.data.deliveryData.codename){const r=this.$parent.orderParams.order.data.deliveryData.codename,m=this.$parent.orderParams.order.settings.deliveryMethodsTypes;Object.keys(r).forEach(o=>{if(r&&m&&r[o]&&r[o]!==null){const l=r[o];console.log("deliveryMethod:",l),l.type=o,l.name=l.value,m[o]&&m[o].forEach(y=>{y.type&&y.codename&&y.type===o&&y.codename===l.value&&(l.name=y.name[s.$store.getters.getLanguage])}),t.push(l)}})}return t}},mounted:function(){this.eventBus.emit("translateContent",this.$store.getters.getTranslates)},methods:{submitOrder:function(){const s=this.$el.querySelector("#summary .field.confirm .check");s.classList.remove("is-danger"),s&&s.parentElement.querySelector(".control-label").classList.add("has-text-danger"),this.userConfirmation?(this.$parent.orderParams.order.dates.userConfirmation=this.userConfirmation,this.$parent.updateOrder()):(this.$helpers.formUndecorateAndDecorateFields(["confirm"],[{name:"confirm",action:"unconfirmed"}]),s.classList.remove("is-success"),s.classList.remove("is-dang"),s.classList.add("is-danger"),s&&s.parentElement.querySelector(".control-label").classList.add("has-text-danger"))},setConfirmationDate:function(s){if(s.target.checked){const t=new Date;this.userConfirmation=t.getTime()}},checkDeliveryAddress:function(){return!!(this.$parent.orderParams&&this.$parent.orderParams.order&&this.$parent.orderParams.order.addresses&&this.$parent.orderParams.order.addresses.deliveryAddress&&Object.keys(this.$parent.orderParams.order.addresses.deliveryAddress).length>0)},invoiceAddress:function(){if(this.$store.state.coredata)return this.$helpers.addressToString(this.$parent.orderParams.order.addresses.invoiceAddress,this.$store.state.coredata.countries,["type"])},deliveryAddress:function(){return this.$parent.orderParams.order.addresses.deliveryAddress?this.$helpers.addressToString(this.$parent.orderParams.order.addresses.deliveryAddress,this.$store.state.coredata.countries,["type"]):null},checkDeliveryData:function(){return!!(this.$parent.orderParams.order&&this.$parent.orderParams.order.data.deliveryData&&this.$parent.orderParams.order.data.deliveryData.codename)},checkPaymentData:function(){return!!(this.$parent.orderParams&&this.$parent.orderParams.order&&this.$parent.orderParams.order.data.paymentData)},paymentData:function(){const s=this;let t=null;return this.$parent.orderParams&&this.$parent.orderParams.order&&this.$parent.orderParams.order.data.paymentData&&(t={name:typeof this.$parent.orderParams.order.data.paymentData.name[s.$store.getters.getLanguage]!="undefined"?this.$parent.orderParams.order.data.paymentData.name[s.$store.getters.getLanguage]:this.$parent.orderParams.order.data.paymentData.codename,price:this.$parent.orderParams.order.data.paymentData.price}),t}}},Vr={id:"summary"},Nr=e("h2",{class:"title is-2",translate:"yes"},"Order summary",-1),Lr={class:"columns is-variable is-2"},Er={class:"column is-6"},Fr=e("h3",{class:"title is-5",translate:"yes"},"You are ordering to:",-1),xr={class:"summary-block with-pre-whitespace"},Mr={key:0,class:"column is-6"},qr=e("h3",{class:"title is-5",translate:"yes"},"With delivery to:",-1),zr={class:"summary-block with-pre-whitespace"},jr={key:1,class:"column is-6"},Br=e("h3",{class:"title is-5",translate:"yes"},"With delivery to:",-1),Wr=e("div",{class:"summary-block",translate:"yes"},"same as invoice address",-1),Rr=[Br,Wr],Gr={class:"columns is-variable is-2"},Yr={class:"column is-6"},Hr=e("h3",{class:"title is-5",translate:"yes"},"Your Delivery settings:",-1),Zr={key:0,class:"content summary-block"},Jr={class:"capitalize"},Qr=_(" - "),Kr={key:0,class:"column is-6"},Xr=e("h3",{class:"title is-5"},"Your Payment settings:",-1),ea={key:0,class:"content summary-block"},sa={class:"columns is-variable is-2"},ta={class:"column is-12"},ra={class:"field has-text-centered"},aa={class:"title is-5"},oa=e("span",{translate:"yes"},"Total price",-1),ia=_(": "),da={class:"columns is-variable is-2"},na={class:"column is-12"},la={class:"field confirm has-text-centered"},ca={class:"s-input is-success checkbox"},ma=e("span",null,[e("span",{class:"control-label",translate:"yes"},"I agree to the"),_(" \xA0 "),e("a",{href:"#",translate:"yes"},"terms and conditions")],-1),ua=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"unconfirmed",translate:"yes"},"Check this to enable sending order")],-1),ha={class:"button is-success",type:"submit"},pa=_(" \xA0 "),ya=e("span",{translate:"yes"},"Submit order",-1);function _a(s,t,r,m,o,l){const y=f("font-awesome-icon");return i(),d("div",Vr,[Nr,e("form",{onSubmit:t[1]||(t[1]=U((...n)=>l.submitOrder&&l.submitOrder(...n),["prevent"]))},[e("div",Lr,[e("div",Er,[Fr,e("div",xr,c(l.invoiceAddress()),1)]),l.checkDeliveryAddress()?(i(),d("div",Mr,[qr,e("div",zr,c(l.deliveryAddress()),1)])):(i(),d("div",jr,Rr))]),e("div",Gr,[e("div",Yr,[Hr,l.checkDeliveryData()?(i(),d("div",Zr,[(i(!0),d(g,null,P(l.deliveryData,(n,a)=>(i(),d("div",{key:a},[e("p",null,[e("span",Jr,c(n.type),1),Qr,e("strong",null,c(n.name),1),_(": "+c(s.$helpers.numeral(n.price).format("0.00"))+" \xA0"+c(s.$store.state.currency.symbol),1)])]))),128))])):h("",!0)]),l.checkPaymentData()?(i(),d("div",Kr,[e("div",null,[Xr,l.paymentData()?(i(),d("div",ea,[e("p",null,[e("strong",null,c(l.paymentData().name),1),_(": "+c(s.$helpers.numeral(l.paymentData().price).format("0.00"))+"\xA0"+c(s.$store.state.currency.symbol),1)])])):h("",!0)])])):h("",!0)]),e("div",sa,[e("div",ta,[e("div",ra,[e("h3",aa,[oa,ia,e("span",null,c(s.$helpers.numeral(s.$store.state.order.order.prices.priceTotal).format("0.00"))+"\xA0"+c(s.$store.state.currency.symbol),1)])])])]),e("div",da,[e("div",na,[e("div",la,[e("label",ca,[e("input",{type:"checkbox",class:"check",onClick:t[0]||(t[0]=n=>l.setConfirmationDate(n))}),ma]),ua])])]),e("button",ha,[v(y,{icon:"check"}),pa,ya])],32)])}var w=I(Or,[["render",_a],["__file","/Users/marthol/Documents/GitHub/stretchshop-front-vue/src/components/orders/Summary.vue"]]);const va={name:"OrderFinished",components:{"payment-stripe":W},data(){return{isLoading:!0,orderId:null}},created(){this.$parent.orderParams&&this.$parent.orderParams.order&&(this.orderId=this.$parent.orderParams.order._id)},mounted(){this.$parent.orderParams&&this.$parent.orderParams.order&&(this.orderId=this.$parent.orderParams.order._id,this.$parent.orderParams.order.data.paymentData.codename.indexOf("online_paypal")>-1&&this.paymentPayPalCall(),this.$parent.orderParams.order.data.paymentData.codename==="cod"&&this.clearFinishedOrder())},computed:{},methods:{isOrderPaymentCodename:function(s){return!!(this.$parent&&this.$parent.orderParams&&this.$parent.orderParams.order&&this.$parent.orderParams.order.data&&this.$parent.orderParams.order.data.paymentData&&this.$parent.orderParams.order.data.paymentData.codename&&this.$parent.orderParams.order.data.paymentData.codename===s)},getOrderId:function(){return console.log("this.orderId: ",this.orderId),this.orderId},paymentPayPalCall:function(){const s=this;s.$httpc.post("/order/payment/paypal/geturl",{orderId:s.$parent.orderParams.order._id,checkoutData:null},{timeout:1e4}).then(t=>{t&&t.data&&t.data.url&&t.data.url.trim()!==""&&(s.clearFinishedOrder(),window.location.href=t.data.url)})},clearFinishedOrder:function(){const s=this;setTimeout(function(){s.$parent.orderParams={},s.$store.dispatch("setOrder",null),s.$store.state.user&&s.$store.state.user.profile===null&&s.$store.state.user.logged===!0&&s.$store.state.user.email.toString().trim()!==""&&(s.$store.state.user.logged=!1,s.$store.state.user.superadmined=!1,s.$store.state.user.profile=null,s.$httpc.defaults.headers.common.Authorization=null,s.$cookies.remove("token"))},2e3)}}},$a=e("h1",{class:"title is-2",translate:"yes"},"Order Finished",-1),fa={class:"columns is-variable is-2"},ga={class:"column is-12"},Pa=e("span",{translate:"yes"},"Thank you for your order. ID of your order is",-1),ba=_(" \xA0 "),Da=_(", "),Ia=e("span",{translate:"yes"},"we've sent you email about it.",-1),ka={key:0},Ca=e("p",{translate:"yes"},"You are being redicted to PayPal, please wait.",-1),Ta={key:1};function wa(s,t,r,m,o,l){const y=f("router-link"),n=f("o-loading"),a=f("payment-stripe");return i(),d("div",null,[$a,e("div",fa,[e("div",ga,[e("p",null,[Pa,ba,v(y,{to:{name:"userOrderDetail",params:{id:l.getOrderId()}}},{default:S(()=>[_(c(l.getOrderId()),1)]),_:1},8,["to"]),Da,Ia]),l.isOrderPaymentCodename("online_paypal_paypal")?(i(),d("div",ka,[v(n,{"is-full-page":!1,active:o.isLoading,"onUpdate:active":t[0]||(t[0]=$=>o.isLoading=$),"can-cancel":!1},null,8,["active"]),Ca])):l.isOrderPaymentCodename("online_stripe")?(i(),d("div",Ta,[v(a,{order:s.$parent.orderParams.order},null,8,["order"])])):h("",!0)])])])}var A=I(va,[["render",wa],["__file","/Users/marthol/Documents/GitHub/stretchshop-front-vue/src/components/orders/Finished.vue"]]);const Aa={name:"OrderCart",components:{OrderUser:C,OrderDeliveryPayment:T,OrderSummary:w,OrderFinished:A},data(){return{itemAmount:{},orderStateNumber:1,orderParams:{},viewComponentId:null}},computed:{},updated:function(){document.querySelector("#header-cart-dropdown").style.display=""},created:function(){(this.orderParams==null||this.orderParams&&(!this.orderParams.order||this.orderParams.order==null)||this.orderParams.order&&(!this.orderParams.order.addresses||!this.orderParams.order.addresses.invoiceAddress))&&(console.log("updateOrder xxx",this.orderParams),this.updateOrder())},methods:{orderStateComponent(){const s=this.$store.getters.getOrder;this.orderParams=k({},s),s&&s.result&&s.result.id&&(this.orderStateNumber=parseInt(s.result.id.toString()));const t=this.viewComponentId!==null&&this.viewComponentId<=this.orderStateNumber?parseInt(this.viewComponentId):parseInt(this.orderStateNumber);return console.log("orderStateNumber & componentId",this.orderStateNumber,t),t===2?(console.log("orderStateNumber & componentId - OrderDeliveryPayment",T),T):t===3?(console.log("orderStateNumber & componentId - OrderSummary",w),w):t===4?(console.log("orderStateNumber & componentId - OrderFinished",A),A):(console.log("orderStateNumber & componentId - OrderUser",C),C)},updateOrder(){const s=this,t={timeout:15e3,needsAuth:!0};this.viewComponentId=null,this.$httpc.post("order/progress",{orderParams:this.orderParams&&typeof this.orderParams.order!="undefined"?this.orderParams.order:this.orderParams},t).then(function(r){if(console.log("##1: ",r,r.data,r.data.order,r.data&&r.data.order),r.data&&r.data.order){if(console.log("##2: ",r.data.order.user,r.data.order.user.id,r.data.order.user.id!==null),r.data.order.user&&r.data.order.user.id&&r.data.order.user.id!==null&&(s.$store.state.user.logged=!0,s.$store.state.cart.user=r.data.order.user.id,s.orderStateNumber=parseInt(r.data.result.id),console.log("##3 - before forceUpdate: ",s.$store.state.user.logged,s.$store.state.cart.user,s.orderStateNumber),s.$forceUpdate(),console.log("##3.1 - after forceUpdate")),console.log("##4: ",r.data.order.status),r.data.order.status==="saved"||r.data.order.status==="sent"){s.$store.dispatch("setCart",null);const m=document.querySelector(".userCartLink .cartItemsCount");console.log("##5: ",m),m.textContent=0,console.log("cart set to NULL"),r.data.result.id=4}console.log("##5: ",!0),s.$store.dispatch("setOrder",r.data),r.data&&r.data.result&&r.data.result.id&&r.data.result.id>1&&(s.orderStateNumber=parseInt(r.data.result.id)),console.log("##6: ",s.orderStateNumber)}}).then(function(){console.log("##7 translateContent before"),s.eventBus.emit("translateContent",s.$store.getters.getTranslates),console.log("##7.1 translateContent after")}).catch(function(r){console.log("Cart error:",r),s.$store.dispatch("setCart",null),s.orderStateNumber=0,s.$store.dispatch("setOrder",null)})},updateCartItemAmount(s){const t=this;this.$httpc.post("cart",{itemId:s,amount:parseInt(this.itemAmount[s])}).then(r=>{r.data&&t.$store.dispatch("setCart",r.data)}).catch(function(r){return console.log(r),null}).then(function(){return null})},clearCart(s){const t=this;s=typeof s!="undefined"?s:null;let r=null;s!==null&&s.toString().trim()!==""?r=this.$httpc.delete("cart?itemId="+s):r=this.$httpc.delete("cart"),r.then(m=>{console.log(m.data),m.data&&t.$store.dispatch("setCart",m.data)}).catch(function(m){return console.log(m),null}).then(function(){return null})},getClickableStateClasses(s){return s<=this.orderStateNumber?"o-steps__link o-steps__link-label-bottom o-steps__link-clickable":"o-steps__link"},getActiveStateClasses(s){console.log("getActiveClasses:",s,this.orderStateNumber,this.viewComponentId);let t="o-steps__nav-item",r="";return console.log("item-prev:",s<this.orderStateNumber,s,this.orderStateNumber),s<this.orderStateNumber&&(r=" o-steps__nav-item o-steps__nav-item-previous"),console.log("item-active:",s===this.orderStateNumber,s,this.orderStateNumber,"/",this.viewComponentId&&s===this.viewComponentId||s===this.orderStateNumber,"/",this.viewComponentId&&s===this.viewComponentId,this.viewComponentId,s,this.viewComponentId,"/",s===this.orderStateNumber),(this.viewComponentId&&s===this.viewComponentId||s===this.orderStateNumber)&&(r=" o-steps__nav-item o-steps__nav-item--success o-steps__nav-item-active"),t+=r,t},getStateClass(s){return s===this.orderStateNumber?"has-text-danger":""},setViewCoponentId:function(s,t){s<=this.orderStateNumber&&(this.$el&&this.$el.querySelectorAll("#orderCart .b-steps .step-item").forEach(m=>{m.classList.remove("is-active")}),t&&t.target&&!t.target.parentElement.parentElement.classList.contains("is-active")&&t.target.parentElement.parentElement.classList.add("is-active"),this.viewComponentId=s,this.$forceUpdate())},getProductImagePath(s){return this.$store.state.coredata&&this.$store.state.coredata.settings&&this.$store.state.coredata.settings.assets&&this.$store.state.coredata.settings.assets.url?this.$helpers.getProductImagePath(this.$store.state.coredata,s):null},countPrices(s){s=typeof s!="undefined"&&["all","items","totals"].includes(s)?s:"all";const r=this;let m=r.settings.defaultConstants.tax;if((s==="all"||s==="items")&&(this.orderParams.prices.priceItems=0,this.orderParams.prices.priceItemsNoTax=0,this.orderParams.items.forEach(function(o){if(o.taxData)r.orderParams.prices.priceItems+=o.taxData.priceWithTax*o.amount,o.tax&&o.tax!==null&&(m=o.tax),r.orderParams.prices.priceItemsNoTax+=o.taxData.priceWithoutTax*o.amount,r.orderParams.prices.priceTaxTotal+=o.taxData.tax*o.amount;else{r.orderParams.prices.priceItems+=o.price*o.amount,o.tax&&o.tax!==null&&(m=o.tax);const l=o.price/(1+m);r.orderParams.prices.priceItemsNoTax+=l;const y=o.price/(1+m);r.orderParams.prices.priceTaxTotal+=y}}),this.orderParams.prices.priceItems=this.$helpers.formatPrice(this.orderParams.prices.priceItems),this.orderParams.prices.priceItemsNoTax=this.$helpers.formatPrice(this.orderParams.prices.priceItemsNoTax),this.orderParams.prices.priceTaxTotal=this.$helpers.formatPrice(this.orderParams.prices.priceTaxTotal)),s==="all"||s==="totals"){this.orderParams.prices.priceTotal=this.orderParams.prices.priceItems+this.orderParams.prices.priceDelivery+this.orderParams.prices.pricePayment,this.orderParams.prices.priceTotal=this.formatPrice.formatPrice(this.orderParams.prices.priceTotal);const o=this.orderParams.prices.priceDelivery/(1+m),l=this.orderParams.prices.pricePayment/(1+m);this.orderParams.prices.priceTotalNoTax=this.orderParams.prices.priceItemsNoTax+o+l,this.orderParams.prices.priceTotalNoTax=this.formatPrice.formatPrice(this.orderParams.prices.priceTotalNoTax)}}}},Sa={id:"orderCart",class:"order-step-1 cart-detail"},Ua={class:"container"},Oa={key:0,class:"columns"},Va=e("div",{class:"column"},[e("h1",{class:"title is-1",translate:"yes"},"Cart")],-1),Na=[Va],La={class:"container"},Ea={key:0,class:"columns is-variable is-centered orderProgressVisual"},Fa={class:"column is-8"},xa={class:"o-steps__wrapper"},Ma={class:"o-steps o-steps--animated"},qa={class:"o-steps__marker o-steps__marker--rounded"},za=e("div",{class:"step-details"},[e("span",{class:"o-steps__title",translate:"yes"},"User")],-1),ja=e("span",{class:"o-steps__divider"},null,-1),Ba={class:"o-steps__marker o-steps__marker--rounded"},Wa=e("div",{class:"step-details"},[e("span",{class:"step-title",translate:"yes"},"Delivery & Payment")],-1),Ra=e("span",{class:"o-steps__divider"},null,-1),Ga={class:"o-steps__marker o-steps__marker--rounded"},Ya=e("div",{class:"step-details"},[e("span",{class:"step-title",translate:"yes"},"Summary")],-1),Ha={class:"container"},Za={class:"columns is-variable"},Ja={key:0,class:"column is-6 pr-6"},Qa={key:0},Ka={class:"columns is-variable"},Xa={class:"column is-12"},eo={class:"b-table"},so={class:"table-wrapper"},to={class:"table is-hoverable is-striped is-fullwidth"},ro=e("thead",null,[e("tr",null,[e("th",{class:""},[e("div",{class:"th-wrap",translate:"yes"},"Name")]),e("th",{class:""},[e("div",{class:"th-wrap is-pulled-right",translate:"yes"},"Qty")]),e("th",{class:""},[e("div",{class:"th-wrap is-pulled-right",translate:"yes"},"Price/pcs")]),e("th",{class:""})])],-1),ao=["src","alt"],oo={key:0,class:"tag is-danger"},io={key:1},no={class:"is-block"},lo={class:"cartItemAmount has-text-right"},co=["onUpdate:modelValue","onChange","run"],mo=["onUpdate:modelValue","run"],uo={class:"has-text-right"},ho={class:"has-text-right"},po=["onClick"],yo={key:0,id:"cart__products-total"},_o=e("td",null,null,-1),vo=e("td",{class:"has-text-right"},[e("strong",{translate:"yes"},"Products Total")],-1),$o={class:"has-text-right"},fo=e("td",null,null,-1),go={key:1,id:"cart__products-notax"},Po=e("td",null,null,-1),bo=e("td",{class:"has-text-right"},[e("span",{translate:"yes"},"Products Without Tax")],-1),Do={class:"has-text-right"},Io=e("td",null,null,-1),ko={key:2,id:"order__delivery"},Co=e("td",null,null,-1),To=e("td",{class:"has-text-right"},[e("strong",{translate:"yes"},"Price delivery")],-1),wo={class:"has-text-right"},Ao=e("td",null,null,-1),So={key:3,id:"order__payment"},Uo=e("td",null,null,-1),Oo=e("td",{class:"has-text-right"},[e("strong",{translate:"yes"},"Price payment")],-1),Vo={class:"has-text-right"},No=e("td",null,null,-1),Lo={key:4,id:"cart__tax"},Eo=e("td",null,null,-1),Fo=e("td",{class:"has-text-right"},[e("span",{translate:"yes"},"Tax total")],-1),xo={class:"has-text-right"},Mo=e("td",null,null,-1),qo={key:5},zo=e("td",null,null,-1),jo=e("td",{class:"has-text-right"},[e("strong",{translate:"yes"},"Total price")],-1),Bo={key:0,class:"has-text-right"},Wo={key:1,class:"has-text-right"},Ro=e("td",null,null,-1),Go={class:"columns is-variable"},Yo={class:"column is-12"},Ho=_(" \xA0 "),Zo=e("span",{translate:"yes"},"Clear Cart",-1),Jo={key:1},Qo=e("h3",{class:"title is-3"},[e("span",{translate:"yes"},"Your cart is empty")],-1),Ko=[Qo],Xo={class:"column is-6 pl-6"};function ei(s,t,r,m,o,l){const y=f("font-awesome-icon"),n=f("router-link");return i(),d("div",Sa,[e("div",Ua,[o.orderStateNumber<4?(i(),d("div",Oa,Na)):h("",!0)]),e("div",La,[o.orderStateNumber<4?(i(),d("div",Ea,[e("div",Fa,[e("div",xa,[e("nav",Ma,[e("div",{class:D(l.getActiveStateClasses(1))},[e("a",{class:D(l.getClickableStateClasses(1)),onClick:t[0]||(t[0]=a=>l.setViewCoponentId(1,a))},[e("div",qa,[v(y,{icon:"address-card"})]),za],2)],2),e("div",{class:D(l.getActiveStateClasses(2))},[ja,e("a",{class:D(l.getClickableStateClasses(2)),onClick:t[1]||(t[1]=a=>l.setViewCoponentId(2,a))},[e("div",Ba,[v(y,{icon:"truck"})]),Wa],2)],2),e("div",{class:D(l.getActiveStateClasses(3))},[Ra,e("a",{class:D(l.getClickableStateClasses(3)),onClick:t[2]||(t[2]=a=>l.setViewCoponentId(3,a))},[e("div",Ga,[v(y,{icon:"check-double"})]),Ya],2)],2)])])])])):h("",!0)]),e("div",Ha,[e("div",Za,[o.orderStateNumber<4?(i(),d("div",Ja,[s.$store.state.cart!=null&&s.$store.state.cart.items&&s.$store.state.cart.items.length>0?(i(),d("div",Qa,[e("div",Ka,[e("div",Xa,[e("div",eo,[e("div",so,[e("table",to,[ro,e("tbody",null,[(i(!0),d(g,null,P(s.$store.state.cart.items,(a,$)=>(i(),d("tr",{key:$},[e("th",null,[v(n,{to:{name:"productDetail",params:{category:a.categories[0],product:a._id,slug:a.slug}}},{default:S(()=>[e("img",{src:l.getProductImagePath(a.orderCode),alt:a.name[s.$store.state.language.code],onerror:"this.src='/assets/_site/logo-product.svg'"},null,8,ao),a.type!=="product"?(i(),d("span",oo,c(a.type),1)):h("",!0),a.type!=="product"?(i(),d("br",io)):h("",!0),e("span",no,c(a.name[s.$store.state.language.code]),1)]),_:2},1032,["to"])]),e("td",lo,[a.type!="product"||a.subtype!="digital"?u((i(),d("input",{key:0,class:"input",type:"number","onUpdate:modelValue":b=>o.itemAmount[a._id]=b,onChange:b=>l.updateCartItemAmount(a._id),run:o.itemAmount[a._id]?!0:o.itemAmount[a._id]=a.amount},null,40,co)),[[p,o.itemAmount[a._id]]]):h("",!0),a.type=="product"&&a.subtype=="digital"?u((i(),d("input",{key:1,class:"input",type:"number",disabled:"disabled","onUpdate:modelValue":b=>o.itemAmount[a._id]=b,run:o.itemAmount[a._id]?!0:o.itemAmount[a._id]=a.amount},null,8,mo)),[[p,o.itemAmount[a._id]]]):h("",!0)]),e("td",uo,[e("span",null,c(s.$helpers.numeral(a.price).format("0.00")),1),e("span",null,c(s.$store.state.currency.symbol),1)]),e("td",ho,[e("a",{onClick:b=>l.clearCart(a._id)},[v(y,{icon:"trash"})],8,po)])]))),128))]),e("tfoot",null,[s.$store.state.cart&&s.$store.state.cart.priceTotal?(i(),d("tr",yo,[_o,vo,e("td",$o,[e("strong",null,c(s.$helpers.numeral(s.$store.state.cart.priceTotal).format("0.00"))+" "+c(s.$store.state.currency.symbol),1)]),fo])):h("",!0),s.$store.state.order&&s.$store.state.order.order&&s.$store.state.order.order.prices&&s.$store.state.order.order.prices.priceItemsNoTax?(i(),d("tr",go,[Po,bo,e("td",Do,c(s.$helpers.numeral(s.$store.state.order.order.prices.priceItemsNoTax).format("0.00"))+" "+c(s.$store.state.currency.symbol),1),Io])):h("",!0),s.$store.state.order&&s.$store.state.order.order&&s.$store.state.order.order.prices&&s.$store.state.order.order.prices.priceDelivery?(i(),d("tr",ko,[Co,To,e("td",wo,[e("strong",null,c(s.$helpers.numeral(s.$store.state.order.order.prices.priceDelivery).format("0.00"))+" "+c(s.$store.state.currency.symbol),1)]),Ao])):h("",!0),s.$store.state.order&&s.$store.state.order.order&&s.$store.state.order.order.prices&&s.$store.state.order.order.prices.pricePayment?(i(),d("tr",So,[Uo,Oo,e("td",Vo,[e("strong",null,c(s.$helpers.numeral(s.$store.state.order.order.prices.pricePayment).format("0.00"))+" "+c(s.$store.state.currency.symbol),1)]),No])):h("",!0),s.$store.state.order&&s.$store.state.order.order&&s.$store.state.order.order.prices&&s.$store.state.order.order.prices.priceTaxTotal?(i(),d("tr",Lo,[Eo,Fo,e("td",xo,c(s.$helpers.numeral(s.$store.state.order.order.prices.priceTaxTotal).format("0.00"))+" "+c(s.$store.state.currency.symbol),1),Mo])):h("",!0),s.$store.state.order&&s.$store.state.order.order&&s.$store.state.order.order.prices&&s.$store.state.order.order.prices.priceTotal?(i(),d("tr",qo,[zo,jo,s.$store.state.order&&s.$store.state.order.order&&s.$store.state.order.order.prices&&s.$store.state.order.order.prices.priceTotal?(i(),d("td",Bo,[e("strong",null,c(s.$helpers.numeral(s.$store.state.order.order.prices.priceTotal).format("0.00")),1),_(" "+c(s.$store.state.currency.symbol),1)])):s.$store.state.cart&&s.$store.state.cart.priceTotal!=null?(i(),d("td",Wo,[e("strong",null,c(s.$helpers.numeral(s.$store.state.cart.priceTotal).format("0.00")),1),_(" "+c(s.$store.state.currency.symbol),1)])):h("",!0),Ro])):h("",!0)])])])])])]),e("div",Go,[e("div",Yo,[e("button",{class:"button is-danger",onClick:t[3]||(t[3]=a=>l.clearCart())},[v(y,{icon:"trash"}),Ho,Zo])])])])):(i(),d("div",Jo,Ko))])):h("",!0),e("div",Xo,[(i(),j(B(l.orderStateComponent())))])])])])}var oi=I(Aa,[["render",ei],["__file","/Users/marthol/Documents/GitHub/stretchshop-front-vue/src/components/orders/Cart.vue"]]);export{oi as default};
