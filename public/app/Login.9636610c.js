import{_ as u,u as p,o as h,c as f,a as e,w as g,b as d,v as m,d as _,e as v,f as y,g as c,r as b}from"./index.f358bf2e.js";const w={name:"UsersLogin",setup(){return{recaptcha:p()}},data(){return{email:"",password:"",remember:!1}},created:function(){},methods:{userLogin:function(){const r=this,t=this.$helpers.propertiesRequiredConfirm({email:this.email,password:this.password},["email","password"]);!t.result||this.email===""||this.password===""?this.$helpers.formUndecorateAndDecorateFields(t.fields,t.errors):this.recaptcha.recaptchaLoaded().then(()=>this.rcptch.executeRecaptcha("register")).then(i=>this.$httpc.post("helpers/recaptcha",{token:i},{timeout:3e3}).then(s=>s)).catch(function(i){if(i&&console.error("error:",i),console.log("RECAPTCHA NOT WORKING! Make sure you have RECAPTCHA variables set in backend enviroment."),confirm(`RECAPTCHA NOT WORKING
Are you sure you want to Login?

See console for more information`))return{data:!0}}).then(i=>{i&&i.data===!0&&this.$httpc.post("users/login",{user:{email:this.email,password:this.password}}).then(function(s){if(s.data.user&&s.data.user._id){r.remember,r.$store.state.user.logged=!0,r.$store.state.user.remember=r.remember;const o=s.data.user;r.$store.dispatch("setUser",o),r.$router.push({name:"me"})}}).catch(function(s){s.response&&s.response.data&&s.response.data.errors&&Object.keys(s.response.data.errors).length>0&&Object.keys(s.response.data.errors).forEach(function(o){const n=r.$el.querySelector(".field."+o);if(n){const l=n.querySelector('.form-messages .form-message[data-message="'+s.response.data.errors[o]+'"]');if(l&&l!==null){r.$helpers.undecorateFormField(n,"danger");const a=l.innerText;r.$helpers.decorateFormField(n,a,"danger")}}})}).then(function(s){})})}}},C={class:"container users-login"},k=e("div",{class:"column"},[e("h1",{class:"title is-1"},"Login")],-1),T={class:"column is-4 is-offset-4"},x={class:"field email"},A={class:"control"},L=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"wrong credentials",translate:"yes"},"Wrong credentials"),e("div",{class:"form-message","data-message":"not activated",translate:"yes"},"Account not activated. Check your mailbox for activation email."),e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This field cannot be empty")],-1),R={class:"field password"},E={class:"control"},N=e("div",{class:"form-messages is-hidden"},[e("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This field cannot be empty")],-1),P={class:"field"},U=e("span",{translate:"yes"},"Remember my login on this computer",-1),$=e("button",{class:"button is-medium is-primary",type:"submit",translate:"yes"},"Login",-1),F=e("p",null,[c(" This site is protected by reCAPTCHA and the Google"),e("br"),e("a",{href:"https://policies.google.com/privacy"},"Privacy Policy"),c(" and "),e("a",{href:"https://policies.google.com/terms"},"Terms of Service"),c(" apply. ")],-1),O={class:"column is-4 is-offset-4"},S={translate:"yes"},V=c("Forgot your password? "),H=c("Reset your password");function G(r,t,i,s,o,n){const l=b("router-link");return h(),f("div",C,[k,e("div",T,[e("form",{onSubmit:t[3]||(t[3]=g((...a)=>n.userLogin&&n.userLogin(...a),["prevent"])),ref:"loginSubmit"},[e("div",x,[e("div",A,[d(e("input",{class:"input",placeholder:"Email",type:"email","onUpdate:modelValue":t[0]||(t[0]=a=>o.email=a)},null,512),[[m,o.email,void 0,{trim:!0}]])]),L]),e("div",R,[e("div",E,[d(e("input",{class:"input",placeholder:"Password",type:"password","onUpdate:modelValue":t[1]||(t[1]=a=>o.password=a)},null,512),[[m,o.password,void 0,{trim:!0}]])]),N]),e("div",P,[U,d(e("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=a=>o.remember=a)},null,512),[[_,o.remember]])]),$,F],544)]),e("div",O,[e("p",S,[V,v(l,{to:{name:"reset"},tag:"a"},{default:y(()=>[H]),_:1})])])])}var q=u(w,[["render",G],["__file","/Users/marthol/Documents/GitHub/stretchshop-front-vue/src/components/users/Login.vue"]]);export{q as default};
