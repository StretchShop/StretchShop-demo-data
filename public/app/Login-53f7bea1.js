import{G as f}from"./GoogleRecaptcha-52ad0668.js";import{r as l,c as g,a as s,i as _,G as c,L as d,O as v,e as y,h as b,f as m,b as w,w as k,o as u}from"./sett-4d48a041.js";import{_ as x}from"./index-278cccc9.js";import"./edit-e2caae93.js";const L={name:"UsersLogin",components:{"google-recaptcha":f},data(){return{email:"",password:"",remember:!1}},created:function(){},computed:{useRecaptcha:function(){var t,e,a;return((a=(e=(t=this.$store.state)==null?void 0:t.coredata)==null?void 0:e.settings)==null?void 0:a.formVerif)==="recaptcha"}},methods:{userLogin:function(){const t=this.$helpers.propertiesRequiredConfirm({email:this.email,password:this.password},["email","password"]);!t.result||this.email===""||this.password===""?this.$helpers.formUndecorateAndDecorateFields(t.fields,t.errors):this.$helpers.secureForm("login",this.$refs.recaptcha).then(e=>{e&&this.sendRequest()})},sendRequest:function(){const t=this;this.$httpc.post("users/login",{user:{email:this.email,password:this.password}},{tokenize:!0}).then(function(e){if(e.data.user&&e.data.user._id){t.$store.state.user.logged=!0,t.$store.state.user.remember=t.remember;const a=e.data.user;t.$store.dispatch("setUser",a),t.$router.push({name:"me"})}}).catch(function(e){e.response&&e.response.data&&e.response.data.errors&&Object.keys(e.response.data.errors).length>0&&Object.keys(e.response.data.errors).forEach(function(a){const i=t.$el.querySelector(".field."+a);if(i){const o=i.querySelector('.form-messages .form-message[data-message="'+e.response.data.errors[a]+'"]');if(o&&o!==null){t.$helpers.undecorateFormField(i,"danger");const n=o.innerText;t.$helpers.decorateFormField(i,n,"danger")}}})}).then(function(e){})}}},R={class:"container users-login"},V=s("div",{class:"column"},[s("h1",{class:"title is-1"},"Login")],-1),$={class:"column is-4 is-offset-4"},C={class:"field email"},F={class:"control"},U=s("div",{class:"form-messages is-hidden"},[s("div",{class:"form-message","data-message":"wrong credentials",translate:"yes"},"Wrong credentials"),s("div",{class:"form-message","data-message":"not activated",translate:"yes"},"Account not activated. Check your mailbox for activation email."),s("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This field cannot be empty")],-1),q={class:"field password"},T={class:"control"},B=s("div",{class:"form-messages is-hidden"},[s("div",{class:"form-message","data-message":"is empty",translate:"yes"},"This field cannot be empty")],-1),E={class:"field"},G=s("span",{translate:"yes"},"Remember my login on this computer",-1),N=s("button",{class:"button is-medium is-primary",type:"submit",translate:"yes"},"Login",-1),S={class:"column is-4 is-offset-4"},D={translate:"yes"};function M(t,e,a,i,o,n){const p=l("google-recaptcha"),h=l("router-link");return u(),g("div",R,[V,s("div",$,[s("form",{onSubmit:e[3]||(e[3]=_((...r)=>n.userLogin&&n.userLogin(...r),["prevent"])),ref:"loginSubmit"},[s("div",C,[s("div",F,[c(s("input",{class:"input",placeholder:"Email",type:"email","onUpdate:modelValue":e[0]||(e[0]=r=>o.email=r)},null,512),[[d,o.email,void 0,{trim:!0}]])]),U]),s("div",q,[s("div",T,[c(s("input",{class:"input",placeholder:"Password",type:"password","onUpdate:modelValue":e[1]||(e[1]=r=>o.password=r)},null,512),[[d,o.password,void 0,{trim:!0}]])]),B]),s("div",E,[G,c(s("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=r=>o.remember=r)},null,512),[[v,o.remember]])]),N,n.useRecaptcha?(u(),y(p,{key:0,ref:"recaptcha"},null,512)):b("v-if",!0)],544)]),s("div",S,[s("p",D,[m("Forgot your password? "),w(h,{to:{name:"reset"},tag:"a"},{default:k(()=>[m("Reset your password")]),_:1})])])])}const H=x(L,[["render",M],["__file","/Users/marthol/Documents/GitHub/stretchshop-front-vue/src/components/users/Login.vue"]]);export{H as default};
