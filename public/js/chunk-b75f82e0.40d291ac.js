(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b75f82e0"],{"2a68":function(e,t,a){"use strict";a("60ed")},"2c3e":function(e,t,a){var n=a("da84"),l=a("83ab"),o=a("9f7f").MISSED_STICKY,s=a("c6b6"),c=a("9bf2").f,i=a("69f3").get,r=RegExp.prototype,d=n.TypeError;l&&o&&c(r,"sticky",{configurable:!0,get:function(){if(this!==r){if("RegExp"===s(this))return!!i(this).sticky;throw d("Incompatible receiver, RegExp required")}}})},"4d63":function(e,t,a){var n=a("83ab"),l=a("da84"),o=a("e330"),s=a("94ca"),c=a("7156"),i=a("9112"),r=a("9bf2").f,d=a("241c").f,g=a("3a9b"),u=a("44e7"),p=a("577e"),m=a("ad6d"),b=a("9f7f"),h=a("6eeb"),f=a("d039"),v=a("1a2d"),O=a("69f3").enforce,j=a("2626"),E=a("b622"),y=a("fce3"),N=a("107c"),V=E("match"),w=l.RegExp,k=w.prototype,x=l.SyntaxError,C=o(m),S=o(k.exec),$=o("".charAt),I=o("".replace),T=o("".indexOf),D=o("".slice),L=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,P=/a/g,A=/a/g,M=new w(P)!==P,B=b.MISSED_STICKY,U=b.UNSUPPORTED_Y,F=n&&(!M||B||y||N||f((function(){return A[V]=!1,w(P)!=P||w(A)==A||"/a/i"!=w(P,"i")}))),_=function(e){for(var t,a=e.length,n=0,l="",o=!1;n<=a;n++)t=$(e,n),"\\"!==t?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),l+=t):l+="[\\s\\S]":l+=t+$(e,++n);return l},R=function(e){for(var t,a=e.length,n=0,l="",o=[],s={},c=!1,i=!1,r=0,d="";n<=a;n++){if(t=$(e,n),"\\"===t)t+=$(e,++n);else if("]"===t)c=!1;else if(!c)switch(!0){case"["===t:c=!0;break;case"("===t:S(L,D(e,n+1))&&(n+=2,i=!0),l+=t,r++;continue;case">"===t&&i:if(""===d||v(s,d))throw new x("Invalid capture group name");s[d]=!0,o[o.length]=[d,r],i=!1,d="";continue}i?d+=t:l+=t}return[l,o]};if(s("RegExp",F)){for(var q=function(e,t){var a,n,l,o,s,r,d=g(k,this),m=u(e),b=void 0===t,h=[],f=e;if(!d&&m&&b&&e.constructor===q)return e;if((m||g(k,e))&&(e=e.source,b&&(t="flags"in f?f.flags:C(f))),e=void 0===e?"":p(e),t=void 0===t?"":p(t),f=e,y&&"dotAll"in P&&(n=!!t&&T(t,"s")>-1,n&&(t=I(t,/s/g,""))),a=t,B&&"sticky"in P&&(l=!!t&&T(t,"y")>-1,l&&U&&(t=I(t,/y/g,""))),N&&(o=R(e),e=o[0],h=o[1]),s=c(w(e,t),d?this:k,q),(n||l||h.length)&&(r=O(s),n&&(r.dotAll=!0,r.raw=q(_(e),a)),l&&(r.sticky=!0),h.length&&(r.groups=h)),e!==f)try{i(s,"source",""===f?"(?:)":f)}catch(v){}return s},z=function(e){e in q||r(q,e,{configurable:!0,get:function(){return w[e]},set:function(t){w[e]=t}})},H=d(w),G=0;H.length>G;)z(H[G++]);k.constructor=q,q.prototype=k,h(l,"RegExp",q)}j("RegExp")},"60ed":function(e,t,a){},7156:function(e,t,a){var n=a("1626"),l=a("861d"),o=a("d2bb");e.exports=function(e,t,a){var s,c;return o&&n(s=t.constructor)&&s!==a&&l(c=s.prototype)&&c!==a.prototype&&o(e,c),e}},c607:function(e,t,a){var n=a("da84"),l=a("83ab"),o=a("fce3"),s=a("c6b6"),c=a("9bf2").f,i=a("69f3").get,r=RegExp.prototype,d=n.TypeError;l&&o&&c(r,"dotAll",{configurable:!0,get:function(){if(this!==r){if("RegExp"===s(this))return!!i(this).dotAll;throw d("Incompatible receiver, RegExp required")}}})},df24:function(e,t,a){"use strict";a.r(t);a("b0c0");var n=a("7a23"),l=function(e){return Object(n["pushScopeId"])("data-v-11ca25d1"),e=e(),Object(n["popScopeId"])(),e},o={key:0,class:"container page-detail"},s={class:"field product-edit-language hidden"},c=l((function(){return Object(n["createElementVNode"])("label",{class:"label",translate:"yes"},"Edit Language",-1)})),i={class:"control select"},r=["value"],d={key:0,class:"page-hidden-properties"},g={class:"title is-3","aria-controls":"contentHiddenProperties"},u=l((function(){return Object(n["createElementVNode"])("span",{translate:"yes"},"Page's hidden properties",-1)})),p=Object(n["createTextVNode"])(),m={class:"editableByAuthor-hidden collapse-content",id:"contentHiddenProperties","aria-expanded":"true"},b={class:"columns"},h={class:"column is-12"},f={key:0,class:"columns"},v={class:"column is-3"},O={class:"field"},j=l((function(){return Object(n["createElementVNode"])("label",{class:"label",translate:"yes"},"Type",-1)})),E={class:"control"},y={class:"column is-3"},N={class:"field"},V=l((function(){return Object(n["createElementVNode"])("label",{class:"label",translate:"yes"},"Subtype",-1)})),w={class:"control"},k={class:"column is-3"},x={class:"field"},C=l((function(){return Object(n["createElementVNode"])("label",{class:"label",translate:"yes"},"External Id",-1)})),S={class:"control"},$={class:"columns"},I={class:"column is-12"},T={key:0,class:"columns"},D={class:"column is-3"},L={class:"field"},P=l((function(){return Object(n["createElementVNode"])("label",{class:"label",translate:"yes"},"Slug",-1)})),A={class:"control"},M={class:"column is-6"},B={class:"field"},U=l((function(){return Object(n["createElementVNode"])("label",{class:"label",translate:"yes"},"Note",-1)})),F={class:"control"},_={class:"columns"},R={class:"column is-12"},q={key:0,class:"columns"},z={class:"column is-3"},H={class:"field"},G=l((function(){return Object(n["createElementVNode"])("label",{class:"label",translate:"yes"},"Activity Start",-1)})),Y={class:"control"},J={class:"column is-3"},K={class:"field"},W=l((function(){return Object(n["createElementVNode"])("label",{class:"label",translate:"yes"},"Activity End",-1)})),X={class:"control"},Q={key:0},Z={class:"title is-3","aria-controls":"contentHiddenProperties",translate:"yes"},ee=l((function(){return Object(n["createElementVNode"])("span",{traslate:"yes"},"Editable by admin user",-1)})),te=Object(n["createTextVNode"])(),ae={class:"editableByAdmin-hidden"},ne={class:"columns"},le={class:"column is-4 is-offset-4"},oe={class:"field"},se=l((function(){return Object(n["createElementVNode"])("label",{class:"label",translate:"yes"},"Publisher",-1)})),ce={class:"control"},ie={class:"columns"},re={class:"column is-12"},de={class:"page-image-wrapper"},ge={class:"columns is-centered page-detail-cover-wrapper"},ue={class:"file is-primary action edit"},pe={class:"file-label"},me=l((function(){return Object(n["createElementVNode"])("span",{class:"file-cta"},[Object(n["createElementVNode"])("span",{class:"file-icon"},[Object(n["createElementVNode"])("i",{class:"fa fa-file-upload"})]),Object(n["createElementVNode"])("span",{class:"file-label",translate:"yes"}," Click to upload ")],-1)})),be=l((function(){return Object(n["createElementVNode"])("i",{class:"fa fa-trash"},null,-1)})),he=Object(n["createTextVNode"])("Â  "),fe=l((function(){return Object(n["createElementVNode"])("span",{translate:"yes"},"Click to remove",-1)})),ve=[be,he,fe],Oe=l((function(){return Object(n["createElementVNode"])("span",{class:"recommended-size"},"min 684 x 300 px",-1)})),je={class:"columns"},Ee=l((function(){return Object(n["createElementVNode"])("div",{class:"column is-3"},null,-1)})),ye={class:"column is-6"},Ne={class:"columns"},Ve={class:"column is-6"},we={key:0,class:"breadcrumb","aria-label":"breadcrumbs"},ke={key:0},xe={class:"is-active"},Ce={class:"column is-6"},Se={key:0,class:"data-main"},$e={class:"field"},Ie=l((function(){return Object(n["createElementVNode"])("label",{class:"label",translate:"yes"},"Name",-1)})),Te={class:"control"},De={class:"field"},Le=l((function(){return Object(n["createElementVNode"])("label",{class:"label",translate:"yes"},"Description Short",-1)})),Pe={class:"control"},Ae={class:"field"},Me=l((function(){return Object(n["createElementVNode"])("label",{class:"label",translate:"yes"},"Description Long",-1)})),Be={class:"control"},Ue=["innerHTML"],Fe={key:1,class:"columns page-delete"},_e={class:"column is-12"},Re=l((function(){return Object(n["createElementVNode"])("p",{translate:"yes"},"Warning: This action cannot be undone!",-1)}));function qe(e,t,a,l,be,he){var fe=Object(n["resolveComponent"])("font-awesome-icon"),qe=Object(n["resolveComponent"])("o-datepicker"),ze=Object(n["resolveComponent"])("o-collapse"),He=Object(n["resolveComponent"])("o-inputitems"),Ge=Object(n["resolveComponent"])("o-field"),Ye=Object(n["resolveComponent"])("router-link");return be.page?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",o,[Object(n["createElementVNode"])("div",s,[c,Object(n["createElementVNode"])("div",i,[Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return be.newLanguage=e}),onChange:t[1]||(t[1]=function(e){return he.changeEditedLang()})},[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.$store.state.coredata.langs,(function(e,t){return Object(n["openBlock"])(),Object(n["createElementBlock"])("option",{key:t+"langs",value:e},Object(n["toDisplayString"])(e.name),9,r)})),128))],544),[[n["vModelSelect"],be.newLanguage]])])]),be.editing?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",d,[Object(n["createVNode"])(ze,{open:!1,"aria-id":"contentHiddenProperties"},{trigger:Object(n["withCtx"])((function(e){return[Object(n["createElementVNode"])("h3",g,[u,p,Object(n["createVNode"])(fe,{icon:e.open?"angle-down":"angle-up"},null,8,["icon"])])]})),default:Object(n["withCtx"])((function(){return[Object(n["createElementVNode"])("div",m,[Object(n["createElementVNode"])("div",b,[Object(n["createElementVNode"])("div",h,[be.editing?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",f,[Object(n["createElementVNode"])("div",v,[Object(n["createElementVNode"])("div",O,[j,Object(n["createElementVNode"])("div",E,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:"input",type:"text","onUpdate:modelValue":t[2]||(t[2]=function(e){return be.page.data.type=e}),translate:"yes",placeholder:"Type"},null,512),[[n["vModelText"],be.page.data.type]])])])]),Object(n["createElementVNode"])("div",y,[Object(n["createElementVNode"])("div",N,[V,Object(n["createElementVNode"])("div",w,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:"input",type:"text","onUpdate:modelValue":t[3]||(t[3]=function(e){return be.page.data.subtype=e}),translate:"yes",placeholder:"Subtype"},null,512),[[n["vModelText"],be.page.data.subtype]])])])]),Object(n["createElementVNode"])("div",k,[Object(n["createElementVNode"])("div",x,[C,Object(n["createElementVNode"])("div",S,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:"input",type:"text","onUpdate:modelValue":t[4]||(t[4]=function(e){return be.page.data.externalId=e}),translate:"yes",placeholder:"External Id"},null,512),[[n["vModelText"],be.page.data.externalId]])])])])])):Object(n["createCommentVNode"])("",!0)])]),Object(n["createElementVNode"])("div",$,[Object(n["createElementVNode"])("div",I,[be.editing?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",T,[Object(n["createElementVNode"])("div",D,[Object(n["createElementVNode"])("div",L,[P,Object(n["createElementVNode"])("div",A,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:"input",type:"text","onUpdate:modelValue":t[5]||(t[5]=function(e){return be.page.data.slug=e}),translate:"yes",placeholder:"Slug"},null,512),[[n["vModelText"],be.page.data.slug]])])])]),Object(n["createElementVNode"])("div",M,[Object(n["createElementVNode"])("div",B,[U,Object(n["createElementVNode"])("div",F,[Object(n["withDirectives"])(Object(n["createElementVNode"])("textarea",{class:"textarea","onUpdate:modelValue":t[6]||(t[6]=function(e){return be.page.data.note=e}),translate:"yes",placeholder:"Note"},null,512),[[n["vModelText"],be.page.data.note]])])])])])):Object(n["createCommentVNode"])("",!0)])]),Object(n["createElementVNode"])("div",_,[Object(n["createElementVNode"])("div",R,[be.page&&be.page.data?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",q,[Object(n["createElementVNode"])("div",z,[Object(n["createElementVNode"])("div",H,[G,Object(n["createElementVNode"])("div",Y,[Object(n["createVNode"])(qe,{value:he.getActivity().start,onInput:t[7]||(t[7]=function(e){return he.setActivity("start",e)}),placeholder:"Activity Start DateTime",icon:"calendar-alt","trap-focus":""},null,8,["value"])])])]),Object(n["createElementVNode"])("div",J,[Object(n["createElementVNode"])("div",K,[W,Object(n["createElementVNode"])("div",X,[Object(n["createVNode"])(qe,{value:he.getActivity().end,onInput:t[8]||(t[8]=function(e){return he.setActivity("end",e)}),placeholder:"Activity End DateTime",icon:"calendar-alt","trap-focus":""},null,8,["value"])])])])])):Object(n["createCommentVNode"])("",!0)])])])]})),_:1}),he.user&&null!=he.user&&he.user.type&&"admin"==he.user.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Q,[Object(n["createVNode"])(ze,{open:!1,"aria-id":"contentHiddenPropertiesAdmin"},{trigger:Object(n["withCtx"])((function(e){return[Object(n["createElementVNode"])("h3",Z,[ee,te,Object(n["createVNode"])(fe,{icon:e.open?"angle-down":"angle-up"},null,8,["icon"])])]})),default:Object(n["withCtx"])((function(){return[Object(n["createElementVNode"])("div",ae,[Object(n["createElementVNode"])("div",ne,[Object(n["createElementVNode"])("div",le,[Object(n["createElementVNode"])("div",oe,[se,Object(n["createElementVNode"])("div",ce,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:"input",type:"text","onUpdate:modelValue":t[9]||(t[9]=function(e){return be.page.data.publisher=e}),translate:"yes",placeholder:"Publisher"},null,512),[[n["vModelText"],be.page.data.publisher]])])])])])])]})),_:1})])):Object(n["createCommentVNode"])("",!0)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",ie,[Object(n["createElementVNode"])("div",re,[Object(n["createElementVNode"])("div",de,[Object(n["createElementVNode"])("div",ge,[Object(n["createElementVNode"])("div",{class:"column is-6 page-detail-cover",style:Object(n["normalizeStyle"])("background-image: url("+he.getPageImagePath(be.page.data.slug)+")")},null,4)]),Object(n["createElementVNode"])("div",ue,[Object(n["createElementVNode"])("label",pe,[Object(n["createElementVNode"])("input",{class:"file-input",type:"file",name:"resume",onInput:t[10]||(t[10]=function(e){return he.pageMainImageUpload(e)})},null,32),me])]),Object(n["createElementVNode"])("a",{class:"action remove button is-danger is-outlined",onClick:t[11]||(t[11]=Object(n["withModifiers"])((function(e){return he.pageMainImageDelete()}),["prevent"]))},ve),Oe])])]),Object(n["createElementVNode"])("div",je,[Ee,Object(n["createElementVNode"])("div",ye,[Object(n["createElementVNode"])("div",Ne,[Object(n["createElementVNode"])("div",Ve,[Object(n["createElementVNode"])("section",null,[Object(n["createVNode"])(Ge,{label:"Enter categories' url slugs"},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(He,{modelValue:be.page.data.categories,"onUpdate:modelValue":t[12]||(t[12]=function(e){return be.page.data.categories=e}),data:be.filteredCategoriesSlugs,autocomplete:"","allow-new":!1,field:"user.first_name",icon:"tags",placeholder:"Categories",type:"is-info",onTyping:he.getFilteredCategories},null,8,["modelValue","data","onTyping"])]})),_:1})]),be.parentCategoryDetail?(Object(n["openBlock"])(),Object(n["createElementBlock"])("nav",we,[be.parentCategoryDetail.parentCategories?(Object(n["openBlock"])(),Object(n["createElementBlock"])("ul",ke,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(be.parentCategoryDetail.parentCategories,(function(t,a){return Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:a},[Object(n["createVNode"])(Ye,{title:t.name[e.$store.state.language.code],to:{name:"categoryList",params:{category:t.pathSlug}}},{default:Object(n["withCtx"])((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(t.name[e.$store.state.language.code]),1)]})),_:2},1032,["title","to"])])})),128)),Object(n["createElementVNode"])("li",xe,[Object(n["createVNode"])(Ye,{title:be.parentCategoryDetail.name[e.$store.state.language.code],to:{name:"categoryList",params:{category:be.parentCategoryDetail.pathSlug}},"aria-current":"page"},{default:Object(n["withCtx"])((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(be.parentCategoryDetail.name[e.$store.state.language.code]),1)]})),_:1},8,["title","to"])])])):Object(n["createCommentVNode"])("",!0)])):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("div",Ce,[Object(n["createElementVNode"])("section",null,[Object(n["createVNode"])(Ge,{label:"Enter related pages' url slugs"},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(He,{modelValue:be.page.data.pages,"onUpdate:modelValue":t[13]||(t[13]=function(e){return be.page.data.pages=e}),data:be.filteredPagesSlugs,autocomplete:"","allow-new":!0,icon:"tags",placeholder:"Pages",type:"is-info",onTyping:he.getFilteredPages},null,8,["modelValue","data","onTyping"])]})),_:1})])])]),be.page&&be.page.data&&null!=be.page.data?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Se,[Object(n["createElementVNode"])("div",$e,[Ie,Object(n["createElementVNode"])("div",Te,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:"input is-size-1 has-text-weight-semibold has-text-centered",type:"text","onUpdate:modelValue":t[14]||(t[14]=function(e){return be.page.data.name[be.language.code]=e}),onKeyup:t[15]||(t[15]=function(e){return he.checkNameDependents()}),translate:"yes",placeholder:"Name"},null,544),[[n["vModelText"],be.page.data.name[be.language.code]]])])]),Object(n["createElementVNode"])("div",De,[Le,Object(n["createElementVNode"])("div",Pe,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:"input is-size-5 has-text-weight-normal has-text-centered",type:"text","onUpdate:modelValue":t[16]||(t[16]=function(e){return be.page.data.descriptionShort[be.language.code]=e}),translate:"yes",placeholder:"Description Short"},null,512),[[n["vModelText"],be.page.data.descriptionShort[be.language.code]]])])]),Object(n["createElementVNode"])("div",Ae,[Me,Object(n["createElementVNode"])("div",Be,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:"input is-size-5 has-text-weight-normal has-text-centered",type:"text","onUpdate:modelValue":t[17]||(t[17]=function(e){return be.page.data.descriptionLong[be.language.code]=e}),translate:"yes",placeholder:"Description Long"},null,512),[[n["vModelText"],be.page.data.descriptionLong[be.language.code]]])])])])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",{class:"page-body",innerHTML:be.page.body},null,8,Ue)])]),be.page&&null!=be.page?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Fe,[Object(n["createElementVNode"])("div",_e,[Object(n["createElementVNode"])("section",null,[Object(n["createElementVNode"])("button",{class:"button is-danger",onClick:t[18]||(t[18]=function(e){return he.deletePage()}),translate:"yes"},"DELETE This Page"),Re])])])):Object(n["createCommentVNode"])("",!0)])):Object(n["createCommentVNode"])("",!0)}a("498a"),a("d3b7"),a("25f0"),a("4d63"),a("c607"),a("ac1f"),a("2c3e"),a("159b"),a("b64b"),a("5319"),a("1276");var ze=a("77b6"),He=a.n(ze),Ge=(a("2b31"),{name:"PageNewEdit",data:function(){return{page:null,pageMainImageFile:null,parentCategoryDetail:null,language:{code:"en",longCode:"en-US",name:"English"},newLanguage:null,editor:null,editing:!1,userEditAllowed:!1,filteredCategoriesSlugs:[],filteredPagesSlugs:[],modal:null,fireCounter:0,dataToGenerateFromName:{slug:!0,externalId:!0}}},created:function(){this.language=this.$store.state.language},computed:{user:function(){return this.$store.getters.getUserProfile}},beforeRouteLeave:function(e,t,a){this.editor&&this.editor.destroy(),a()},watch:{user:function(e,t){console.log("new & old",e,t),e&&null!==e&&(this.getUserEditAllowed(),this.userEditAllowed&&this.getPageDetail())}},mounted:function(){this.getUserEditAllowed(),this.userEditAllowed&&this.getPageDetail()},methods:{getUserEditAllowed:function(){if(this.language=this.$store.state.language,this.user&&null!==this.user&&this.user.type&&"admin"===this.user.type)return this.userEditAllowed=!0,void this.user.settings.language;this.userEditAllowed=!1},getPageDetail:function(){var e=this;"undefined"===typeof this.$route.params.category&&(this.$route.params.category="-"),this.$route.params&&this.$route.params.slug&&""!==this.$route.params.slug.toString().trim()&&("---new"===this.$route.params.slug.toString().trim()?setTimeout((function(){e.page=e.getEmptyPage(),e.runEditor()}),1e3):this.$httpc.get("pages/"+this.$route.params.category+"/detail/"+this.$route.params.slug+"?lang="+e.$store.state.language.code).then((function(t){t.data&&(e.page=t.data,e.page&&e.page.data&&e.page.data.name&&e.$store.state&&"undefined"!==typeof e.page.data.name[e.$store.state.language.code]&&(document.title=e.page.data.name[e.$store.state.language.code]+" - StretchShop"),console.log("page detail",t.data)),e.page&&e.page.data&&e.page.data.parentCategoryDetail&&(e.parentCategoryDetail=e.page.data.parentCategoryDetail,delete e.page.data.parentCategoryDetail)})).catch((function(e){console.log(e)})).then((function(){e.runEditor()})))},runEditor:function(){var e=this;if(this.$route.query.lang){var t=this.$store.dispatch("checkLanguage",this.$route.query.lang);t.then((function(t){console.log("language check result:",t),e.language&&e.language.code&&t&&t.code&&e.language.code!==t.code&&(e.language=t)}))}setTimeout((function(){He.a.IMAGE_UPLOADER=e.editorCTimageUploader,e.editor=He.a.EditorApp.get(),console.log("get editor"),e.editor.init("*[data-editable]","data-name"),console.log("init editor"),e.editor.start(),console.log("start editor"),e.editor.ignition().state("editing"),console.log("editor ignition state editing"),e.editing=!0,e.newLanguage=e.language,e.editor.addEventListener("saved",(function(t){console.log("editor saved",t);var a=t.detail().regions;console.log("regions",a),e.editor.busy(!0),a&&"undefined"!==typeof a.content&&(console.log("self.page: ",e.page),console.log("self.page.data: ",e.page.data),console.log("self.page.data.data: ",e.page.data.data),e.page.data.data.blocks||(e.page.data.data.blocks=[]),0===e.page.data.data.blocks.length&&e.page.data.data.blocks.push(e.$helpers.getLangsObject(e.$store.state.coredata.langCodes,"<p></p>")),console.log("self.page.data.data.blocks: ",e.page.data.data.blocks),console.log("self.page.data.data.blocks[0]: ",e.page.data.data.blocks[0]),e.page.data.data.blocks[0]&&"undefined"===typeof e.page.data.data.blocks[0][e.language.code]&&(e.page.data.data.blocks[0]=e.$helpers.getLangsObject(e.$store.state.coredata.langCodes,"<p></p>")),e.page.data.data.blocks[0][e.language.code]=a.content,console.log("page data.blocks[0]["+e.language.code+"]:",e.page.data.data.blocks[0][e.language.code])),e.savePage()}))}),1e3)},editorCTimageUploader:function(e){var t,a,n,l,o=this;e.addEventListener("imageuploader.cancelupload",(function(){a&&(a.upload.removeEventListener("progress",l),a.removeEventListener("readystatechange",n),a.abort()),e.state("empty")})),e.addEventListener("imageuploader.clear",(function(){e.clear(),t=null})),e.addEventListener("imageuploader.fileready",(function(s){var c=new FormData,i=s.detail().file;l=function(t){e.progress(t.loaded/t.total*100)},n=function(s){var c;if(4===s.target.readyState)if(a=null,l=null,n=null,200===parseInt(s.target.status)){var i=s.target.responseText.length-2,r=s.target.responseText.substr(1,i);c=JSON.parse(r),console.log("upload response:",c);var d=new Image,g=o.$store.state.coredata.settings.assets.url+"/pages/editor/"+c.files[0].path;d.onload=function(){t={size:[d.width,d.height],url:g},e.populate(t.url,t.size)},d.src=g}else He.a.FlashUI("no")},e.state("uploading"),e.progress(0),c.append("image",i),a=new XMLHttpRequest,a.withCredentials=!0,a.upload.addEventListener("progress",l),a.addEventListener("readystatechange",n),a.open("POST",o.$httpc.defaults.baseURL+"pages/upload/"+o.page.data.slug,!0),a.setRequestHeader("Accept","application/json"),a.send(c)})),e.addEventListener("imageuploader.save",(function(){e.save(t.url,t.size,{alt:"test","data-ce-max-width":t.size[0]})}))},changeEditedLang:function(){this.fireCounter++,this.editing&&this.newLanguage&&this.newLanguage.code&&1===this.fireCounter&&(window.location=window.location.origin+this.$route.path+"?lang="+this.newLanguage.code)},savePage:function(){var e=this;if(this.page&&this.page.data&&this.page.data._id&&!this.page.data.id&&(this.page.data.id=this.page.data._id,delete this.page.data._id),this.page.data.blocks){var t=new RegExp(" data-editable ","g");Object.keys(this.page.data.blocks).forEach((function(e){if(this.page.data.blocks[e].indexOf(" data-editable ")){this.$route.params.id.toString().replace("---","@").replace(t,".");this.page.data.blocks[e]=this.page.data.blocks[e].replace(t)}}))}var a={pages:[]};a.pages.push(this.page.data),console.log("pagesToPut: ",a),this.$httpc.put("pages",a,{needsAuth:!0}).then((function(t){if(t.data&&t.data.length>0){var a=t.data[0],n=e.$router.resolve({name:"pageNewEdit",params:{slug:a.slug}});window.location=n.href}})).catch((function(t){console.log("savePage error:",t),e.editor.busy(!1)}))},deletePage:function(){var e=this,t={pages:[{id:e.page._id}]};this.page&&this.page._id&&confirm("Are you sure you want to delete this page?")&&this.$httpc.delete("pages",{data:t}).then((function(e){e&&e.data&&alert("Page has been successfully removed. You will be redirected now")}))},getFilteredCategories:function(e){var t=this;return e&&""!==e.toString().trim()?this.$httpc.post("categories/find",{query:{pathSlug:{$regex:e},type:"pages"}}).then((function(e){if(e.data)return e.data})).catch((function(e){console.log(e)})).then((function(e){var a=[];if(t.page.data.categories&&e&&e.categories&&e.categories.length>0)for(var n=0;n<e.categories.length;n++)e.categories[n].pathSlug&&t.page.data.categories.indexOf(e.categories[n].pathSlug)<0&&a.push(e.categories[n].pathSlug);return t.filteredCategoriesSlugs=a,a})):(t.filteredCategoriesSlugs=[],[])},getFilteredPages:function(e){var t=this;return e&&""!==e.toString().trim()?this.$httpc.post("pages/listTemplates/"+t.page.data.slug,{query:{slug:e}}).then((function(e){if(e.data)return e.data})).catch((function(e){console.log(e)})).then((function(e){var a=[];if(t.page.data.pages&&e&&e.length>0)for(var n=0;n<e.length;n++)t.page.data.pages.indexOf(e[n])<0&&a.push(e[n]);return t.filteredPagesSlugs=a,console.log("pageSlugs:",a),a})):(t.filteredPagesSlugs=[],[])},getEmptyPage:function(){var e=this;return console.log("GEP:",e.$helpers.getLangsObject(e.$store.state.coredata.langCodes)),{body:'<div data-editable data-name="content"><p>Your content here</p></div>',data:{externalId:null,variationGroupId:null,slug:null,publisher:e.user.email,authors:null,type:"page",subtype:"default",name:e.$helpers.getLangsObject(e.$store.state.coredata.langCodes),descriptionShort:e.$helpers.getLangsObject(e.$store.state.coredata.langCodes),descriptionLong:e.$helpers.getLangsObject(e.$store.state.coredata.langCodes),properties:null,data:{blocks:[e.$helpers.getLangsObject(e.$store.state.coredata.langCodes,"<p></p>")]},categories:[],pages:[],dates:{dateCreated:null,dateUpdated:null,dateSynced:null},note:null,activity:null}}},checkNameDependents:function(){if(this.page&&this.page.data&&!this.page.data._id){var e=this.language&&this.language.code?this.language.code:null;this.newLanguage&&this.newLanguage.code&&(e=this.newLanguage.code),this.page.data.name&&this.page.data.name[e]&&""!==this.page.data.name[e].trim()&&((this.page.data.slug&&""===this.page.data.slug.trim()||this.dataToGenerateFromName.slug)&&(this.page.data.slug=this.$helpers.stringToSlug(this.page.data.name[e]),this.dataToGenerateFromName.slug=!0),(this.page.data.externalId&&""===this.page.data.externalId.trim()||this.dataToGenerateFromName.externalId)&&(this.page.data.externalId=this.$helpers.stringToSlug(this.page.data.name[e]),this.dataToGenerateFromName.externalId=!0))}},getActivity:function(){var e={start:null,end:null};return this.page&&this.page.data&&null!==this.page.data&&this.page.data.activity&&null!==this.page.data.activity&&(this.page.data.activity.start&&""!==this.page.data.activity.start.toString().trim()&&(e.start=new Date(this.page.data.activity.start)),this.page.data.activity.end&&""!==this.page.data.activity.end.toString().trim()&&(e.end=new Date(this.page.data.activity.end))),e},setActivity:function(e,t){t&&this.page&&this.page.data&&null!==this.page.data&&(this.page.data.activity||(this.page.data.activity={start:null,end:null}),this.page.data.activity[e]=t)},getPageImagePath:function(e){return e&&this.$store.state.coredata&&this.$store.state.coredata.settings&&this.$store.state.coredata.settings.assets&&this.$store.state.coredata.settings.assets.url?this.$helpers.getImagePath("pages",this.$store.state.coredata,"cover/"+e,"cover.jpg"):null},pageMainImageDelete:function(){var e=this;if(confirm("Are you sure?")){var t={timeout:15e3,needsAuth:!0},a=this.getPageImagePath(this.page.data.slug),n="";if(""!==a.trim()){var l=a.split("/");l.length>0&&(n=l[l.length-1])}console.log(e.page.data.slug,a),this.$httpc.delete("user/image/pages/"+this.page.data.slug+"/"+n,t).then((function(t){if(t&&t.data&&t.data.success){console.log("image delete response",t.data);var a=new Date;e.$el.querySelector(".page-detail-cover").style.backgroundImage="url('"+e.getPageImagePath(e.page.data.slug)+"?"+a.getTime()+"')"}}))}},pageMainImageUpload:function(e){if(this.pageMainImageFile=e.target.files,console.log("pageMainImageFile:",this.pageMainImageFile),this.pageMainImageFile){var t=this,a=new FormData;if(this.pageMainImageFile.length&&this.pageMainImageFile.length>0)for(var n=0;n<this.pageMainImageFile.length;n++){var l=this.pageMainImageFile[n];a.append("files["+n+"]",l)}else a.append("files[0]",this.pageMainImageFile);this.$httpc.post("/pages/upload/"+this.page.data.slug+"/main",a,{needsAuth:!0}).then((function(e){if(e&&e.data&&"'"===e.data.substr(0,1)&&"'"===e.data[e.data.length-1]){var a=e.data.length-2;if(e.data=e.data.substr(1,a),e.data=JSON.parse(e.data),e.data.files&&e.data.files.length>0&&e.data.files[0].path&&""!==e.data.files[0].path.trim()){var n=t.$el.querySelector(".page-detail-cover");if(n){var l=new Date;n.style.backgroundImage="url('"+t.$store.state.coredata.settings.assets.url+"/pages/cover/"+e.data.files[0].path+"?"+l.getTime()+"')"}}}}))}}}}),Ye=(a("2a68"),a("6b0d")),Je=a.n(Ye);const Ke=Je()(Ge,[["render",qe],["__scopeId","data-v-11ca25d1"]]);t["default"]=Ke}}]);
//# sourceMappingURL=chunk-b75f82e0.40d291ac.js.map