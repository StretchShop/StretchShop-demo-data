(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6305827b"],{"2fdb":function(t,e,a){"use strict";var s=a("5ca1"),r=a("d2c8"),o="includes";s(s.P+s.F*a("5147")(o),"String",{includes:function(t){return!!~r(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},3617:function(t,e,a){"use strict";a("d65b")},"3c98":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.product&&t.userEditAllowed?a("div",{staticClass:"container product-detail",attrs:{id:"product-new-edit"}},[a("div",{staticClass:"field product-edit-language hidden"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Edit Language")]),a("div",{staticClass:"control select"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.newLanguage,expression:"newLanguage"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.newLanguage=e.target.multiple?a:a[0]},function(e){return t.changeEditedLang()}]}},t._l(t.$store.state.coredata.langs,(function(e,s){return a("option",{key:s+"langs",domProps:{value:e}},[t._v(" "+t._s(e.name)+" ")])})),0)])]),t.editing?a("div",{staticClass:"product-hidden-properties"},[a("b-collapse",{attrs:{open:!1,"aria-id":"contentHiddenProperties"},scopedSlots:t._u([{key:"trigger",fn:function(e){return a("h3",{staticClass:"title is-3",attrs:{"aria-controls":"contentHiddenProperties",translate:"yes"}},[a("span",{attrs:{translate:"yes"}},[t._v("Product's hidden properties")]),t._v(" "),a("font-awesome-icon",{attrs:{icon:(e.open,"angle-up")}})],1)}}],null,!1,3080087121)},[a("div",{staticClass:"editableByAuthor-hidden collapse-content",attrs:{id:"contentHiddenProperties","aria-expanded":"true"}},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-12"},[t.editing?a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-3"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Type")]),a("div",{staticClass:"control"},[a("b-autocomplete",{attrs:{placeholder:"e.g. product","keep-first":!0,"open-on-focus":!0,data:t.productTypes,field:"product.type",clearable:!1},on:{blur:t.checkForSubscriptionData},model:{value:t.product.type,callback:function(e){t.$set(t.product,"type",e)},expression:"product.type"}})],1)])]),a("div",{staticClass:"column is-3"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Subtype")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.subtype,expression:"product.subtype"}],staticClass:"input",attrs:{type:"text",translate:"yes",placeholder:"Subtype"},domProps:{value:t.product.subtype},on:{input:function(e){e.target.composing||t.$set(t.product,"subtype",e.target.value)}}})])])]),a("div",{staticClass:"column is-3"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("External Id")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.externalId,expression:"product.externalId"}],staticClass:"input",attrs:{type:"text",translate:"yes",placeholder:"External Id"},domProps:{value:t.product.externalId},on:{input:function(e){e.target.composing||t.$set(t.product,"externalId",e.target.value)}}})])])]),a("div",{staticClass:"column is-3"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Variation Group Id")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.variationGroupId,expression:"product.variationGroupId"}],staticClass:"input",attrs:{type:"text",translate:"yes",placeholder:"Variation Group Id"},domProps:{value:t.product.variationGroupId},on:{input:function(e){e.target.composing||t.$set(t.product,"variationGroupId",e.target.value)}}})])])])]):t._e()])]),a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-12"},[t.editing?a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-3"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Slug")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.slug,expression:"product.slug"}],staticClass:"input",attrs:{type:"text",translate:"yes",placeholder:"Slug"},domProps:{value:t.product.slug},on:{input:function(e){e.target.composing||t.$set(t.product,"slug",e.target.value)}}})])])]),a("div",{staticClass:"column is-6"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Note")]),a("div",{staticClass:"control"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.product.note,expression:"product.note"}],staticClass:"textarea",attrs:{translate:"yes",placeholder:"Note"},domProps:{value:t.product.note},on:{input:function(e){e.target.composing||t.$set(t.product,"note",e.target.value)}}})])])])]):t._e()])]),a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-12"},[t.product?a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-3"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Activity Start")]),a("div",{staticClass:"control"},[a("b-datetimepicker",{attrs:{value:t.getActivity().start,placeholder:"Activity Start DateTime",icon:"calendar-alt","trap-focus":""},on:{input:function(e){return t.setActivity("start",e)}}})],1)])]),a("div",{staticClass:"column is-3"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Activity End")]),a("div",{staticClass:"control"},[a("b-datetimepicker",{attrs:{value:t.getActivity().end,placeholder:"Activity End DateTime",icon:"calendar-alt","trap-focus":""},on:{input:function(e){return t.setActivity("end",e)}}})],1)])]),a("div",{staticClass:"column is-6"},["subscription"===t.product.type&&t.product.data&&t.product.data.subscription?a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-4"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Subscription Period")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.data.subscription.period,expression:"product.data.subscription.period"}],staticClass:"input",attrs:{type:"text",translate:"yes",placeholder:"Slug"},domProps:{value:t.product.data.subscription.period},on:{input:function(e){e.target.composing||t.$set(t.product.data.subscription,"period",e.target.value)}}})])])]),a("div",{staticClass:"column is-4"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Subscription Duration")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.data.subscription.duration,expression:"product.data.subscription.duration"}],staticClass:"input",attrs:{type:"number",translate:"yes",placeholder:"Slug"},domProps:{value:t.product.data.subscription.duration},on:{input:function(e){e.target.composing||t.$set(t.product.data.subscription,"duration",e.target.value)}}})])])]),a("div",{staticClass:"column is-4"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Subscription Cycles")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.data.subscription.cycles,expression:"product.data.subscription.cycles"}],staticClass:"input",attrs:{type:"number",translate:"yes",placeholder:"Slug"},domProps:{value:t.product.data.subscription.cycles},on:{input:function(e){e.target.composing||t.$set(t.product.data.subscription,"cycles",e.target.value)}}})])])])]):t._e()])]):t._e()])])])]),t.user&&null!=t.user&&t.user.type&&"admin"==t.user.type?a("div",[a("b-collapse",{attrs:{open:!1,"aria-id":"contentHiddenPropertiesAdmin"},scopedSlots:t._u([{key:"trigger",fn:function(e){return a("h3",{staticClass:"title is-3",attrs:{"aria-controls":"contentHiddenProperties",translate:"yes"}},[a("span",{attrs:{translate:"yes"}},[t._v("Editable by admin user")]),t._v(" "),a("font-awesome-icon",{attrs:{icon:e.open?"angle-down":"angle-up"}})],1)}}],null,!1,4162815105)},[a("div",{staticClass:"editableByAdmin-hidden"},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-4 is-offset-4"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Publisher")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.publisher,expression:"product.publisher"}],staticClass:"input",attrs:{type:"text",translate:"yes",placeholder:"Publisher"},domProps:{value:t.product.publisher},on:{input:function(e){e.target.composing||t.$set(t.product,"publisher",e.target.value)}}})])])])])])])],1):t._e()],1):t._e(),a("div",{staticClass:"columns reversed"},[a("div",{staticClass:"column is-7"},[a("div",{staticClass:"product-image-wrapper"},[a("img",{staticClass:"image-main",attrs:{src:t.getProductImagePath(t.product.orderCode),alt:t.product.name[t.language.code],onerror:"this.src='/assets/_site/logo-product.svg'"}}),a("b-field",{staticClass:"file action edit"},[a("b-upload",{on:{input:function(e){return t.productMainImageUpload()}},model:{value:t.productMainImageFile,callback:function(e){t.productMainImageFile=e},expression:"productMainImageFile"}},[a("a",{staticClass:"button is-primary is-info"},[a("i",{staticClass:"fa fa-file-upload"}),t._v(" "),a("span",{attrs:{translate:"yes"}},[t._v("Click to upload")])])])],1),a("a",{staticClass:"action remove button is-danger is-outlined",on:{click:function(e){return e.preventDefault(),t.productMainImageDelete()}}},[a("i",{staticClass:"fa fa-trash"}),t._v(" "),a("span",{attrs:{translate:"yes"}},[t._v("Click to remove")])])],1)]),a("div",{staticClass:"column is-5 data-main"},[a("section",[a("b-field",{attrs:{label:"Enter categories' url slugs"}},[a("b-taginput",{attrs:{data:t.filteredCategoriesSlugs,autocomplete:"","allow-new":!1,field:"user.first_name",icon:"tags",placeholder:"Categories",type:"is-info"},on:{typing:t.getFilteredCategories},model:{value:t.product.categories,callback:function(e){t.$set(t.product,"categories",e)},expression:"product.categories"}})],1)],1),t.parentCategoryDetail?a("nav",{staticClass:"breadcrumb",attrs:{"aria-label":"breadcrumbs"}},[t.parentCategoryDetail.parentCategories?a("ul",[t._l(t.parentCategoryDetail.parentCategories,(function(e,s){return a("li",{key:s},[a("router-link",{attrs:{title:e.name[t.language.code],to:{name:"categoryList",params:{category:e.pathSlug}}}},[t._v(" "+t._s(e.name[t.language.code])+" ")])],1)})),a("li",{staticClass:"is-active"},[a("router-link",{attrs:{title:t.parentCategoryDetail.name[t.language.code],to:{name:"categoryList",params:{category:t.parentCategoryDetail.pathSlug}},"aria-current":"page"}},[t._v(" "+t._s(t.parentCategoryDetail.name[t.language.code])+" ")])],1)],2):t._e()]):t._e(),t.product&&null!=t.product?a("div",[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Name")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.name[t.language.code],expression:"product.name[language.code]"}],staticClass:"input is-size-1 has-text-weight-semibold has-text-centered",attrs:{type:"text",translate:"yes",placeholder:"Name"},domProps:{value:t.product.name[t.language.code]},on:{keyup:function(e){return t.checkNameDependents()},input:function(e){e.target.composing||t.$set(t.product.name,t.language.code,e.target.value)}}})])]),a("div",{staticClass:"content"},[a("div",{staticClass:"columns"},[t._m(0),a("div",{staticClass:"column is-6"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Order code")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.orderCode,expression:"product.orderCode"}],staticClass:"input has-text-weight-normal has-text-left",attrs:{type:"text",translate:"yes",placeholder:"Order code"},domProps:{value:t.product.orderCode},on:{input:function(e){e.target.composing||t.$set(t.product,"orderCode",e.target.value)}}})]),a("p",{staticClass:"help is-danger",attrs:{translate:"yes"}},[t._v("Changing OrderCode may disable images and other external dependecies")])])])]),a("div",{staticClass:"columns"},[t._m(1),a("div",{staticClass:"column is-6"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("In stock")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.stockAmount,expression:"product.stockAmount"}],staticClass:"input has-text-weight-normal has-text-left",attrs:{type:"text",translate:"yes",placeholder:"In stock"},domProps:{value:t.product.stockAmount},on:{input:function(e){e.target.composing||t.$set(t.product,"stockAmount",e.target.value)}}})])])])]),a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-6"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[a("span",{attrs:{translate:"yes"}},[t._v("Price")]),t._v(" "+t._s(t.$store.state.currency.symbol))]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.price,expression:"product.price"}],staticClass:"input is-size-2 has-text-weight-normal has-text-right",attrs:{type:"number",translate:"yes",placeholder:"Price"},domProps:{value:t.product.price},on:{input:function(e){e.target.composing||t.$set(t.product,"price",e.target.value)}}})])])]),a("div",{staticClass:"column is-6"},[a("button",{staticClass:"button add-to-cart is-primary",attrs:{"data-id":t.product._id,disabled:""},on:{click:function(e){return e.preventDefault(),t.addToCart(e)}}},[a("font-awesome-icon",{attrs:{icon:"cart-plus"}}),t._v(" "),a("span",{attrs:{translate:"yes"}},[t._v("Add to Cart")])],1)])]),a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-12"},[t.product.priceLevels?a("div",[a("b-collapse",{attrs:{open:!1,"aria-id":"contentIdForA11y2",animation:"slide"},model:{value:t.showPriceLevels,callback:function(e){t.showPriceLevels=e},expression:"showPriceLevels"}},[a("a",{attrs:{slot:"trigger",href:"#","aria-controls":"contentIdForA11y2"},on:{click:function(e){e.preventDefault(),t.showPriceLevels=!t.showPriceLevels}},slot:"trigger"},[a("span",{attrs:{id:"productPriceLevels"}},[t._v("Edit Price Levels")])]),t._l(t.product.priceLevels,(function(e,s){return a("div",{key:s},t._l(e,(function(e,r){return a("div",{key:r,staticClass:"columns"},[a("div",{staticClass:"column is-6"},[t._v(" "+t._s(s+"."+r)+" ")]),a("div",{staticClass:"column is-6"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.priceLevels[s][r].price,expression:"product.priceLevels[pl1][pl2].price"}],staticClass:"input has-text-weight-normal has-text-right",attrs:{type:"number",placeholder:"Price"},domProps:{value:t.product.priceLevels[s][r].price},on:{keyup:function(e){t.product.priceLevels[s][r].type="defined"},input:function(e){e.target.composing||t.$set(t.product.priceLevels[s][r],"price",e.target.value)}}})])])})),0)})),a("div",[a("button",{staticClass:"button add-to-cart",attrs:{translate:"yes"},on:{click:function(e){return e.preventDefault(),t.recalculatePriceLevels(t.product._id)}}},[t._v(" Recalculate Price Levels ")])])],2)],1):t._e()])])])]):t._e()])]),t.product&&null!=t.product?a("div",{staticClass:"columns product-descriptions reversed-desktop"},[a("div",{staticClass:"column is-5"},[a("div",{staticClass:"field"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Description Short")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.product.descriptionShort[t.language.code],expression:"product.descriptionShort[language.code]"}],staticClass:"input is-size-5 has-text-weight-normal has-text-centered",attrs:{type:"text",translate:"yes",placeholder:"Description Short"},domProps:{value:t.product.descriptionShort[t.language.code]},on:{input:function(e){e.target.composing||t.$set(t.product.descriptionShort,t.language.code,e.target.value)}}})])]),t.product.data&&t.product.data.variations?a("div",[a("section",[a("b-collapse",{staticClass:"card",attrs:{"aria-id":"contentIdForA11y3",open:!1},scopedSlots:t._u([{key:"trigger",fn:function(e){return a("div",{staticClass:"card-header",attrs:{role:"button","aria-controls":"contentIdForA11y3"}},[a("p",{staticClass:"card-header-title",attrs:{translate:"yes"}},[t._v(" Variations ")]),a("a",{staticClass:"card-header-icon"},[a("b-icon",{attrs:{icon:e.open?"angle-up":"angle-down"}})],1)])}}],null,!1,4060768951)},[a("div",{staticClass:"card-content"},t._l(t.product.data.variations,(function(e,s){return a("router-link",{key:e._id+s,staticClass:"content",attrs:{title:e.name[t.language.code],to:{name:"productDetail",params:{category:e.categories[0],product:e._id,slug:e.slug}}}},[a("figure",{staticClass:"image is-32x32"},[a("img",{attrs:{src:t.getProductImagePath(e.orderCode),alt:e.name[t.language.code]}})]),t._v(" "+t._s(e.name[t.language.code])+" ")])})),1)])],1)]):t._e()]),a("div",{staticClass:"column is-7"},[a("div",{staticClass:"productContent",attrs:{"data-editable":"","data-name":"description"},domProps:{innerHTML:t._s(t.product.descriptionLong[t.language.code])}})])]):t._e(),t.product&&null!=t.product&&t.product.properties?a("div",{staticClass:"product-properties bg-grey"},[a("div",{staticClass:"columns"},[t._m(2),a("div",{staticClass:"column is-6 has-text-right"},[a("a",{staticClass:"button is-primary is-info",on:{click:function(e){return e.preventDefault(),t.newPropertyCardModal()}}},[a("i",{staticClass:"fa fa-plus"}),t._v(" "),a("span",{attrs:{translate:"yes"}},[t._v("Add New Property")])])])]),a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-12"},[a("div",[a("table",{staticClass:"table"},t._l(t.product.properties,(function(e,s){return a("tr",{key:s,attrs:{"data-key":s}},[a("th",[a("div",{staticClass:"field property-key"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Property Key")]),a("div",{staticClass:"control"},[a("input",{staticClass:"input has-text-weight-normal has-text-left",attrs:{disabled:t.getPropertyStrings(e,s).name===s,type:"text",translate:"yes",placeholder:"Property Key","data-orig":s},domProps:{value:s},on:{keyup:function(e){return t.changePropertyValue(s,"key")}}})]),t._m(3,!0)])]),a("td",[a("div",{staticClass:"field property-name"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Property Name")]),a("div",{staticClass:"control"},[a("input",{staticClass:"input has-text-weight-normal has-text-left",attrs:{type:"text",translate:"yes",placeholder:"Property Name","data-orig":t.getPropertyStrings(e,s).name},domProps:{value:t.getPropertyStrings(e,s).name},on:{keyup:function(e){return t.changePropertyValue(s,"name")}}}),a("b-switch",{attrs:{type:"is-info",value:t.checkIfPropertyHasLang(e,"name"),translate:"yes"},on:{input:function(a){return t.changePropertyLangOption(e,s,"name")}}},[t._v("Lang")])],1),t._m(4,!0)])]),a("td",[a("div",{staticClass:"field property-value"},[a("label",{staticClass:"label",attrs:{translate:"yes"}},[t._v("Property Value")]),a("div",{staticClass:"control"},[a("input",{staticClass:"input has-text-weight-normal has-text-left",attrs:{type:"text",translate:"yes",placeholder:"Property Value","data-orig":t.getPropertyStrings(e,s).value},domProps:{value:t.getPropertyStrings(e,s).value},on:{keyup:function(e){return t.changePropertyValue(s,"value")}}}),a("b-switch",{attrs:{type:"is-info",value:t.checkIfPropertyHasLang(e,"value")},on:{input:function(a){return t.changePropertyLangOption(e,s,"value")}}},[t._v("Lang")])],1)])]),a("td",{staticClass:"has-text-centered",attrs:{width:"50"}},[a("a",{staticClass:"is-size-4 has-text-danger",attrs:{href:"#revemoProperty"},on:{click:function(e){return e.preventDefault(),t.removeProperty(s)}}},[a("font-awesome-icon",{attrs:{icon:"minus"}})],1)])])})),0)])])])]):t._e(),a("slider-carousel",{attrs:{product:t.product,editable:!0}}),t.product&&t.product.data&&t.product.data.related&&t.product.data.related.products?a("section",[a("b-field",{attrs:{label:"Enter order codes of related products"}},[a("b-taginput",{attrs:{data:t.filteredProductCodes,autocomplete:"","allow-new":!1,field:"user.first_name",icon:"tags",placeholder:"Related",type:"is-info"},on:{typing:t.getFilteredRelatedProducts},model:{value:t.product.data.related.products,callback:function(e){t.$set(t.product.data.related,"products",e)},expression:"product.data.related.products"}})],1)],1):t._e(),t.product&&null!=t.product&&t.product.data&&t.product.data.related&&t.product.data.related.productResults&&t.product.data.related.productResults.length>0&&t.$store&&t.$store.state&&t.$store.state.coredata?a("div",{staticClass:"columns product-related"},[a("div",{staticClass:"column is-12"},[a("h3",{staticClass:"title is-3 has-text-left",attrs:{translate:"yes"}},[t._v("Related")]),a("div",{staticClass:"tile is-ancestor"},t._l(t.product.data.related.productResults,(function(e,s){return a("router-link",{key:e._id+s,staticClass:"tile is-parent is-3",attrs:{title:e.descriptionShort[t.language.code],to:{name:"productDetail",params:{category:e.activeParentCategoryUrl,product:e._id,slug:e.slug}}}},[a("product-box",{attrs:{product:e}})],1)})),1)])]):t._e(),t.product&&null!=t.product?a("div",{staticClass:"columns product-delete"},[a("div",{staticClass:"column is-12"},[a("section",[a("button",{staticClass:"button is-danger",attrs:{translate:"yes"},on:{click:function(e){return t.deleteProduct()}}},[t._v("DELETE This Product")]),a("p",{attrs:{translate:"yes"}},[t._v("Warning: This action cannot be undone!")])])])]):t._e(),a("product-property",{attrs:{modal:t.modal}})],1):t._e()},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"column is-6 has-text-right"},[a("span",{attrs:{translate:"yes"}},[t._v("Order code")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"column is-6 has-text-right"},[a("span",{attrs:{translate:"yes"}},[t._v("In stock")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"column is-6"},[a("h3",{staticClass:"title is-3 has-text-left",attrs:{translate:"yes"}},[t._v("Properties")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form-messages is-hidden"},[a("div",{staticClass:"form-message",attrs:{"data-message":"exists",translate:"yes"}},[t._v("This key already exists")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form-messages is-hidden"},[a("div",{staticClass:"form-message",attrs:{"data-message":"exists",translate:"yes"}},[t._v("This key already exists")])])}],o=(a("28a5"),a("6762"),a("2fdb"),a("ac6a"),a("456d"),a("7618")),i=(a("7f7f"),a("6b54"),a("77b6")),n=a.n(i),l=(a("2b31"),a("7918")),c=a("5ac7"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.modal?a("div",{staticClass:"modal is-active"},[a("div",{staticClass:"modal-background"}),a("div",{staticClass:"animation-content"},[a("form",{attrs:{action:""}},[a("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[t._m(0),a("section",{staticClass:"modal-card-body"},[t.$store.state.coredata&&t.$store.state.coredata.langs?a("b-field",{attrs:{label:"Language"}},[a("div",{staticClass:"control select"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.propertyLang,expression:"propertyLang"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.propertyLang=e.target.multiple?a:a[0]}}},[a("option",{attrs:{disabled:"disabled",value:"",translate:"yes"}},[t._v("Select language")]),a("option",{attrs:{value:""}},[t._v("-- "),a("span",{attrs:{translate:"yes"}},[t._v("None")]),t._v(" --")]),t._l(t.$store.state.coredata.langs,(function(e){return a("option",{key:e.code,domProps:{value:e.code}},[t._v(" "+t._s(e.name)+" ")])}))],2)])]):t._e(),a("b-field",{attrs:{label:"Property key"}},[a("b-input",{attrs:{type:"text",placeholder:"Property key",required:""},model:{value:t.propertyKey,callback:function(e){t.propertyKey=e},expression:"propertyKey"}})],1),t.propertyLang?a("b-field",{attrs:{label:"Property Name"}},[a("b-input",{attrs:{type:"text",placeholder:"Property Name"},model:{value:t.propertyName,callback:function(e){t.propertyName=e},expression:"propertyName"}})],1):t._e(),a("b-field",{attrs:{label:"Property value"}},[a("b-input",{attrs:{type:"text",placeholder:"Property value",required:""},model:{value:t.propertyValue,callback:function(e){t.propertyValue=e},expression:"propertyValue"}})],1)],1),a("footer",{staticClass:"modal-card-foot"},[a("button",{staticClass:"button",attrs:{type:"button",translate:"yes"},on:{click:function(e){t.$parent.modal=!1}}},[t._v("Close")]),a("button",{staticClass:"button is-primary",attrs:{translate:"yes"},on:{click:function(e){return e.preventDefault(),t.setProperty()}}},[t._v("Add Property")])])])])])]):t._e()},u=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title",attrs:{translate:"yes"}},[t._v("New Product Property")])])}],p={props:["modal"],name:"ProductNewEditProperty",data:function(){return{propertyKey:null,propertyName:null,propertyValue:null,propertyLang:null}},mounted:function(){},methods:{setProperty:function(){console.log(this.$parent.setProperty(this.propertyKey,this.propertyValue,this.propertyLang,this.propertyName))}}},g=p,h=a("2877"),v=Object(h["a"])(g,d,u,!1,null,null,null),m=v.exports,y={name:"ProductNewEdit",data:function(){return{product:null,productMainImageFile:null,productPropertyLangSwitches:{},parentCategoryDetail:null,language:{code:"en",longCode:"en-US",name:"English"},newLanguage:null,variationModel:null,editor:null,editing:!1,userEditAllowed:!1,filteredCategoriesSlugs:[],filteredProductCodes:[],renderComponent:!0,modal:null,fireCounter:0,showPriceLevels:!1,dataToGenerateFromName:{slug:!0,externalId:!0},productTypes:["product","subscription"]}},components:{"slider-carousel":l["a"],"product-box":c["a"],"product-property":m},created:function(){this.language=this.$store.state.language},computed:{user:function(){return this.$store.getters.getUserProfile}},beforeRouteLeave:function(t,e,a){this.editor&&this.editor.destroy(),a()},watch:{user:function(t,e){console.log("new & old",t,e),t&&null!=t&&(this.getUserEditAllowed(),this.userEditAllowed&&this.getProductDetail())}},mounted:function(){this.getUserEditAllowed(),console.log("mounted this.userEditAllowed",this.userEditAllowed),this.userEditAllowed&&this.getProductDetail()},methods:{getUserEditAllowed:function(){if(this.language=this.$store.state.language,this.user&&null!=this.user&&this.user.type&&"admin"==this.user.type)return this.userEditAllowed=!0,void(this.user.settings.language&&(this.language=this.$store.state.language));this.userEditAllowed=!1},getProductDetail:function(){var t=this;this.$route.params&&this.$route.params.category&&""!=this.$route.params.category.toString().trim()&&this.$route.params.product&&""!=this.$route.params.product.toString().trim()&&("---new"==this.$route.params.product.toString().trim()&&"---new"==this.$route.params.slug.toString().trim()?setTimeout((function(){t.product=t.getEmptyProduct(),t.runEditor()}),1e3):this.$httpc.get("products/"+this.$route.params.category+"/detail/"+this.$route.params.product+"?edit=true").then((function(e){if(e.data){if(t.product=e.data,t.product.name&&t.$store.state&&void 0!==Object(o["a"])(t.product.name[t.language.code])&&(document.title=t.product.name[t.language.code]+" - StretchShop"),t.product&&t.product.categories&&(t.filteredCategoriesSlugs=t.product.categories),t.product&&t.product.properties){var a=Object.keys(t.product.properties);if(a&&a.length>0)for(var s=0;s<a.length;s++){var r=a[s];t.productPropertyLangSwitches[r]={name:t.checkIfPropertyHasLang(t.product.properties[r],"name"),value:t.checkIfPropertyHasLang(t.product.properties[r],"value")}}}t.runEditor()}e.data.products&&(t.products=e.data.products),e.data.parentCategoryDetail&&(t.parentCategoryDetail=e.data.parentCategoryDetail)})).catch((function(t){console.log(t)})).then((function(){})))},getProductImagePath:function(t){return t&&this.$store.state.coredata&&this.$store.state.coredata.settings&&this.$store.state.coredata.settings.assets&&this.$store.state.coredata.settings.assets.url?this.$helpers.getProductImagePath(this.$store.state.coredata,t):null},getProductGalleryImagePath:function(t,e){return t&&this.$store.state.coredata&&this.$store.state.coredata.settings&&this.$store.state.coredata.settings.assets&&this.$store.state.coredata.settings.assets.url?this.$helpers.getProductImagePath(this.$store.state.coredata,t,e):null},newPropertyCardModal:function(){this.modal=!0},checkIfPropertyHasLang:function(t,e){var a=this;if(t&&t[e]&&this.$store&&this.$store.state&&this.$store.state.coredata&&this.$store.state.coredata.langCodes){var s=Object.keys(t[e]),r=s.filter((function(t){return a.$store.state.coredata.langCodes.includes(t)}));if(r&&r.length>0)return!0}return!1},changePropertyLangOption:function(t,e,a){console.log("value query:",".product-properties .table data-key["+e+"] .field.property-"+a+" input[text]");var s=this.$el.querySelector('.product-properties .table [data-key="'+e+'"] .field.property-'+a+" input[type=text]").value,r=this.productPropertyLangSwitches[e],o="remove";0==r[a]&&(o="add");var i=this.product.properties[e];if(console.log("changePropertyLangOption params and value:",t,e,a,s,o),a&&"name"==a){if("remove"==o)1==r.name&&1==r.value?(delete i.name,delete this.product.properties[e],this.product.properties[s]=i):1==r.name&&0==r.value&&(delete this.product.properties[e],this.product.properties[s]=i.value);else if("add"==o){this.product.properties[e].constructor!=Object&&(this.product.properties[e]={value:this.product.properties[e]}),this.product.properties[e][a]={};for(var n=0;n<this.$store.state.coredata.langCodes.length;n++)this.product.properties[e][a][this.$store.state.coredata.langCodes[n]]=null;this.product.properties[e][a][this.language.code]=s}}else if(a&&"value"==a)if("remove"==o)1==r.name?this.product.properties[e]["value"]=s:0==r.name&&(this.product.properties[e]=s);else if("add"==o){this.product.properties[e].constructor===Object?(delete i.value,this.product.properties[e]=i):(this.product.properties[e]={},this.product.properties[e][a]={});for(var l=0;l<this.$store.state.coredata.langCodes.length;l++)this.product.properties[e][a][this.$store.state.coredata.langCodes[l]]=null;i.value&&i.value.constructor===Array?this.product.properties[e][a][this.language.code]=i.value:i&&i.constructor===Array?this.product.properties[e][a][this.language.code]=i:this.product.properties[e][a][this.language.code]=s}this.productPropertyLangSwitches[e]&&(console.log("this.productPropertyLangSwitches[key][type]:",this.productPropertyLangSwitches[e][a]),this.productPropertyLangSwitches[e][a]=!this.productPropertyLangSwitches[e][a])},changePropertyValue:function(t,e){var a=this.$el.querySelector('.product-properties .table [data-key="'+t+'"] .field.property-'+e+" input[type=text]").value,s=this.productPropertyLangSwitches[t];if(console.log("incoming type & nameLangOptions",e,s),"key"==e)"undefined"!==typeof this.product.properties[a]?this.$helpers.formUndecorateAndDecorateFields(["property-key"],[{name:"property-key",action:"exists"}]):this.renamePropertyKey(t,a);else if(s&&"undefined"!==typeof s[e])if("name"==e)if(1==s[e])console.log("change for lang version of "+e+"."+this.language.code+":",a),this.product.properties[t][e][this.language.code]=a;else if(console.log("change for key:value version of "+e+":",a),"undefined"!==typeof this.product.properties[a])this.$helpers.formUndecorateAndDecorateFields(["property-name"],[{name:"property-name",action:"exists"}]);else{var r=document.querySelector(".field.property-name");this.$helpers.undecorateFormField(r,"exists"),this.renamePropertyKey(t,a)}else"value"==e&&(1==s[e]?(console.log("change for lang version of "+e+" - this.product.properties["+t+"]["+e+"]["+this.language.code+"]:",a),this.product.properties[t][e][this.language.code]=a):(console.log("change for key:value version of "+e+":",a),"undefined"!==typeof this.product.properties[t]["value"]?this.product.properties[t]["value"]=a:this.product.properties[t]=a))},renamePropertyKey:function(t,e){var a=this.product.properties[t],s=this.productPropertyLangSwitches[t];delete this.product.properties[t],delete this.productPropertyLangSwitches[t],this.product.properties[e]=a,this.productPropertyLangSwitches[e]=s;var r=this.$el.querySelector('.product-properties .table [data-key="'+t+'"]');r&&r.setAttribute("data-key",e),this.$forceUpdate()},getPropertyStrings:function(t,e){if(t.constructor===Array)return{name:e,value:t.join(", ")};if(t.constructor===Object){if("undefined"!==typeof t["name"]&&"undefined"!==typeof t["value"]&&this.$store&&this.$store.state&&this.$store.state.language){var a=this.getPropertyNameResult(t,e),s=this.getPropertyValueResult(t,e);if(""!==a&&""!==s)return{name:a,value:s}}else if("undefined"!==typeof t["value"]&&this.$store&&this.$store.state&&this.$store.state.language){var r=e,o=this.getPropertyValueResult(t);if(""!==r&&""!==o)return{name:r,value:o}}return{name:e,value:t}}return{name:e,value:t}},getPropertyNameResult:function(t,e){return"undefined"!==typeof t["name"][this.$store.state.language.code]?t["name"][this.$store.state.language.code]:e["name"]},getPropertyValueResult:function(t){return"undefined"!==typeof t["value"][this.$store.state.language.code]?t["value"][this.$store.state.language.code].constructor===Array?t["value"][this.$store.state.language.code].join(", "):t["value"][this.$store.state.language.code]:t["value"]},getFilteredCategories:function(t){var e=this;return t&&""!=t.toString().trim()?this.$httpc.post("categories/find",{query:{pathSlug:{$regex:t},type:"products"}}).then((function(t){if(t.data)return t.data})).catch((function(t){console.log(t)})).then((function(t){var a=[];if(t&&t.categories)for(var s=0;s<t.categories.length;s++)e.product.categories.indexOf(t.categories[s].pathSlug)<0&&a.push(t.categories[s].pathSlug);return e.filteredCategoriesSlugs=a,a})):(e.filteredCategoriesSlugs=[],[])},getFilteredRelatedProducts:function(t){var e=this;return t&&""!=t.toString().trim()?this.$httpc.post("products/find",{query:{orderCode:{$regex:t}}}).then((function(t){if(t.data)return t.data})).catch((function(t){console.log(t)})).then((function(t){for(var a=[],s=0;s<t.length;s++)e.product.data.related.products.indexOf(t[s].orderCode)<0&&a.push(t[s].orderCode);return e.filteredProductCodes=a,a})):(e.filteredProductCodes=[],[])},setProperty:function(t,e,a,s){if(console.log("add("+t+","+e+") in lang:"+a+" with Name:"+s),"undefined"!==typeof t&&"undefined"!==typeof e&&t&&e)if(this.product&&this.product.properties&&"undefined"!==typeof this.product.properties[t]){var r=this.product.properties[t];"undefined"!==typeof s&&s!==t&&(r["name"]={},"undefined"!==typeof a?r.name[a]=s:r.name=s)}else{var o={};"undefined"!==typeof s&&s&&(o["name"]={},"undefined"!==typeof a&&a?o.name[a]=s:o.name=s),"undefined"!==typeof a&&a?(o["value"]={},o.value[a]=e):"undefined"!==typeof o["name"]?o.value=e:o=e,o&&(this.product.properties[t]=o)}this.modal=!1},removeProperty:function(t){console.log("remove("+t+")"),this.product&&this.product.properties&&"undefined"!==typeof this.product.properties[t]&&(delete this.product.properties[t],this.$forceUpdate())},runEditor:function(){var t=this;if(this.$route.query.lang){var e=this.$store.dispatch("checkLanguage",this.$route.query.lang);e.then((function(e){console.log("language check result:",e),t.language&&t.language.code&&e&&e.code&&t.language.code!=e.code&&(t.language=e)}))}setTimeout((function(){t.editor=n.a.EditorApp.get(),console.log("get editor"),t.editor.init("*[data-editable]","data-name"),console.log("init editor"),t.editor.start(),console.log("start editor"),t.editor.ignition().state("editing"),console.log("editor ignition state editing"),t.editing=!0,t.newLanguage=t.language,t.editor.addEventListener("saved",(function(e){console.log("editor saved",e);var a=e.detail().regions;console.log("regions",a),t.editor.busy(!0),a&&"undefined"!==typeof a["description"]&&(t.product.descriptionLong[t.language.code]=a["description"],console.log("product descriptionLong:",t.product.descriptionLong[t.language.code])),t.saveProduct()}))}),1e3)},productMainImageDelete:function(){var t=this;if(confirm("Are you sure?")){var e={timeout:15e3,needsAuth:!0},a=this.getProductImagePath(this.product.orderCode),s="";if(""!=a.trim()){var r=a.split("/");r.length>0&&(s=r[r.length-1])}console.log(this.product.orderCode,a),this.$httpc.delete("user/image/products/"+this.product.orderCode+"/"+s,e).then((function(e){e&&e.data&&e.data.success&&(console.log("image delete response",e.data),t.$el.querySelector(".product-image-wrapper img.image-main").setAttribute("src",t.getProductImagePath(t.product.orderCode)))}))}},productMainImageUpload:function(){if(console.log("productMainImageFile:",this.productMainImageFile),this.productMainImageFile){var t=this,e=new FormData;if(this.productMainImageFile.length&&this.productMainImageFile.length>0)for(var a=0;a<this.productMainImageFile.length;a++){var s=this.productMainImageFile[a];e.append("files["+a+"]",s)}else e.append("files[0]",this.productMainImageFile);this.$httpc.post("/products/upload/"+this.product.orderCode+"/main",e,{needsAuth:!0}).then((function(e){if(e&&e.data&&"'"==e.data.substr(0,1)&&"'"==e.data[e.data.length-1]){var a=e.data.length-2;if(e.data=e.data.substr(1,a),e.data=JSON.parse(e.data),e.data.files&&e.data.files.length>0&&e.data.files[0].path&&""!=e.data.files[0].path.trim()){var s=t.$el.querySelector(".product-image-wrapper img.image-main");s&&s.setAttribute("src",t.$store.state.coredata.settings.assets.url+"/products/"+e.data.files[0].path)}}}))}},changeEditedLang:function(){this.fireCounter++,this.editing&&this.newLanguage&&this.newLanguage.code&&1==this.fireCounter&&(window.location=window.location.origin+this.$route.path+"?lang="+this.newLanguage.code)},saveProduct:function(){var t=this;if(this.product&&this.product._id&&!this.product.id&&(this.product.id=this.product._id),this.product.price&&this.product.stockAmount&&(this.product.price=parseFloat(this.product.price),this.product.stockAmount=parseFloat(this.product.stockAmount)),this.product.priceLevels){var e=Object.keys(this.product.priceLevels);e.length>0&&e.forEach((function(e){var a=Object.keys(t.product.priceLevels[e]);a.length>0&&a.forEach((function(a){t.product.priceLevels[e][a].price=parseFloat(t.product.priceLevels[e][a].price)}))}))}var a={products:[]};a.products.push(this.product),this.$httpc.put("products",a,{needsAuth:!0}).then((function(e){if(e.data&&e.data.length>0){var a=e.data[0],s=t.$router.resolve({name:"productNewEdit",params:{category:a.categories[0],slug:a.slug,product:a._id}});window.location=s.href}})).catch((function(t){console.log("saveProduct error:",t)}))},deleteProduct:function(){var t=this,e={products:[{id:t.product._id}]};this.product&&this.product._id&&confirm("Are you sure you want to delete this product?")&&this.$httpc.delete("products",{data:e}).then((function(t){t&&t.data&&alert("Product has been successfully removed. You will be redirected now")}))},getEmptyProduct:function(){var t=this;return{externalId:null,orderCode:null,variationGroupId:null,publisher:t.user.email,type:"product",subtype:null,name:t.$helpers.getLangsObject(t.$store.state.coredata.langCodes),descriptionShort:t.$helpers.getLangsObject(t.$store.state.coredata.langCodes),descriptionLong:t.$helpers.getLangsObject(t.$store.state.coredata.langCodes),price:0,tax:null,stockAmount:0,slug:null,properties:{},categories:[],dates:{dateCreated:null,dateUpdated:null,dateSynced:null},data:{related:{products:[],productResults:[]},gallery:{name:t.$helpers.getLangsObject(t.$store.state.coredata.langCodes),images:[]}},note:null,parentCategoryDetail:{},activity:{start:null,end:null}}},checkNameDependents:function(){if(this.product&&!this.product._id){var t=this.language&&this.language.code?this.language.code:null;this.newLanguage&&this.newLanguage.code&&(t=this.newLanguage.code),this.product.name&&this.product.name[t]&&""!=this.product.name[t].trim()&&((this.product.slug&&""==this.product.slug.trim()||this.dataToGenerateFromName.slug)&&(this.product.slug=this.$helpers.stringToSlug(this.product.name[t]),this.dataToGenerateFromName.slug=!0),(this.product.externalId&&""==this.product.externalId.trim()||this.dataToGenerateFromName.externalId)&&(this.product.externalId=this.$helpers.stringToSlug(this.product.name[t]),this.dataToGenerateFromName.externalId=!0))}},getActivity:function(){var t={start:null,end:null};return this.product&&null!=this.product&&this.product.activity&&null!=this.product.activity&&(this.product.activity.start&&""!=this.product.activity.start.toString().trim()&&(t.start=new Date(this.product.activity.start)),this.product.activity.end&&""!=this.product.activity.end.toString().trim()&&(t.end=new Date(this.product.activity.end))),t},setActivity:function(t,e){e&&this.product&&null!=this.product&&(this.product.activity||(this.product.activity={start:null,end:null}),this.product.activity[t]=e)},recalculatePriceLevels:function(t){var e=this;this.$httpc.get("products/rebuildpl/"+t).then((function(t){t&&t.data&&null!=t.data&&t.data.levels&&(e.product.priceLevels=t.data.levels)}))},checkForSubscriptionData:function(){this.product&&this.product.type&&"subscription"===this.product.type&&(this.product.data||(this.product["data"]={}),this.product.data.subscription||(this.product.data.subscription={period:"month",duration:1,cycles:0}))}}},f=y,C=(a("3617"),Object(h["a"])(f,s,r,!1,null,"4d2beecb",null));e["default"]=C.exports},5147:function(t,e,a){var s=a("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[s]=!1,!"/./"[t](e)}catch(r){}}return!0}},6762:function(t,e,a){"use strict";var s=a("5ca1"),r=a("c366")(!0);s(s.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")("includes")},d2c8:function(t,e,a){var s=a("aae3"),r=a("be13");t.exports=function(t,e,a){if(s(e))throw TypeError("String#"+a+" doesn't accept regex!");return String(r(t))}},d65b:function(t,e,a){}}]);