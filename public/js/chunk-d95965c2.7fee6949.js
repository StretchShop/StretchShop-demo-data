(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d95965c2"],{"0d41":function(t,e,s){"use strict";var a=s("dbb1"),r=s.n(a);r.a},"836a":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"userOrderDetail"}},[t.order?s("div",[s("div",{staticClass:"container"},[s("div",{staticClass:"columns is-variable is-centered"},[s("div",{staticClass:"column is-8"},[s("nav",{staticClass:"breadcrumb",attrs:{"aria-label":"breadcrumbs"}},[s("ul",[s("li",[s("router-link",{attrs:{to:{name:"userOrders"}}},[s("span",{attrs:{translate:"yes"}},[t._v("Orders")])])],1),s("li",{staticClass:"is-active"},[s("a",{attrs:{"aria-current":"page"}},[s("span",{staticClass:"order-word",attrs:{translate:"yes"}},[t._v("Order")]),t._v(" "),s("span",{staticClass:"order-title"},[t._v("#"),s("strong",[t._v(t._s(t.splitTitle(t.order._id)[0]))]),t._v(t._s(t.splitTitle(t.order._id)[1]))])])])])])])])]),s("h2",{staticClass:"title is-2"},[s("span",{attrs:{translate:"yes"}},[t._v("Order")]),s("span",{staticClass:"order-title"},[t._v(" #"),s("strong",[t._v(t._s(t.splitTitle(t.order._id)[0]))]),t._v(t._s(t.splitTitle(t.order._id)[1])+" ")])]),s("div",{staticClass:"container"},[t.order.dates?s("div",{staticClass:"columns is-variable is-centered orderProgressVisual"},[s("div",{staticClass:"column is-8"},[s("div",{staticClass:"b-steps"},[s("nav",{staticClass:"steps is-rounded"},[s("ul",{staticClass:"step-items"},[s("li",{class:t.order.dates.dateCreated?"step-item is-previous":"step-item"},[s("a",{staticClass:"step-link"},[s("div",{staticClass:"step-marker"}),s("div",{staticClass:"step-details"},[s("span",{staticClass:"step-title"},[s("span",{attrs:{translate:"yes"}},[t._v("Created")]),s("span",{staticClass:"step-date"},[t._v(t._s(t.order.dates.dateCreated))])])])])]),s("li",{class:t.order.dates.datePaid?"step-item is-previous":"step-item"},[s("a",{staticClass:"step-link"},[s("div",{staticClass:"step-marker"}),s("div",{staticClass:"step-details"},[s("span",{staticClass:"step-title"},[s("span",{attrs:{translate:"yes"}},[t._v("Paid")]),s("span",{staticClass:"step-date"},[t._v(t._s(t.order.dates.datePaid))])])])])]),s("li",{class:t.order.dates.dateExpeded?"step-item is-previous":"step-item"},[s("a",{staticClass:"step-link"},[s("div",{staticClass:"step-marker"}),s("div",{staticClass:"step-details"},[s("span",{staticClass:"step-title"},[s("span",{attrs:{translate:"yes"}},[t._v("Expeded")]),s("span",{staticClass:"step-date"},[t._v(t._s(t.order.dates.dateExpeded))])])])])])])])])])]):t._e()]),s("div",{staticClass:"container order-detail-data"},[s("div",{staticClass:"columns is-variable"},[s("div",{staticClass:"column is-12"},[s("span",{attrs:{translate:"yes"}},[t._v("Your available actions")]),t._v(": "),t.isOrderPaymentCodename("online_paypal_paypal")?s("div",[t.order.dates&&!t.order.dates.datePaid?s("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.makePayment()}}},[s("span",{attrs:{translate:"yes"}},[t._v("Pay order")])]):t._e()]):s("div",{attrs:{translate:"yes",id:"order-detail--available-action--none"}},[t._v(" none ")])])])]),s("div",{staticClass:"container order-detail-data"},[s("div",{staticClass:"columns is-variable"},[s("div",{staticClass:"column is-6"},[null!=t.order.items&&t.order.items&&t.order.items.length>0?s("div",[s("div",{staticClass:"columns is-variable"},[s("div",{staticClass:"column is-12"},[s("div",{staticClass:"b-table"},[s("div",{staticClass:"table-wrapper"},[s("table",{staticClass:"table is-hoverable is-striped is-fullwidth"},[t._m(0),s("tbody",t._l(t.order.items,(function(e,a){return s("tr",{key:a},[s("th",[t._v(" "+t._s(e.name[t.$store.state.language.code])+" ")]),s("td",{staticClass:"cartItemAmount has-text-right"},[t._v(" "+t._s(e.amount)+" ")]),s("td",{staticClass:"has-text-right"},[s("span",[t._v(t._s(t.$store.state.numeral(e.price).format("0.00")))]),s("span",[t._v(t._s(t.$store.state.currency.symbol))])])])})),0),s("tfoot",[t.order.prices&&t.order.prices.priceItems?s("tr",[s("td"),t._m(1),s("td",{staticClass:"has-text-right"},[t._v(" "+t._s(t.$store.state.numeral(t.order.prices.priceItems).format("0.00"))+" "+t._s(t.$store.state.currency.symbol)+" ")])]):t._e(),t.order.prices&&t.order.prices.priceDelivery?s("tr",[s("td"),t._m(2),s("td",{staticClass:"has-text-right"},[t._v(" "+t._s(t.$store.state.numeral(t.order.prices.priceDelivery).format("0.00"))+" "+t._s(t.$store.state.currency.symbol)+" ")])]):t._e(),t.order.prices&&t.order.prices.pricePayment?s("tr",[s("td"),t._m(3),s("td",{staticClass:"has-text-right"},[t._v(" "+t._s(t.$store.state.numeral(t.order.prices.pricePayment).format("0.00"))+" "+t._s(t.$store.state.currency.symbol)+" ")])]):t._e(),t.order.prices&&t.order.prices.priceTotal?s("tr",[s("td"),t._m(4),s("td",{staticClass:"has-text-right"},[s("strong",[t._v(t._s(t.$store.state.numeral(t.order.prices.priceTotal).format("0.00")))]),t._v(" "+t._s(t.$store.state.currency.symbol)+" ")])]):t._e()])])])])])])]):s("div",[t._m(5)])]),s("div",{staticClass:"column is-6"},[s("div",{staticClass:"columns is-variable is-2"},[s("div",{staticClass:"column is-6"},[s("h3",{staticClass:"title is-5",attrs:{translate:"yes"}},[t._v("You are ordering to:")]),s("div",{staticClass:"summary-block with-pre-whitespace"},[t._v(t._s(t.invoiceAddress()))])]),t.checkDeliveryAddress()?s("div",{staticClass:"column is-6"},[s("h3",{staticClass:"title is-5",attrs:{translate:"yes"}},[t._v("With delivery to:")]),s("div",{staticClass:"summary-block with-pre-whitespace"},[t._v(t._s(t.deliveryAddress()))])]):s("div",{staticClass:"column is-6"},[s("h3",{staticClass:"title is-5",attrs:{translate:"yes"}},[t._v("With delivery to:")]),s("div",{staticClass:"summary-block",attrs:{translate:"yes"}},[t._v("same as invoice address")])])]),s("div",{staticClass:"columns is-variable is-2"},[s("div",{staticClass:"column is-6",attrs:{id:"order-detail--delivery-settings"}},[s("h3",{staticClass:"title is-5",attrs:{translate:"yes"}},[t._v("Your Delivery settings:")]),t.checkDeliveryData()?s("div",{staticClass:"content summary-block"},t._l(t.deliveryData(),(function(e,a){return s("div",{key:a},[s("p",[s("span",{staticClass:"capitalize"},[t._v(t._s(e.type))]),t._v(" - "),s("strong",[t._v(t._s(e.name))]),t._v(": "+t._s(t.$store.state.numeral(e.price).format("0.00"))+" "+t._s(t.$store.state.currency.symbol)+" ")])])})),0):t._e()]),t.checkPaymentData()?s("div",{staticClass:"column is-6"},[s("div",{attrs:{id:"order-detail--payment-settings"}},[s("h3",{staticClass:"title is-5",attrs:{translate:"yes"}},[t._v("Your Payment settings:")]),t.paymentData()?s("div",{staticClass:"content summary-block"},[s("p",[s("strong",[t._v(t._s(t.paymentData().name))]),t._v(": "+t._s(t.$store.state.numeral(t.paymentData().price).format("0.00"))+" "+t._s(t.$store.state.currency.symbol))])]):t._e()])]):t._e()])])])]),s("hr"),s("div",[s("div",{staticClass:"columns is-variable"},[t.userIsAdmin?s("div",{staticClass:"column is-12"},[t._v(" Admin action: "),s("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.invoiceGenerate()}}},[t._v("Generate Invoice")])]):t._e()])]),t.order&&t.order.invoice?s("div",{staticClass:"container order-invoice-detail"},[s("h3",{staticClass:"title is-2 is-centered",attrs:{translate:"yes"}},[t._v("Your Invoice")]),s("div",{staticClass:"columns is-variable"},[s("div",{staticClass:"column is-12"},[s("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.invoiceDownload()}}},[t._v("Download Invoice")])])]),s("div",{staticClass:"columns is-variable is-centered"},[t.order&&t.order.invoice&&t.order.invoice.html?s("div",{staticClass:"column is-8"},[s("div",{staticClass:"order-invoice-body",domProps:{innerHTML:t._s(t.order.invoice.html)}})]):t._e()])]):t._e()]):s("div",{staticClass:"container"},[s("div",{staticClass:"columns is-variable is-centered"},[s("div",{staticClass:"column is-8"},[s("h1",{staticClass:"title is-1",attrs:{translate:"yes"}},[t._v("Unauthorized")]),s("p",[s("span",{attrs:{translate:"yes"}},[t._v("To see order detail, you may need to")]),t._v(" "),s("router-link",{attrs:{to:{name:"login"},tag:"a","active-class":"is-active",translate:"yes"}},[t._v("Log in")]),t._v(". ")],1),t._m(6)])])])])},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",{},[s("div",{staticClass:"th-wrap",attrs:{translate:"yes"}},[t._v("Name")])]),s("th",{},[s("div",{staticClass:"th-wrap is-pulled-right",attrs:{translate:"yes"}},[t._v("Qty")])]),s("th",{},[s("div",{staticClass:"th-wrap is-pulled-right",attrs:{translate:"yes"}},[t._v("Price")])])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",{staticClass:"has-text-right"},[s("strong",{attrs:{translate:"yes"}},[t._v("Products Total")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",{staticClass:"has-text-right"},[s("span",{attrs:{translate:"yes"}},[t._v("Price delivery")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",{staticClass:"has-text-right"},[s("span",{attrs:{translate:"yes"}},[t._v("Price payment")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",{staticClass:"has-text-right"},[s("strong",{attrs:{translate:"yes"}},[t._v("Total price")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h3",{staticClass:"title is-3"},[s("span",{attrs:{translate:"yes"}},[t._v("No items in this order")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{attrs:{translate:"yes"}},[t._v(" If you ordered without registration, "),s("br"),t._v(" you may need to check your email for activation message first. ")])}],i=(s("28a5"),s("7f7f"),s("ac6a"),s("456d"),s("56d7")),n={name:"userOrderDetail",data:function(){return{order:null}},created:function(){this.getOrder(this.$route.params.id)},computed:{userIsAdmin:function(){return!!(this.$store.state&&this.$store.state.user&&this.$store.state.user.logged&&this.$store.state.user.profile&&this.$store.state.user.profile.type&&"admin"==this.$store.state.user.profile.type)}},methods:{getOrder:function(t){var e=this,s={timeout:3e3,needsAuth:!0},a={query:{_id:t},limit:1};this.$httpc.post("order/list",a,s).then((function(t){t&&t.data&&1==t.data.length&&(e.order=t.data[0])})).catch((function(t){console.log(t)})).then((function(){i["eventBus"].$emit("translateContent",e.$store.getters.getTranslates)}))},splitTitle:function(t){return[t.slice(0,7),t.slice(7)]},checkDeliveryAddress:function(){return!!(this.order&&this.order.addresses&&this.order.addresses.deliveryAddress&&Object.keys(this.order.addresses.deliveryAddress).length>0)},invoiceAddress:function(){if(this.$store.state.coredata)return this.$helpers.addressToString(this.order.addresses.invoiceAddress,this.$store.state.coredata.countries,["type"])},deliveryAddress:function(){return this.order.addresses.deliveryAddress?this.$helpers.addressToString(this.order.addresses.deliveryAddress,this.$store.state.coredata.countries,["type"]):null},checkDeliveryData:function(){return!!(this.order&&this.order.data.deliveryData&&this.order.data.deliveryData.codename)},deliveryData:function(){var t=this,e=[];if(this.order&&this.order.data.deliveryData&&this.order.data.deliveryData.codename){var s=this.order.data.deliveryData.codename;if(this.order.settings&&this.order.settings.deliveryMethods){var a=this.order.settings.deliveryMethods;Object.keys(s).forEach((function(r){if(s&&a&&s[r]&&null!=s[r]){var i=s[r];i["type"]=r,i["name"]=i.value,a[r]&&a[r].forEach((function(e){e.type&&e.codename&&e.type==r&&e.codename==i["value"]&&(i["name"]=e.name[t.$store.getters.getLanguage])})),e.push(i)}}))}return e}},checkPaymentData:function(){return!(!this.order||!this.order.data.paymentData)},paymentData:function(){var t=this,e=null;if(this.order&&this.order.data.paymentData){var s="undefined"!==typeof this.order.data.paymentData.name[t.$store.getters.getLanguage]?this.order.data.paymentData.name[t.$store.getters.getLanguage]:this.order.data.paymentData.codename;e={name:s,price:this.order.data.paymentData.price}}return e},isOrderPaymentCodename:function(t){return!!(this.order&&this.order.data&&this.order.data.paymentData&&this.order.data.paymentData.codename&&this.order.data.paymentData.codename==t)},makePayment:function(){console.log("this.order.data.paymentData.codename",this.order.data.paymentData.codename),this.order.data.paymentData.codename.indexOf("online_paypal")>-1&&this.paymentPayPalCall()},paymentPayPalCall:function(){var t=this;t.$httpc.post("/order/paypalcheckout",{orderId:t.order._id,checkoutData:null},{timeout:5e3}).then((function(t){t&&t.data&&t.data.url&&""!=t.data.url.trim()&&(window.location.href=t.data.url)}))},invoiceDownload:function(){var t=this,e=this,s=this.getOrderInvoiceRequest();console.log("invoiceData:",s),s&&s.request&&e.$httpc.get("/order/invoice/download/"+s.request,{needsAuth:!0,responseType:"arraybuffer"}).then((function(e){console.log(e),t.downloadFile(e,s.filename)}))},downloadFile:function(t,e){var s=new Blob([t.data],{type:"application/pdf"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(s);else{var a=window.URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download=e,r.click(),setTimeout((function(){window.URL.revokeObjectURL(a)}),100)}},invoiceGenerate:function(){var t=this;this.$httpc.get("/order/invoice/generate/"+this.order._id,{needsAuth:!0}).then((function(e){e&&e.html&&e.path&&(t.order.invoice||(t.order["invoice"]={}),t.order.invoice=e,t.$forceUpdate())}))},getOrderInvoiceRequest:function(){var t="",e=this.order.invoice.path.split("/");console.log(e);var s=null,a=null;return e=e.filter(Boolean),e[2]&&e[2].indexOf(".pdf")>-1&&(a=e[2],e[2]=e[2].split("."),e[2][1]&&(t=e[1]+"."+e[2][0],s=e[2][0])),{request:t,id:s,filename:a}}}},o=n,d=(s("0d41"),s("2877")),l=Object(d["a"])(o,a,r,!1,null,null,null);e["default"]=l.exports},dbb1:function(t,e,s){}}]);
//# sourceMappingURL=chunk-d95965c2.7fee6949.js.map